import{c as pe}from"./index-0aae8c1b.js";import{f as Z,R as xe,C as ke}from"./es-195ab048.js";import{C as me,G as ge,S as fe,a as Ce,B as Se,A as De,R as Ge,M as Ne,F as Ie,E as Oe,b as Ve,c as Ae,O as ze,d as je,e as Te,f as Le,D as Ee}from"./es-index-44577735.js";import{U as he,L as le,e as Je}from"./es-map-d11f69f9.js";import{g as re,b,e as ye,f as de,r as c,o as y,c as F,a as l,w as s,h as A,i as C,t as x,E as g,s as G,j as Me,n as W,k,u as ee,l as Fe,m as Ue,p as te,F as ne,q as ae,v as Pe,x as O,y as Be,z as ue,A as I,B as Re,C as se,I as He,D as Ke,G as We}from"./index-e47c9f2e.js";import{J as _e}from"./index-efe8a954.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import{I as ve}from"./select-4ff5d95f.js";function qe(e){const t=["","",""];let a=1e3,o=3;for(;e/a>=1;)a*=10,o+=1;if(o<=4)t[1]="千",t[0]=parseInt(e/1e3)+"";else if(o<=8){const n=parseInt(o-4)/3>1?"千万":"万",d=n==="万"?1e4:1e7;t[1]=n,t[0]=e/d+""}else if(o<=16){let n=(o-8)/3>1?"千亿":"亿";n=(o-8)/4>1?"万亿":n,n=(o-8)/7>1?"千万亿":n;let d=1;n==="亿"?d=1e8:n==="千亿"?d=1e11:n==="万亿"?d=1e12:n==="千万亿"&&(d=1e15),t[1]=n,t[0]=parseInt(e/d)+""}return e<1e3&&(t[1]="",t[0]=e+""),t.join("")}const Qe={style:{"text-align":"right"}},Xe={__name:"settings",props:{indexName:{type:String,default:""},settingsType:{type:String,default:"add"},open:{type:Boolean,default:!1}},emits:["finished","close"],setup(e,{emit:t}){re().appContext.config.globalProperties;const a=e,o=b(a.indexName),n=b(a.settingsType),d=b(a.open),N=t,L=b(["number_of_shards","index.translog.sync_interval","index.shard.check_on_startup","index.routing_partition_size","index.codec"]),z=b(!1),h=b({"index.shard.check_on_startup":"","index.routing_partition_size":"","index.codec":"","index.auto_expand_replicas":"","index.max_result_window":"","index.max_rescore_window":"","index.blocks.read_only":"","index.blocks.read":"","index.blocks.write":"","index.blocks.metadata":"","index.blocks.read_only_allow_delete":"","index.max_refresh_listeners":"",number_of_shards:"",number_of_replicas:"",refresh_interval:"","index.translog.sync_interval":"","index.translog.durability":"","index.translog.flush_threshold_size":"","index.merge.scheduler.max_thread_count":"","index.merge.policy.max_merged_segment":"","index.merge.policy.segments_per_tier":""}),M=ye(()=>n.value==="add"?"新增索引配置":"修改索引配置"),v=()=>{if(h.value["index.routing_partition_size"]>=h.value["index.number_of_shards"]){g({type:"error",message:"自定义路由值可以转发的目的分片数 必须小于 主分片数"});return}if(o.value===""){g({type:"error",message:"索引名不能为空"});return}const f={};if(f.es_connect=G.GetSelectEsConnID(),f.settings=pe(h.value),f.index_name=o.value,f.types=n.value,n.value==="update")for(const r of L.value)delete f.settings[r];for(const r in f.settings)f.settings[r]===""&&delete f.settings[r];const m=Me.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});me(f).then(r=>{r.code===0||r.code===200?(g({type:"success",message:r.msg}),a.settingsType="update",N("finished")):g({type:"error",message:r.msg}),m.close()}).catch(r=>{m.close()})},U=()=>{const f={};f.es_connect=G.GetSelectEsConnID(),f.index_name=o.value,ge(f).then(m=>{if(m.code===0||m.code===200){const r=m.data.index;if(h.value.number_of_replicas=r.number_of_replicas,h.value.number_of_shards=r.number_of_shards,r.hasOwnProperty("auto_expand_replicas")&&(h.value["index.auto_expand_replicas"]=r.auto_expand_replicas),r.hasOwnProperty("blocks")){const i=r.blocks;i.hasOwnProperty("metadata")&&(h.value["index.blocks.metadata"]=i.metadata),i.hasOwnProperty("read")&&(h.value["index.blocks.read"]=i.read),i.hasOwnProperty("read_only")&&(h.value["index.blocks.read_only"]=i.read_only),i.hasOwnProperty("read_only_allow_delete")&&(h.value["index.blocks.read_only_allow_delete"]=i.read_only_allow_delete),i.hasOwnProperty("write")&&(h.value["index.blocks.write"]=i.write)}if(r.hasOwnProperty("merge")){const i=r.merge;if(i.hasOwnProperty("policy")){const _=i.policy;_.hasOwnProperty("max_merged_segment")&&(h.value["index.merge.policy.max_merged_segment"]=_.max_merged_segment),_.hasOwnProperty("max_merged_segment")&&(h.value["index.merge.policy.segments_per_tier"]=_.segments_per_tier)}if(i.hasOwnProperty("scheduler")){const _=i.scheduler;_.hasOwnProperty("max_thread_count")&&(h.value["index.merge.scheduler.max_thread_count"]=_.max_thread_count)}}if(r.hasOwnProperty("max_refresh_listeners")&&(h.value["index.max_refresh_listeners"]=r.max_refresh_listeners),r.hasOwnProperty("max_rescore_window")&&(h.value["index.max_rescore_window"]=r.max_rescore_window),r.hasOwnProperty("max_result_window")&&(h.value["index.max_result_window"]=r.max_result_window),r.hasOwnProperty("refresh_interval")&&(h.value.refresh_interval=r.refresh_interval),r.hasOwnProperty("translog")){const i=r.translog;i.hasOwnProperty("durability")&&(h.value["index.translog.durability"]=i.durability),i.hasOwnProperty("flush_threshold_size")&&(h.value["index.translog.flush_threshold_size"]=i.flush_threshold_size)}console.log(h.value,"form")}else g({type:"error",message:m.msg})}).catch(m=>{console.log(m)})},w=()=>{const f={};f.es_connect=G.GetSelectEsConnID(),f.index_name=o.value,fe(f).then(m=>{m.code==0||m.code==200?z.value=m.data[0].status=="open":g({type:"error",message:m.msg})}).catch(m=>{console.error(m)})},S=()=>{N("close")};return de(()=>{o.value!=""&&(w(),U())}),(f,m)=>{const r=c("el-input"),i=c("el-form-item"),_=c("el-form"),V=c("el-button"),j=c("el-card"),E=c("el-dialog");return y(),F("div",null,[l(E,{width:"90%","close-on-click-modal":!1,modelValue:d.value,"onUpdate:modelValue":m[5]||(m[5]=T=>d.value=T),title:M.value,onClose:S},{default:s(()=>[l(j,{class:"box-card"},{default:s(()=>[l(_,{"label-width":"500px","label-position":"left"},{default:s(()=>[l(i,{label:f.$t("索引名称：")},{default:s(()=>[l(r,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=T=>o.value=T),placeholder:f.$t("索引名称"),disabled:n.value!=="add"},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),l(i,{label:"number_of_shards (分片数)："},{default:s(()=>[l(r,{modelValue:h.value.number_of_shards,"onUpdate:modelValue":m[1]||(m[1]=T=>h.value.number_of_shards=T),type:"number",style:{width:"300px"},disabled:z.value},null,8,["modelValue","disabled"])]),_:1}),l(i,{label:"number_of_replicas (副本数)："},{default:s(()=>[l(r,{modelValue:h.value.number_of_replicas,"onUpdate:modelValue":m[2]||(m[2]=T=>h.value.number_of_replicas=T),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(i,{label:"refresh_interval (索引的刷新时间间隔)："},{default:s(()=>[l(r,{modelValue:h.value.refresh_interval,"onUpdate:modelValue":m[3]||(m[3]=T=>h.value.refresh_interval=T),placeholder:f.$t("索引的刷新时间间隔")},null,8,["modelValue","placeholder"])]),_:1}),l(i,{label:"max_result_window  (from+size 的最大值)："},{default:s(()=>[l(r,{modelValue:h.value["index.max_result_window"],"onUpdate:modelValue":m[4]||(m[4]=T=>h.value["index.max_result_window"]=T),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1}),A("div",Qe,[l(V,{type:"danger",onClick:S},{default:s(()=>[C(x(f.$t("取消")),1)]),_:1}),l(V,{type:"primary",onClick:v},{default:s(()=>[C(x(f.$t("确认")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue","title"])])}}};const Ye={key:0,class:"item"},Ze={key:1,style:{"margin-left":"14px"}},$e={class:"item-type item-cell"},et={class:"item-value item-cell"},K=8,tt={__name:"Item",props:{item:{type:Object,default:{key:"",value:"",type:""}},names:{type:Array},parent:{type:Object},index:{type:Number,default:0},deep:{type:Number,default:0},size:{type:String,default:"small"},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0}},setup(e){const t=e,a=b(!t.openFlag),o=b(t.deep+1),n=b([{value:"String",label:"String"},{value:"Object",label:"Object"},{value:"Array",label:"Array"},{value:"Number",label:"Number"},{value:"Boolean",label:"Boolean"}]),d=b([{value:"Object",label:"Object"},{value:"Array",label:"Array"}]),N=b([{value:"type",data:" 数据类型"},{value:"format",data:" 时间格式化"},{value:"analyzer",data:" 分词器"},{value:"normalizer",data:" 分析器"},{value:"boost",data:" 权重"},{value:"coerce",data:" 强制类型转换"},{value:"copy_to",data:" 合并参数"},{value:"doc_values",data:" 文档值"},{value:"dynamic",data:" 动态设置"},{value:"enabled",data:" 是否开启字段"},{value:"fielddata",data:" 字段数据"},{value:"ignore_above",data:" 字段保存最大长度"},{value:"ignore_malformed",data:" 忽略格式不对的数据"},{value:"include_in_all",data:" _all 查询包含字段"},{value:"index_options",data:" 索引设置"},{value:"index",data:" 是否可以被搜索"},{value:"fields",data:" 字段"},{value:"norms",data:" 标准信息"},{value:"null_value",data:" 空值"},{value:"position_increment_gap",data:" 短语位置间隙"},{value:"properties",data:" 属性"},{value:"search_analyzer",data:" 搜索分析器"},{value:"similarity",data:" 匹配算法"},{value:"store",data:" 字段是否被存储"},{value:"term_vector",data:" 词根信息"}]),L=b([{value:"text",data:"字符串类型(可分词) "},{value:"keyword",data:"字符串类型(不可分词) "},{value:"long",data:"数字类型 "},{value:"integer",data:"数字类型 "},{value:"short",data:"数字类型 "},{value:"byte",data:"数字类型 "},{value:"double",data:"数字类型 "},{value:"float",data:"数字类型 "},{value:"half_float",data:"数字类型 "},{value:"scaled_float",data:"数字类型 "},{value:"date",data:"时间类型 "},{value:"boolean",data:"布尔类型 "},{value:"binary",data:"二进制类型 "},{value:"Array",data:"数组类型 "},{value:"object",data:"对象类型  "},{value:"nested",data:"嵌套类型 "},{value:"geo_point",data:"地理类型 "},{value:"geo_shape",data:"多边形类型 "},{value:"ip",data:"ip类型 "},{value:"completion",data:"补全类型 "},{value:"token_count",data:"令牌计数类型 "},{value:"yyyy-MM-dd HH:mm:ss",data:"时间格式化 "}]);b(["el-icon-arrow-right","el-icon-arrow-down"]);const z=b(["el-tag-blue","el-tag-orange"]),h=b(["item-cell item-control-cell","item-cell"]),M=b(["el-input el-input--small"]);function v(r,i){let _=JSON.parse(JSON.stringify(N.value));if(r==null&&(r=""),r.trim()==""){_.length>K?i(_.slice(0,K)):i(_);return}_=Z(_,r.trim()),_.length>K?i(_.slice(0,K)):i(_)}function U(r,i){let _=JSON.parse(JSON.stringify(L.value));if(r==null&&(r=""),r.trim()==""){_.length>K?i(_.slice(0,K)):i(_);return}_=Z(_,r.trim()),_.length>K?i(_.slice(0,K)):i(_)}function w(r){const i=N.value.find(_=>_.value===r);return i?i.data:""}function S(){["Object","Array"].includes(t.item.type)&&(a.value=!1)}function f(){t.item.childs||(t.item.childs=[]),t.item.childs.push({key:"",value:"",type:""})}function m(){const r=t.parent.childs.indexOf(t.item);r>-1&&t.parent.childs.splice(r,1)}return(r,i)=>{const _=c("el-icon"),V=c("el-link"),j=c("el-tag"),E=c("el-autocomplete"),T=c("el-option"),Q=c("el-select"),X=c("el-input-number"),q=c("el-radio"),J=c("el-radio-group"),D=c("el-tooltip"),P=c("el-popconfirm"),B=c("el-row");return y(),F("div",null,[l(B,{style:te("padding-left: "+(o.value-1)*15+"px; margin-top: 5px")},{default:s(()=>[e.rootFlag?(y(),F("div",Ye,[A("div",{class:W(h.value),onClick:i[0]||(i[0]=p=>a.value=!a.value)},[e.item.childs!=null?(y(),k(V,{key:0,underline:!1},{default:s(()=>[a.value?(y(),k(_,{key:0},{default:s(()=>[l(ee(Fe))]),_:1})):(y(),k(_,{key:1},{default:s(()=>[l(ee(Ue))]),_:1}))]),_:1})):(y(),F("i",Ze))],2),A("div",{class:"item-cell",onClick:i[1]||(i[1]=p=>a.value=!a.value)},[l(V,{underline:!1},{default:s(()=>[l(j,{effect:"plain",class:W(z.value)},{default:s(()=>[A("span",null,x(w(e.item.key)?w(e.item.key):e.item.key),1)]),_:1},8,["class"])]),_:1})]),A("div",{class:"item-key item-cell",style:te("width: "+(300-(o.value-1)*15)+"px")},[l(E,{modelValue:e.item.key,"onUpdate:modelValue":i[2]||(i[2]=p=>e.item.key=p),clearable:"","fetch-suggestions":v,placeholder:e.parent.type=="Array"?"":"请输入键",size:e.size,disabled:e.item.isRoot||e.parent.type=="Array",style:te("width: "+(290-(o.value-1)*15)+"px")},{default:s(({item:p})=>[A("span",null,x(p.value)+"-"+x(p.data),1)]),_:1},8,["modelValue","placeholder","size","disabled","style"])],4),A("div",$e,[l(Q,{modelValue:e.item.type,"onUpdate:modelValue":i[3]||(i[3]=p=>e.item.type=p),size:e.size,placeholder:"请选择",class:"select-body",onChange:S},{default:s(()=>[(y(!0),F(ne,null,ae(e.item.isRoot?d.value:n.value,p=>(y(),k(T,{key:p.value,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","size"])]),A("div",et,[e.item.type!="Number"&&e.item.type!="Boolean"?(y(),k(E,{key:0,modelValue:e.item.value,"onUpdate:modelValue":i[4]||(i[4]=p=>e.item.value=p),"fetch-suggestions":U,clearable:"",size:e.size,placeholder:e.item.type=="Array"||e.item.type=="Object"?"":"请输入值",disabled:e.item.type=="Array"||e.item.type=="Object",class:W(M.value)},{default:s(({item:p})=>[A("span",null,x(p.value)+"-"+x(p.data),1)]),_:1},8,["modelValue","size","placeholder","disabled","class"])):e.item.type=="Number"?(y(),k(X,{key:1,modelValue:e.item.value,"onUpdate:modelValue":i[5]||(i[5]=p=>e.item.value=p),size:e.size,class:W(M.value)},null,8,["modelValue","size","class"])):(y(),k(J,{key:2,modelValue:e.item.value,"onUpdate:modelValue":i[6]||(i[6]=p=>e.item.value=p),class:W(M.value)},{default:s(()=>[l(q,{class:"el-radio",label:!0},{default:s(()=>[C("是")]),_:1}),l(q,{class:"el-radio",label:!1},{default:s(()=>[C("否")]),_:1})]),_:1},8,["modelValue","class"]))]),A("div",{class:W(h.value)},[e.item.type=="Array"||e.item.type=="Object"?(y(),k(D,{key:0,class:"item-control-cell",content:"添加子元素",placement:"top"},{default:s(()=>[l(V,{underline:!1,onClick:f},{default:s(()=>[l(_,null,{default:s(()=>[l(ee(Pe))]),_:1})]),_:1})]),_:1})):O("",!0),e.item.isRoot?O("",!0):(y(),k(P,{key:1,title:"确定删除当前节点吗？",onConfirm:m},{default:s(()=>[l(V,{slot:"reference",underline:!1,class:"item-control-cell"},{default:s(()=>[l(_,null,{default:s(()=>[l(ee(Be))]),_:1})]),_:1})]),_:1}))],2)])):O("",!0)]),_:1},8,["style"]),A("div",{style:te(a.value?"display: none":"display: block")},[e.item.childs&&e.item.type=="Object"?(y(!0),F(ne,{key:0},ae(e.item.childs,(p,u)=>(y(),F("span",{key:u},[l(ie,{size:e.size,item:p,parent:e.item,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","names","deep","open-flag"])]))),128)):O("",!0),e.item.childs&&e.item.type=="Array"?(y(!0),F(ne,{key:1},ae(e.item.childs,(p,u)=>(y(),F("span",{key:u},[l(ie,{size:e.size,item:p,parent:e.item,index:u,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","index","names","deep","open-flag"])]))),128)):O("",!0)],4)])}}},ie=oe(tt,[["__scopeId","data-v-13f66a1c"]]);const lt={name:"VueJsonHelper",components:{Item:ie},props:{names:{type:Array},size:{type:String,default:"small"},jsonStr:{type:String},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0},borderFlag:{type:Boolean,default:!0},shadowFlag:{type:Boolean,default:!1},backTopFlag:{type:Boolean,default:!1}},data(){return{deep:0,isJson:!1,jsonData:void 0,errorResult:void 0,item:{key:"Root",value:null,type:null,isRoot:!0,childs:[]}}},watch:{item:{handler(e,t){if(e==t){var a=this.handleJsonData(e);a!=null&&this.$emit("jsonListener",a)}},immediate:!0,deep:!0}},created(){this.isJson=this.judgeJson(),this.item.childs=this.handleJson(this.jsonData),this.item.type=this.handleType()},methods:{judgeJson(){var e=!1;try{this.jsonData=JSON.parse(this.jsonStr),e=!0}catch(t){this.errorResult=t,e=!1}return e},handleJsonData(e){var t={},a=[],o=e.type,n=e.childs;for(var d in n)n[d].type!="Object"&&n[d].type!="Array"?o=="Object"?t[n[d].key]=n[d].value:o=="Array"&&a.push(n[d].value):o=="Object"?t[n[d].key]=this.handleJsonData(n[d]):o=="Array"&&a.push(this.handleJsonData(n[d]));if(o=="Object")return t;if(o=="Array")return a},handleJson(e){var t=[];for(var a in e){var o=this.judgeType(e[a]);if(o=="Object"||o=="Array"){var n={key:a,value:null,type:o,childs:this.handleJson(e[a])};t.push(n)}else{var n={key:a,value:e[a],type:o};t.push(n)}}return t},judgeType(e){var t=Object.prototype.toString.call(e);return t==="[object String]"?t="String":t==="[object Number]"?t="Number":t==="[object Boolean]"?t="Boolean":t==="[object Array]"?t="Array":t==="[object Object]"?t="Object":t=null,t},handleType(){return this.judgeType(this.jsonData)}}};function nt(e,t,a,o,n,d){const N=c("Item"),L=c("el-col"),z=c("el-backtop"),h=c("el-row");return y(),k(h,{class:W(a.borderFlag?"el-row-border":"")},{default:s(()=>[n.isJson?(y(),k(L,{key:0,class:"item-body"},{default:s(()=>[l(N,{item:n.item,deep:n.deep,parent:n.item,names:a.names,size:a.size,index:0,"root-flag":a.rootFlag,"open-flag":a.openFlag},null,8,["item","deep","parent","names","size","root-flag","open-flag"])]),_:1})):(y(),k(L,{key:1},{default:s(()=>[A("i",null,x(n.errorResult),1)]),_:1})),a.backTopFlag?(y(),k(z,{key:2})):O("",!0)]),_:1},8,["class"])}const at=oe(lt,[["render",nt],["__scopeId","data-v-29aa0e56"]]);const st={class:"app-container"},ot={class:"search-container"},it={__name:"mapping",props:{indexName:{type:String,default:""},open:{type:Boolean,default:!1},title:{type:String,default:"新增映射结构"}},emits:["close","finished"],setup(e,{emit:t}){const a=e,o=b(a.open),n=b(a.title),d=b(a.indexName),N=b("1");re().appContext.config.globalProperties;const L=ye(()=>JSON.stringify(JSON.parse(m.value),null,"	")),z=t,h=b(!1),M=b("false"),v=b("small"),U=b([{key:"Root",name:"properties"},{key:"type",name:"数据类型"},{key:"format",name:"时间格式化"},{key:"analyzer",name:"分词器"},{key:"normalizer",name:"分析器"},{key:"boost",name:"权重"},{key:"coerce",name:"强制类型转换"},{key:"copy_to",name:"合并参数"},{key:"doc_values",name:"文档值"},{key:"dynamic",name:"动态设置"},{key:"enabled",name:"是否开启字段"},{key:"fielddata",name:"字段数据"},{key:"ignore_above",name:"字段保存最大长度"},{key:"ignore_malformed",name:"忽略格式不对的数据"},{key:"include_in_all",name:"_all 查询包含字段"},{key:"index_options",name:"索引设置"},{key:"index",name:"是否可以被搜索"},{key:"fields",name:"字段"},{key:"norms",name:"标准信息"},{key:"null_value",name:"空值"},{key:"position_increment_gap",name:"短语位置间隙"},{key:"properties",name:"属性"},{key:"search_analyzer",name:"搜索分析器"},{key:"similarity",name:"匹配算法"},{key:"store",name:"字段是否被存储"},{key:"term_vector",name:"词根信息"}]),w=b(!0),S=b(!0),f=b(!1),m=b("{}"),r=b(!1),i=b(""),_=b(6),V=b(!1),j=b(!1),E=async()=>{let J={};try{J=JSON.parse(m.value)}catch{g({type:"error",message:"JSON格式不正确"});return}const D={es_connect:G.GetSelectEsConnID(),index_name:a.indexName},P={properties:J,dynamic:M.value};switch(_.value){case 6:D.properties=P,D.type_name=i.value;break;case 7:case 8:D.properties=P;break}h.value=!0;const{data:B,code:p,msg:u}=await he(D);h.value=!1,p===0?(g({type:"success",message:u}),z("finished")):g({type:"error",message:u})},T=()=>{r.value=!1,Re(()=>{r.value=!0})},Q=async()=>{var p,u,R,$;const J={es_connect:G.GetSelectEsConnID(),index_name:a.indexName},{data:D,code:P,msg:B}=await le(J);if(P!==0){g({type:"error",message:B});return}switch(_.value=D.ver,_.value){case 6:const Y=Object.keys(D.list[a.indexName].mappings);V.value=!0,Y.length===0?j.value=!1:(i.value=Y[0],j.value=!0,M.value=((p=D.list[a.indexName].mappings[i.value])==null?void 0:p.dynamic)??"false",m.value=JSON.stringify(((u=D.list[a.indexName].mappings[i.value])==null?void 0:u.properties)??"{}"));break;case 7:case 8:M.value=((R=D.list[a.indexName].mappings)==null?void 0:R.dynamic)??"false",m.value=JSON.stringify((($=D.list[a.indexName].mappings)==null?void 0:$.properties)??"{}");break}T()},X=J=>{m.value=JSON.stringify(J)},q=()=>{z("close")};return de(()=>{Q()}),(J,D)=>{const P=c("el-input"),B=c("el-form-item"),p=c("el-option"),u=c("el-select"),R=c("el-button"),$=c("el-form"),Y=c("el-tabs"),ce=c("el-tab-pane"),be=c("el-dialog"),we=ue("loading");return y(),F("div",null,[l(be,{"close-on-click-modal":!1,modelValue:o.value,"onUpdate:modelValue":D[4]||(D[4]=H=>o.value=H),title:n.value.concat(`【${d.value}】`),width:"60%",onClose:q},{default:s(()=>[A("div",st,[A("div",ot,[l($,{inline:!0},{default:s(()=>[V.value?(y(),k(B,{key:0,label:"type"},{default:s(()=>[V.value?(y(),k(P,{key:0,modelValue:i.value,"onUpdate:modelValue":D[0]||(D[0]=H=>i.value=H),readonly:j.value,style:{width:"200px"}},null,8,["modelValue","readonly"])):O("",!0)]),_:1})):O("",!0),l(B,{label:"dynamic"},{default:s(()=>[l(u,{style:{width:"100px"},modelValue:M.value,"onUpdate:modelValue":D[1]||(D[1]=H=>M.value=H)},{default:s(()=>[l(p,{label:J.$t("动态映射"),value:"true"},null,8,["label"]),l(p,{label:J.$t("静态映射"),value:"false"},null,8,["label"]),l(p,{label:J.$t("严格映射"),value:"strict"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(B,null,{default:s(()=>[I((y(),k(R,{disabled:h.value,type:"success",onClick:E},{default:s(()=>[C(x(J.$t("保存/修改映射")),1)]),_:1},8,["disabled"])),[[we,h.value]])]),_:1})]),_:1})]),l(Y),l(Y,{modelValue:N.value,"onUpdate:modelValue":D[3]||(D[3]=H=>N.value=H),stretch:""},{default:s(()=>[l(ce,{name:"1",lazy:!0,label:J.$t("表单")},{default:s(()=>[r.value?(y(),k(at,{key:0,size:v.value,names:U.value,"json-str":m.value,"root-flag":w.value,"open-flag":S.value,"back-top-flag":f.value,"shadow-flag":!1,"border-flag":!1,onJsonListener:X},null,8,["size","names","json-str","root-flag","open-flag","back-top-flag"])):O("",!0)]),_:1},8,["label"]),l(ce,{name:"2",lazy:!0,label:J.$t("JSON")},{default:s(()=>[l(_e,{value:L.value,"onUpdate:value":D[2]||(D[2]=H=>L.value=H),height:"720",styles:"width: 100%",title:i.value},null,8,["value","title"])]),_:1},8,["label"])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","title"])])}}},rt=oe(it,[["__scopeId","data-v-cbb87fd6"]]),dt={__name:"alias",props:{indexName:{type:String,default:""}},setup(e){re().appContext.config.globalProperties;const t=e,a=b([]),o=b([]),n=()=>{a.value.push({name:"",types:"new"})},d=async()=>{a.value=[];const w={es_connect:G.GetSelectEsConnID(),index_name:t.indexName},{data:S,code:f,msg:m}=await Ce(w);if(console.log(S,f,m),f===0)for(const r in S)a.value.push({name:S[r].AliasName,types:"old"});else g({message:m,type:"error"})},N=async w=>{const S=a.value[w].name,f={types:1,index_name:t.indexName,alias_name:S.trim(),es_connect:G.GetSelectEsConnID()},{data:m,code:r,msg:i}=await De(f);r===0?g({type:"success",message:i}):g({type:"error",message:i})},L=async()=>{const w=a.value.filter(i=>i.types==="new").map(i=>i.name),S={types:4,index_name:t.indexName,new_alias_name_list:w,es_connect:G.GetSelectEsConnID()},{data:f,code:m,msg:r}=await Se(S);m===0?g({type:"success",message:r}):g({type:"error",message:r})},z=async w=>{const S=a.value[w];if(S.types==="new")a.value.splice(w,1);else if(S.types==="old"){const f={types:2,index_name:t.indexName,alias_name:S.name.trim(),es_connect:G.GetSelectEsConnID()},{data:m,code:r,msg:i}=await Ge(f);r===0?(g({type:"success",message:i}),a.value.splice(w,1)):g({type:"error",message:i})}},h=w=>{o.value=w},M=async w=>{const S=a.value[w].name,f={types:3,new_index_list:o.value,alias_name:S.trim(),es_connect:G.GetSelectEsConnID()},{data:m,code:r,msg:i}=await Ne(f);r===0?g({type:"success",message:i}):g({type:"error",message:i})},v=w=>{g({message:"复制成功！",type:"success"})},U=w=>{g({message:"复制失败！",type:"error"})};return de(()=>{d()}),(w,S)=>{const f=c("el-button"),m=c("el-form-item"),r=c("el-input"),i=c("el-form"),_=ue("clipboard");return y(),F("div",null,[l(i,null,{default:s(()=>[l(m,null,{default:s(()=>[l(f,{type:"success",onClick:n},{default:s(()=>[C(x(w.$t("新增别名")),1)]),_:1}),l(f,{type:"primary",onClick:L},{default:s(()=>[C(x(w.$t("批量提交")),1)]),_:1}),l(f,{type:"info",onClick:d},{default:s(()=>[C(x(w.$t("重置")),1)]),_:1}),l(ve,{style:{width:"210px","margin-left":"5px"},multiple:!0,clearable:!0,placeholder:w.$t("迁移别名到多个索引上"),onChange:h},null,8,["placeholder"])]),_:1}),(y(!0),F(ne,null,ae(a.value,(V,j)=>(y(),k(m,{key:j,label:w.$t("别名")+Number(j+1)},{default:s(()=>[l(r,{modelValue:V.name,"onUpdate:modelValue":E=>V.name=E,readonly:V.types!="new",style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue","readonly"]),I(l(f,{type:"success",onClick:E=>M(j)},{default:s(()=>[C(" 迁移 ")]),_:2},1032,["onClick"]),[[se,o.value.length>0]]),I((y(),k(f,{type:"success"},{default:s(()=>[C(x(w.$t("复制")),1)]),_:2},1024)),[[_,V.name,"copy"],[_,v,"success"],[_,U,"error"]]),I(l(f,{type:"primary",onClick:E=>N(j)},{default:s(()=>[C(x(w.$t("提交")),1)]),_:2},1032,["onClick"]),[[se,V.types=="new"]]),l(f,{type:"danger",onClick:E=>z(j)},{default:s(()=>[C(x(w.$t("删除")),1)]),_:2},1032,["onClick"])]),_:2},1032,["label"]))),128))]),_:1})])}}};const ut={name:"indices",setup(){return He},components:{Settings:Xe,Mappings:rt,JsonEditor:_e,Alias:dt,IndexSelect:ve},data(){return{activeNames:"1",indexTishiList:[],modName:"索引管理",aliasList:[],pointOut:Je,settings:{},readOnlyAllowDeleteLoading:!1,loadingGroup:{empty:!1,close:!1,open:!1,_forcemerge:!1,_refresh:!1,_flush:!1,"_cache/clear":!1,deleteIndex:!1,"_all/_flush":!1,saveMappinng:!1},forceMergeLoading:!1,tabLoading:!1,settingData:"{}",mappingData:"{}",statsData:"{}",editSettingsData:"{}",activeName:"Settings",showEditSettings:!0,showSettings:!0,showMapping:!0,showStats:!0,drawerShow:!1,settingsType:"add",mappingTitle:"",indexName:"",openSettings:!1,total:0,connectLoading:!1,page:1,limit:10,pageshow:!0,list:[],input:"",status:"",mappings:{},selectIndexList:[],openMappings:!1,allList:[],max:8}},destroyed(){sessionStorage.setItem("CatIndices",this.input)},computed:{isMobile(){return G.IsMobile()}},mounted(){const e=sessionStorage.getItem("CatIndices");e!=null&&(this.input=e),this.startGuid(),this.GetMapAction(),this.searchData()},methods:{openMappingDialog(e){this.indexName=e,this.openMappings=!0},async finishGuid(){},async startGuid(){},selectChange(e){this.selectIndexList=[];for(const t of e)this.selectIndexList.push(t.index)},async changeMapToAnotherIndex(e){e==""&&(e=this.indexName);const t={};t.es_connect=G.GetSelectEsConnID(),t.index_name=e;const a=await le(t);a.code==0&&(this.mappingData=JSON.stringify(a.data.list[e].mappings,null,"	"))},getMapping(e){this.mappingData=e},async saveMappinng(){let e=pe(this.mappingData);try{e=JSON.parse(e)}catch{g({type:"error",message:"JSON格式不正确"});return}const t=Object.keys(e);if(t.length==0){g({type:"error",message:"请按格式写type名字"});return}const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=this.indexName,e[t[0]].toString()!="false"?(a.properties=e[t[0]],a.type_name=t[0]):a.properties=e,this.loadingGroup.saveMappinng=!0;const{data:o,code:n,msg:d}=await he(a);this.loadingGroup.saveMappinng=!1,n==0?g({type:"success",message:d}):g({type:"error",message:d})},openMappingEditDialog(e,t){t?this.mappingTitle=$t("新增字段"):this.mappingTitle=$t("新增映射结构"),this.indexName=e,this.openMappings=!0},async GetMapAction(){const e={};e.es_connect=G.GetSelectEsConnID();const{code:t,data:a,msg:o}=await le(e);if(t==0)this.mappings=a.list;else{g({type:"error",message:o});return}},submitSettings(){const e={};e.es_connect=G.GetSelectEsConnID();try{e.settings=JSON.parse(this.editSettingsData)}catch(a){console.log(a),g({type:"error",message:"JSON 解析异常"});return}e.index_name=this.indexName,e.types="update";const t=this.$loading({lock:!0,text:"Loading",spinner:"el-button-loading",background:"rgba(0, 0, 0, 0.7)"});me(e).then(a=>{a.code==0||a.code==200?(g({type:"success",message:a.msg}),this.search()):g({type:"error",message:a.msg}),t.close()}).catch(a=>{t.close()})},getSettings(e){this.editSettingsData=e},resetSettings(){this.changeTab()},Forcemerge(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ie(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Empty(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Oe(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Flush(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ve(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},CacheClear(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ae(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Open(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,ze(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Close(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,je(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Refresh(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Te(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},async changeTab(e){let t=0;e!=null&&(t=Number(e.index));const a={};let o={};switch(a.es_connect=G.GetSelectEsConnID(),a.index_name=this.indexName,t){case 0:o=await Le(a),o.code==0&&(this.settingData=JSON.stringify(o.data,null,"	")),this.showSettings=!1,this.$nextTick(()=>{this.showSettings=!0});return;case 1:o=await le(a),o.code==0&&(this.mappingData=JSON.stringify(o.data.list[this.indexName].mappings,null,"	"),Object.keys(o.data.list[this.indexName].mappings).length==0&&g({type:"error",message:"您还没有设置映射结构"})),this.showMapping=!1,this.$nextTick(()=>{this.showMapping=!0});return;case 2:o=await fe(a),o.code==0&&(this.statsData=JSON.stringify(o.data,null,"	")),this.showStats=!1,this.$nextTick(()=>{this.showStats=!0});return;case 3:const{data:n}=await ge(a),d=["creation_date","version","provided_name","uuid","format","number_of_shards"];for(const N of d)n.index.hasOwnProperty(N)&&delete n.index[N];this.editSettingsData=JSON.stringify(n,null,"	"),this.showEditSettings=!1,this.$nextTick(()=>{this.showEditSettings=!0});return;case 4:return;default:return}},openDrawer(e){this.indexName=e,this.changeTab(),this.drawerShow=!0},drawerHandleClose(e){this.indexName="",this.activeName="Settings",e()},bigNumberTransform(e){return qe(e)},openSettingDialog(e,t){this.indexName=e,this.settingsType=t,this.openSettings=!0},readOnlyAllowDelete(){const e={};e.es_connect=G.GetSelectEsConnID(),this.readOnlyAllowDeleteLoading=!0,xe(e).then(t=>{t.code==0||t.code==200?g({type:"success",message:t.msg}):g({type:"error",message:t.msg}),this.readOnlyAllowDeleteLoading=!1}).catch(t=>{this.readOnlyAllowDeleteLoading=!1})},querySearch(e,t){let a=JSON.parse(JSON.stringify(this.indexTishiList));if(e==null&&(e=""),e.trim()==""){a.length>this.max?t(a.slice(0,this.max)):t(a);return}a=Z(a,e.trim()),a.length>this.max?t(a.slice(0,this.max)):t(a)},deleteIndex(e,t){this.$confirm("确定删除该索引吗?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=e,this.loadingGroup[t]=!0,Ee(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:e+"已删除"}),this.searchData(),this.loadingGroup[t]=!1):(g({type:"error",message:o.msg}),this.loadingGroup[t]=!1)}).catch(o=>{})}).catch(a=>{console.error(a)})},closeSettings(){this.indexName="",this.settingsType="add",this.openSettings=!1},closeMappings(){this.indexName="",this.mappingTitle="add",this.openMappings=!1},search(){this.page=1,this.pageshow=!1,this.searchData(),this.$nextTick(()=>{this.pageshow=!0})},filterData(e,t){return Z(e,t)},handleSizeChange(e){console.log(`每页 ${e} 条`),this.limit=e,this.pageLimit()},handleCurrentChange(e){console.log(`当前页: ${e}`),this.page=e,this.pageLimit()},pageLimit(){this.list=this.allList.filter((e,t)=>t<this.page*this.limit&&t>=this.limit*(this.page-1))},searchData(){this.connectLoading=!0;const e={cat:"CatIndices",es_connect:G.GetSelectEsConnID()};this.indexTishiList=[],ke(e).then(t=>{if(t.code==0){const a=t.data;for(const n in a){const d=a[n];for(const N in d){let L=parseInt(d[N]);isNaN(L)&&(L=d[N]),a[n][N.split(".").join("->")]=L}this.indexTishiList.push({value:d.index,data:d.index})}let o=[];if(this.status.trim()!="")for(const n of a)n.health==this.status.trim()&&o.push(n);else o=a;o=Z(o,this.input.trim()),this.allList=o,this.total=o.length,this.pageLimit()}else g({type:"error",message:t.msg});this.connectLoading=!1}).catch(t=>{console.log(t),this.connectLoading=!1})}}},ct=e=>(Ke("data-v-af83d807"),e=e(),We(),e),pt={class:"app-container"},mt={class:"search-container"},gt=ct(()=>A("span",{id:"lixianglong"},"筛选 ",-1)),ft={class:"search-container operate"},ht={class:"search-container operate"};function yt(e,t,a,o,n,d){const N=c("el-option"),L=c("el-select"),z=c("el-form-item"),h=c("el-col"),M=c("el-autocomplete"),v=c("el-button"),U=c("el-container"),w=c("el-row"),S=c("el-form"),f=c("el-collapse-item"),m=c("el-collapse"),r=c("el-tooltip"),i=c("el-table-column"),_=c("el-table"),V=c("el-pagination"),j=c("json-editor"),E=c("el-tab-pane"),T=c("el-tag"),Q=c("index-select"),X=c("el-link"),q=c("alias"),J=c("el-tabs"),D=c("el-drawer"),P=c("settings"),B=c("mappings"),p=ue("loading");return y(),F("div",pt,[A("div",mt,[l(m,{modelValue:n.activeNames,"onUpdate:modelValue":t[2]||(t[2]=u=>n.activeNames=u)},{default:s(()=>[l(f,{name:"1"},{title:s(()=>[gt]),default:s(()=>[l(S,null,{default:s(()=>[l(w,{gutter:20},{default:s(()=>[l(h,{lg:3,md:12,sm:4,xl:6,xs:24},{default:s(()=>[l(z,{label:"状态"},{default:s(()=>[l(L,{id:"index-health-status",modelValue:n.status,"onUpdate:modelValue":t[0]||(t[0]=u=>n.status=u),class:"filter-item width150",filterable:"",onChange:d.search},{default:s(()=>[l(N,{label:e.$t("所有"),value:""},null,8,["label"]),l(N,{label:"green",value:"green"}),l(N,{label:"yellow",value:"yellow"}),l(N,{label:"red",value:"red"})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),l(h,{lg:8,md:12,sm:12,xl:6,xs:24},{default:s(()=>[l(z,{label:"索引名"},{default:s(()=>[l(U,null,{default:s(()=>[l(M,{class:"filter-item width300",id:"index-keyword",clearable:"","fetch-suggestions":d.querySearch,style:{width:"300px"},modelValue:n.input,"onUpdate:modelValue":t[1]||(t[1]=u=>n.input=u),placeholder:e.$t("请输入索引名")},{default:s(({item:u})=>[A("span",null,x(u.value),1)]),_:1},8,["fetch-suggestions","modelValue","placeholder"]),l(v,{id:"index-search",type:"primary",icon:e.Search,onClick:d.search},null,8,["icon","onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(S,{style:{"margin-top":"15px"}},{default:s(()=>[l(w,{gutter:20},{default:s(()=>[l(h,{lg:20,md:12,sm:4,xl:6,xs:24},{default:s(()=>[l(z,{label:"索引操作"},{default:s(()=>[l(U,null,{default:s(()=>[l(r,{content:"关闭",placement:"top"},{default:s(()=>[I(l(v,{disabled:n.loadingGroup.close,id:"patchCloseIndex",type:"danger",icon:e.Hide,onClick:t[3]||(t[3]=u=>d.Close("close",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup.close]])]),_:1}),l(r,{content:"打开",placement:"top"},{default:s(()=>[I(l(v,{id:"patchOpenIndex",disabled:n.loadingGroup.open,type:"success",icon:e.View,onClick:t[4]||(t[4]=u=>d.Open("open",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup.open]])]),_:1}),l(r,{content:"新建",placement:"top"},{default:s(()=>[l(v,{icon:e.Plus,id:"new-index",onClick:t[5]||(t[5]=u=>d.openSettingDialog("","add"))},null,8,["icon"])]),_:1}),l(r,{content:"删除",placement:"top"},{default:s(()=>[I(l(v,{icon:e.Delete,id:"patchDeleteIndex",disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[6]||(t[6]=u=>d.deleteIndex(n.selectIndexList.join(","),"deleteIndex"))},null,8,["icon","disabled"]),[[p,n.loadingGroup.deleteIndex]])]),_:1}),l(r,{content:"将节点切换为可读写状态",placement:"top"},{default:s(()=>[I(l(v,{icon:e.Sort,disabled:n.readOnlyAllowDeleteLoading,id:"readOnlyAllowDelete",type:"warning",onClick:t[7]||(t[7]=u=>d.readOnlyAllowDelete())},null,8,["icon","disabled"]),[[p,n.readOnlyAllowDeleteLoading]])]),_:1}),l(r,{content:"将所选索引刷新到磁盘",placement:"top"},{default:s(()=>[I(l(v,{id:"patchFlushIndex",disabled:n.loadingGroup._flush,type:"warning",icon:e.BrushFilled,onClick:t[8]||(t[8]=u=>d.Flush("_flush",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup._flush]])]),_:1}),l(r,{content:"强制合并索引",placement:"top"},{default:s(()=>[I(l(v,{icon:e.Connection,id:"patchForcemergeIndex",disabled:n.loadingGroup._forcemerge,onClick:t[9]||(t[9]=u=>d.Forcemerge("_forcemerge",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[p,n.loadingGroup._forcemerge]])]),_:1}),l(r,{content:"刷新索引",placement:"top"},{default:s(()=>[I(l(v,{id:"patchRefreshIndex",disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[10]||(t[10]=u=>d.Refresh("_refresh",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup._refresh]])]),_:1}),l(r,{content:"清空索引",placement:"top"},{default:s(()=>[I(l(v,{id:"patchEmptyIndex",disabled:n.loadingGroup.empty,icon:e.DocumentDelete,type:"danger",onClick:t[11]||(t[11]=u=>d.Empty("empty",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup.empty]])]),_:1}),l(r,{content:"清理缓存",placement:"top"},{default:s(()=>[I(l(v,{icon:e.ToiletPaper,id:"patchCacheClear",disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[12]||(t[12]=u=>d.CacheClear("_cache/clear",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[p,n.loadingGroup["_cache/clear"]]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),I((y(),k(_,{data:n.list,onSelectionChange:d.selectChange},{default:s(()=>[l(i,{type:"selection",width:"55"}),l(i,{align:"center",label:e.$t("健康"),width:"100"},{default:s(u=>[u.row.health=="green"?(y(),k(v,{key:0,type:"success",circle:""})):O("",!0),u.row.health=="yellow"?(y(),k(v,{key:1,type:"warning",circle:""})):O("",!0),u.row.health=="red"?(y(),k(v,{key:2,type:"danger",circle:""})):O("",!0)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("状态"),width:"100"},{default:s(u=>[I(l(v,{type:"success",onClick:R=>d.Close("close",u.row.index)},{default:s(()=>[C(x(e.$t("开启")),1)]),_:2},1032,["onClick"]),[[se,u.row.status=="open"]]),I(l(v,{type:"danger",onClick:R=>d.Open("open",u.row.index)},{default:s(()=>[C(x(e.$t("关闭")),1)]),_:2},1032,["onClick"]),[[se,u.row.status=="close"]])]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("索引名"),width:"180"},{default:s(u=>[C(x(u.row.index),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("uuid"),width:"180"},{default:s(u=>[C(x(u.row.uuid),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主分片数"),width:"80",prop:"pri",sortable:""},{default:s(u=>[C(x(u.row.pri),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("副本分片数量"),width:"80",prop:"rep",sortable:""},{default:s(u=>[C(x(u.row.rep),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("文档总数"),width:"80",prop:"docs->count",sortable:""},{default:s(u=>[C(x(d.bigNumberTransform(u.row["docs.count"])),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("删除状态的文档"),width:"80",prop:"docs->deleted",sortable:""},{default:s(u=>[C(x(u.row["docs.deleted"]),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主+副本分片大小"),width:"120",prop:"store->size",sortable:""},{default:s(u=>[C(x(u.row["store.size"]),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主分片大小"),width:"150",prop:"pri->store->size",sortable:""},{default:s(u=>[C(x(u.row["pri.store.size"]),1)]),_:1},8,["label"]),l(i,{align:"center",width:"190",label:e.$t("操作"),fixed:"right"},{default:s(u=>[l(r,{content:"修改配置",placement:"top"},{default:s(()=>[l(v,{icon:e.Setting,type:"info",onClick:R=>d.openSettingDialog(u.row.index,"update")},null,8,["icon","onClick"])]),_:2},1024),l(r,{content:"修改映射",placement:"top"},{default:s(()=>[l(v,{icon:e.EditPen,type:"waring",onClick:R=>d.openMappingEditDialog(u.row.index,!1)},null,8,["icon","onClick"])]),_:2},1024),l(r,{content:"更多",placement:"top"},{default:s(()=>[l(v,{icon:e.More,type:"primary",onClick:R=>d.openDrawer(u.row.index)},null,8,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[p,n.connectLoading]]),n.pageshow?(y(),k(V,{key:0,class:"pagination-container","current-page":n.page,"page-sizes":[10,20,30,50,100,150,200,500,1e3],"page-size":n.limit,layout:"total, sizes, prev, pager, next",total:n.total,onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])):O("",!0),l(D,{ref:"drawer",title:n.indexName,"before-close":d.drawerHandleClose,modelValue:n.drawerShow,"onUpdate:modelValue":t[27]||(t[27]=u=>n.drawerShow=u),direction:"rtl","custom-class":"demo-drawer","close-on-press-escape":"","destroy-on-close":"",size:d.isMobile?"100%":"50%"},{default:s(()=>[l(J,{modelValue:n.activeName,"onUpdate:modelValue":t[26]||(t[26]=u=>n.activeName=u),onTabClick:d.changeTab},{default:s(()=>[l(E,{label:e.$t("设置"),name:"Settings"},{default:s(()=>[n.showSettings?(y(),k(j,{key:0,value:n.settingData,"onUpdate:value":t[13]||(t[13]=u=>n.settingData=u),styles:"width: 100%",read:!0,title:e.$t("设置")},null,8,["value","title"])):O("",!0)]),_:1},8,["label"]),l(E,{label:e.$t("映射"),name:"Mapping"},{default:s(()=>[A("div",ft,[l(T,{type:"warning"},{default:s(()=>[C(x(e.$t("切换为其它索引的映射")),1)]),_:1}),l(Q,{clearable:!0,style:{width:"150px"},placeholder:e.$t("请选择索引名"),onChange:d.changeMapToAnotherIndex},null,8,["placeholder","onChange"]),l(T,{type:"primary"},{default:s(()=>[C(x(e.$t("操作")),1)]),_:1}),I((y(),k(v,{disabled:n.loadingGroup.saveMappinng,type:"primary",onClick:d.saveMappinng},{default:s(()=>[C(x(e.$t("修改")),1)]),_:1},8,["disabled","onClick"])),[[p,n.loadingGroup.saveMappinng]]),l(X,{type:"danger"},{default:s(()=>[C(x(e.$t("【注意：只能新增映射字段不可修改映射字段类型】")),1)]),_:1})]),n.showMapping?(y(),k(j,{key:0,value:n.mappingData,"onUpdate:value":t[14]||(t[14]=u=>n.mappingData=u),styles:"width: 100%",read:!1,title:e.$t("映射"),onGetValue:d.getMapping},null,8,["value","title","onGetValue"])):O("",!0)]),_:1},8,["label"]),l(E,{label:"Stats",name:"Stats"},{default:s(()=>[n.showStats?(y(),k(j,{key:0,value:n.statsData,"onUpdate:value":t[15]||(t[15]=u=>n.statsData=u),styles:"width: 100%;",read:!0,title:"Stats"},null,8,["value"])):O("",!0)]),_:1}),l(E,{label:e.$t("编辑索引配置"),name:"editSettings"},{default:s(()=>[l(S,null,{default:s(()=>[l(z,{label:e.$t("编辑索引配置")},{default:s(()=>[l(v,{type:"primary",onClick:t[16]||(t[16]=u=>d.submitSettings())},{default:s(()=>[C(x(e.$t("提交")),1)]),_:1}),l(v,{onClick:d.resetSettings},{default:s(()=>[C(x(e.$t("重置")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),l(z,null,{default:s(()=>[n.showEditSettings?(y(),k(j,{key:0,value:n.editSettingsData,"onUpdate:value":t[17]||(t[17]=u=>n.editSettingsData=u),"point-out":n.pointOut,styles:"width: 100%;",read:!1,title:e.$t("编辑配置"),onGetValue:d.getSettings},null,8,["value","point-out","title","onGetValue"])):O("",!0)]),_:1})]),_:1})]),_:1},8,["label"]),l(E,{label:e.$t("修改别名"),name:"alias"},{default:s(()=>[n.activeName=="alias"?(y(),k(q,{key:0,"index-name":n.indexName},null,8,["index-name"])):O("",!0)]),_:1},8,["label"]),A("div",ht,[l(S,null,{default:s(()=>[l(z,{label:"操作"},{default:s(()=>[l(r,{content:"关闭",placement:"top"},{default:s(()=>[I(l(v,{icon:e.Hide,disabled:n.loadingGroup.close,type:"danger",onClick:t[18]||(t[18]=u=>d.Close("close",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup.close]])]),_:1}),l(r,{content:"打开",placement:"top"},{default:s(()=>[I(l(v,{icon:e.View,disabled:n.loadingGroup.open,type:"success",onClick:t[19]||(t[19]=u=>d.Open("open",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup.open]])]),_:1}),l(r,{content:"强制合并索引【forcemerge操作,手动释放磁盘空间】",placement:"top"},{default:s(()=>[I(l(v,{disabled:n.loadingGroup._forcemerge,icon:e.Connection,onClick:t[20]||(t[20]=u=>d.Forcemerge("_forcemerge",n.indexName))},null,8,["disabled","icon"]),[[p,n.loadingGroup._forcemerge]])]),_:1}),l(r,{content:"刷新索引【为了让最新的数据可以立即被搜索到】",placement:"top"},{default:s(()=>[I(l(v,{disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[21]||(t[21]=u=>d.Refresh("_refresh",n.indexName))},null,8,["disabled","icon"]),[[p,n.loadingGroup._refresh]])]),_:1}),l(r,{content:"将索引刷新到磁盘【让数据持久化到磁盘中】",placement:"top"},{default:s(()=>[I(l(v,{icon:e.BrushFilled,disabled:n.loadingGroup._flush,type:"info",onClick:t[22]||(t[22]=u=>d.Flush("_flush",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup._flush]])]),_:1}),l(r,{content:"清理缓存",placement:"top"},{default:s(()=>[I(l(v,{icon:e.ToiletPaper,disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[23]||(t[23]=u=>d.CacheClear("_cache/clear",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup["_cache/clear"]]])]),_:1}),l(r,{content:"删除索引",placement:"top"},{default:s(()=>[I(l(v,{icon:e.Delete,disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[24]||(t[24]=u=>d.deleteIndex(n.indexName,"deleteIndex"))},null,8,["icon","disabled"]),[[p,n.loadingGroup.deleteIndex]])]),_:1}),l(r,{content:"清空索引",placement:"top"},{default:s(()=>[I(l(v,{disabled:n.loadingGroup.empty,type:"danger",icon:e.DocumentDelete,onClick:t[25]||(t[25]=u=>d.Empty("empty",n.indexName))},null,8,["disabled","icon"]),[[p,n.loadingGroup.empty]])]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue","onTabClick"])]),_:1},8,["title","before-close","modelValue","size"]),n.openSettings?(y(),k(P,{key:1,"index-name":n.indexName,"settings-type":n.settingsType,onFinished:d.search,open:n.openSettings,onClose:d.closeSettings},null,8,["index-name","settings-type","onFinished","open","onClose"])):O("",!0),n.openMappings?(y(),k(B,{key:2,"index-name":n.indexName,title:n.mappingTitle,open:n.openMappings,onClose:d.closeMappings},null,8,["index-name","title","open","onClose"])):O("",!0)])}const Dt=oe(ut,[["render",yt],["__scopeId","data-v-af83d807"]]);export{Dt as default};
