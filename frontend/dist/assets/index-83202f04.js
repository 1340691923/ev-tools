import{c as me}from"./index-0aae8c1b.js";import{f as $,R as xe,C as ke}from"./es-6fe4f219.js";import{C as ge,G as fe,S as he,a as Ce,A as Se,B as De,R as Ge,M as Ne,F as Ie,E as Oe,b as Ve,c as Ae,O as ze,d as je,e as Te,f as Le,D as Ee}from"./es-index-e86248ea.js";import{U as ye,L as le,e as Me}from"./es-map-f7b705b8.js";import{f as N,g as _e,h as re,i as de,r as c,o as y,c as U,a as l,w as s,j as S,t as k,E as g,k as I,l as Je,m as j,n as q,b as C,u as ee,p as Fe,q as Ue,s as te,F as ne,v as ae,x as Be,y as z,z as Pe,A as ue,B as G,C as Re,D as se,I as He,G as Ke,H as We}from"./index-f7d1c908.js";import{J as ve}from"./index-6d5426a5.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import{I as be}from"./select-e38493ad.js";function qe(e){const t=["","",""];let a=1e3,o=3;for(;e/a>=1;)a*=10,o+=1;if(o<=4)t[1]="千",t[0]=parseInt(e/1e3)+"";else if(o<=8){const n=parseInt(o-4)/3>1?"千万":"万",i=n==="万"?1e4:1e7;t[1]=n,t[0]=e/i+""}else if(o<=16){let n=(o-8)/3>1?"千亿":"亿";n=(o-8)/4>1?"万亿":n,n=(o-8)/7>1?"千万亿":n;let i=1;n==="亿"?i=1e8:n==="千亿"?i=1e11:n==="万亿"?i=1e12:n==="千万亿"&&(i=1e15),t[1]=n,t[0]=parseInt(e/i)+""}return e<1e3&&(t[1]="",t[0]=e+""),t.join("")}const Qe={__name:"settings",props:{indexName:{type:String,default:""},settingsType:{type:String,default:"add"},open:{type:Boolean,default:!1}},emits:["finished","close"],setup(e,{emit:t}){const a=e,o=N(a.indexName),n=N(a.settingsType),i=N(a.open),O=t,L=N(["number_of_shards","index.translog.sync_interval","index.shard.check_on_startup","index.routing_partition_size","index.codec"]),A=N(!1),h=N({"index.shard.check_on_startup":"","index.routing_partition_size":"","index.codec":"","index.auto_expand_replicas":"","index.max_result_window":"","index.max_rescore_window":"","index.blocks.read_only":"","index.blocks.read":"","index.blocks.write":"","index.blocks.metadata":"","index.blocks.read_only_allow_delete":"","index.max_refresh_listeners":"",number_of_shards:"",number_of_replicas:"",refresh_interval:"","index.translog.sync_interval":"","index.translog.durability":"","index.translog.flush_threshold_size":"","index.merge.scheduler.max_thread_count":"","index.merge.policy.max_merged_segment":"","index.merge.policy.segments_per_tier":""}),J=_e(()=>n.value==="add"?"新增索引配置":"修改索引配置"),R=()=>{if(h.value["index.routing_partition_size"]>=h.value["index.number_of_shards"]){g({type:"error",message:"自定义路由值可以转发的目的分片数 必须小于 主分片数"});return}if(o.value===""){g({type:"error",message:"索引名不能为空"});return}const f={};if(f.es_connect=I.sdk.GetSelectEsConnID(),f.settings=me(h.value),f.index_name=o.value,f.types=n.value,n.value==="update")for(const u of L.value)delete f.settings[u];for(const u in f.settings)f.settings[u]===""&&delete f.settings[u];const m=Je.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});ge(f).then(u=>{u.code===0||u.code===200?(g({type:"success",message:u.msg}),a.settingsType="update",O("finished")):g({type:"error",message:u.msg}),m.close()}).catch(u=>{m.close()})},v=()=>{const f={};f.es_connect=I.sdk.GetSelectEsConnID(),f.index_name=o.value,fe(f).then(m=>{if(m.code===0||m.code===200){const u=m.data.index;if(h.value.number_of_replicas=u.number_of_replicas,h.value.number_of_shards=u.number_of_shards,u.hasOwnProperty("auto_expand_replicas")&&(h.value["index.auto_expand_replicas"]=u.auto_expand_replicas),u.hasOwnProperty("blocks")){const r=u.blocks;r.hasOwnProperty("metadata")&&(h.value["index.blocks.metadata"]=r.metadata),r.hasOwnProperty("read")&&(h.value["index.blocks.read"]=r.read),r.hasOwnProperty("read_only")&&(h.value["index.blocks.read_only"]=r.read_only),r.hasOwnProperty("read_only_allow_delete")&&(h.value["index.blocks.read_only_allow_delete"]=r.read_only_allow_delete),r.hasOwnProperty("write")&&(h.value["index.blocks.write"]=r.write)}if(u.hasOwnProperty("merge")){const r=u.merge;if(r.hasOwnProperty("policy")){const p=r.policy;p.hasOwnProperty("max_merged_segment")&&(h.value["index.merge.policy.max_merged_segment"]=p.max_merged_segment),p.hasOwnProperty("max_merged_segment")&&(h.value["index.merge.policy.segments_per_tier"]=p.segments_per_tier)}if(r.hasOwnProperty("scheduler")){const p=r.scheduler;p.hasOwnProperty("max_thread_count")&&(h.value["index.merge.scheduler.max_thread_count"]=p.max_thread_count)}}if(u.hasOwnProperty("max_refresh_listeners")&&(h.value["index.max_refresh_listeners"]=u.max_refresh_listeners),u.hasOwnProperty("max_rescore_window")&&(h.value["index.max_rescore_window"]=u.max_rescore_window),u.hasOwnProperty("max_result_window")&&(h.value["index.max_result_window"]=u.max_result_window),u.hasOwnProperty("refresh_interval")&&(h.value.refresh_interval=u.refresh_interval),u.hasOwnProperty("translog")){const r=u.translog;r.hasOwnProperty("durability")&&(h.value["index.translog.durability"]=r.durability),r.hasOwnProperty("flush_threshold_size")&&(h.value["index.translog.flush_threshold_size"]=r.flush_threshold_size)}console.log(h.value,"form")}else g({type:"error",message:m.msg})}).catch(m=>{console.log(m)})},w=()=>{const f={};f.es_connect=I.sdk.GetSelectEsConnID(),f.index_name=o.value,he(f).then(m=>{m.code==0||m.code==200?A.value=m.data[0].status=="open":g({type:"error",message:m.msg})}).catch(m=>{console.error(m)})},_=()=>{O("close")};return re(()=>{console.log("settings mounted"),o.value!=""&&(w(),v())}),de(()=>{console.log("settings activated")}),(f,m)=>{const u=c("el-input"),r=c("el-form-item"),p=c("el-form"),T=c("el-button"),F=c("el-card"),M=c("el-drawer");return y(),U("div",null,[l(M,{size:"90%",modelValue:i.value,"onUpdate:modelValue":m[5]||(m[5]=V=>i.value=V),title:J.value,onClose:_},{default:s(()=>[l(F,{class:"box-card"},{footer:s(()=>[l(T,{type:"danger",onClick:_},{default:s(()=>[S(k(f.$t("取消")),1)]),_:1}),l(T,{type:"primary",onClick:R},{default:s(()=>[S(k(f.$t("确认")),1)]),_:1})]),default:s(()=>[l(p,{"label-width":"500px","label-position":"left"},{default:s(()=>[l(r,{label:f.$t("索引名称：")},{default:s(()=>[l(u,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=V=>o.value=V),placeholder:f.$t("多个索引名用,隔开"),disabled:n.value!=="add"},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),l(r,{label:"number_of_shards (分片数)："},{default:s(()=>[l(u,{modelValue:h.value.number_of_shards,"onUpdate:modelValue":m[1]||(m[1]=V=>h.value.number_of_shards=V),type:"number",style:{width:"300px"},disabled:A.value},null,8,["modelValue","disabled"])]),_:1}),l(r,{label:"number_of_replicas (副本数)："},{default:s(()=>[l(u,{modelValue:h.value.number_of_replicas,"onUpdate:modelValue":m[2]||(m[2]=V=>h.value.number_of_replicas=V),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(r,{label:"refresh_interval (索引的刷新时间间隔)："},{default:s(()=>[l(u,{modelValue:h.value.refresh_interval,"onUpdate:modelValue":m[3]||(m[3]=V=>h.value.refresh_interval=V),placeholder:f.$t("索引的刷新时间间隔")},null,8,["modelValue","placeholder"])]),_:1}),l(r,{label:"max_result_window  (from+size 的最大值)："},{default:s(()=>[l(u,{modelValue:h.value["index.max_result_window"],"onUpdate:modelValue":m[4]||(m[4]=V=>h.value["index.max_result_window"]=V),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}};const Xe={key:0,class:"item"},Ye={key:1,style:{"margin-left":"14px"}},Ze={class:"item-type item-cell"},$e={class:"item-value item-cell"},W=8,et={__name:"Item",props:{item:{type:Object,default:{key:"",value:"",type:""}},names:{type:Array},parent:{type:Object},index:{type:Number,default:0},deep:{type:Number,default:0},size:{type:String,default:"small"},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0}},setup(e){const t=e,a=N(!t.openFlag),o=N(t.deep+1),n=[{value:"String",label:"String"},{value:"Object",label:"Object"},{value:"Array",label:"Array"},{value:"Number",label:"Number"},{value:"Boolean",label:"Boolean"}],i=[{value:"Object",label:"Object"},{value:"Array",label:"Array"}],O=[{value:"type",data:" 数据类型"},{value:"format",data:" 时间格式化"},{value:"analyzer",data:" 分词器"},{value:"normalizer",data:" 分析器"},{value:"boost",data:" 权重"},{value:"coerce",data:" 强制类型转换"},{value:"copy_to",data:" 合并参数"},{value:"doc_values",data:" 文档值"},{value:"dynamic",data:" 动态设置"},{value:"enabled",data:" 是否开启字段"},{value:"fielddata",data:" 字段数据"},{value:"ignore_above",data:" 字段保存最大长度"},{value:"ignore_malformed",data:" 忽略格式不对的数据"},{value:"include_in_all",data:" _all 查询包含字段"},{value:"index_options",data:" 索引设置"},{value:"index",data:" 是否可以被搜索"},{value:"fields",data:" 字段"},{value:"norms",data:" 标准信息"},{value:"null_value",data:" 空值"},{value:"position_increment_gap",data:" 短语位置间隙"},{value:"properties",data:" 属性"},{value:"search_analyzer",data:" 搜索分析器"},{value:"similarity",data:" 匹配算法"},{value:"store",data:" 字段是否被存储"},{value:"term_vector",data:" 词根信息"}],L=[{value:"text",data:"字符串类型(可分词) "},{value:"keyword",data:"字符串类型(不可分词) "},{value:"long",data:"数字类型 "},{value:"integer",data:"数字类型 "},{value:"short",data:"数字类型 "},{value:"byte",data:"数字类型 "},{value:"double",data:"数字类型 "},{value:"float",data:"数字类型 "},{value:"half_float",data:"数字类型 "},{value:"scaled_float",data:"数字类型 "},{value:"date",data:"时间类型 "},{value:"boolean",data:"布尔类型 "},{value:"binary",data:"二进制类型 "},{value:"Array",data:"数组类型 "},{value:"object",data:"对象类型  "},{value:"nested",data:"嵌套类型 "},{value:"geo_point",data:"地理类型 "},{value:"geo_shape",data:"多边形类型 "},{value:"ip",data:"ip类型 "},{value:"completion",data:"补全类型 "},{value:"token_count",data:"令牌计数类型 "},{value:"yyyy-MM-dd HH:mm:ss",data:"时间格式化 "}],A=["el-tag-blue","el-tag-orange"],h=["item-cell item-control-cell","item-cell"],J=["el-input el-input--small"],R=(u,r)=>{let p=JSON.parse(JSON.stringify(O));if(u==null&&(u=""),u.trim()==""){p.length>W?r(p.slice(0,W)):r(p);return}p=$(p,u.trim()),p.length>W?r(p.slice(0,W)):r(p)},v=(u,r)=>{let p=JSON.parse(JSON.stringify(L));if(u==null&&(u=""),u.trim()==""){p.length>W?r(p.slice(0,W)):r(p);return}p=$(p,u.trim()),p.length>W?r(p.slice(0,W)):r(p)},w=u=>{const r=O.find(p=>p.value===u);return r?r.data:""},_=()=>{["Object","Array"].includes(t.item.type)&&(a.value=!1)},f=()=>{t.item.childs||(t.item.childs=[]),t.item.childs.push({key:"",value:"",type:""})},m=()=>{const u=t.parent.childs.indexOf(t.item);u>-1&&t.parent.childs.splice(u,1)};return(u,r)=>{const p=c("el-icon"),T=c("el-link"),F=c("el-tag"),M=c("el-autocomplete"),V=c("el-option"),Q=c("el-select"),Y=c("el-input-number"),X=c("el-radio"),E=c("el-radio-group"),D=c("el-tooltip"),B=c("el-popconfirm"),P=c("el-row");return y(),U("div",null,[l(P,{style:te("padding-left: "+(o.value-1)*15+"px; margin-top: 5px")},{default:s(()=>[e.rootFlag?(y(),U("div",Xe,[j("div",{class:q(h),onClick:r[0]||(r[0]=b=>a.value=!a.value)},[e.item.childs!=null?(y(),C(T,{key:0,underline:!1},{default:s(()=>[a.value?(y(),C(p,{key:0},{default:s(()=>[l(ee(Fe))]),_:1})):(y(),C(p,{key:1},{default:s(()=>[l(ee(Ue))]),_:1}))]),_:1})):(y(),U("i",Ye))]),j("div",{class:"item-cell",onClick:r[1]||(r[1]=b=>a.value=!a.value)},[l(T,{underline:!1},{default:s(()=>[l(F,{effect:"plain",class:q(A)},{default:s(()=>[j("span",null,k(w(e.item.key)?w(e.item.key):e.item.key),1)]),_:1})]),_:1})]),j("div",{class:"item-key item-cell",style:te("width: "+(300-(o.value-1)*15)+"px")},[l(M,{modelValue:e.item.key,"onUpdate:modelValue":r[2]||(r[2]=b=>e.item.key=b),clearable:"","fetch-suggestions":R,placeholder:e.parent.type=="Array"?"":"请输入键",size:e.size,disabled:e.item.isRoot||e.parent.type=="Array",style:te("width: "+(290-(o.value-1)*15)+"px")},{default:s(({item:b})=>[j("span",null,k(b.value)+"-"+k(b.data),1)]),_:1},8,["modelValue","placeholder","size","disabled","style"])],4),j("div",Ze,[l(Q,{modelValue:e.item.type,"onUpdate:modelValue":r[3]||(r[3]=b=>e.item.type=b),size:e.size,placeholder:"请选择",class:"select-body",onChange:_},{default:s(()=>[(y(!0),U(ne,null,ae(e.item.isRoot?i:n,b=>(y(),C(V,{key:b.value,label:b.label,value:b.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","size"])]),j("div",$e,[e.item.type!="Number"&&e.item.type!="Boolean"?(y(),C(M,{key:0,modelValue:e.item.value,"onUpdate:modelValue":r[4]||(r[4]=b=>e.item.value=b),"fetch-suggestions":v,clearable:"",size:e.size,placeholder:e.item.type=="Array"||e.item.type=="Object"?"":"请输入值",disabled:e.item.type=="Array"||e.item.type=="Object",class:q(J)},{default:s(({item:b})=>[j("span",null,k(b.value)+"-"+k(b.data),1)]),_:1},8,["modelValue","size","placeholder","disabled"])):e.item.type=="Number"?(y(),C(Y,{key:1,modelValue:e.item.value,"onUpdate:modelValue":r[5]||(r[5]=b=>e.item.value=b),size:e.size,class:q(J)},null,8,["modelValue","size"])):(y(),C(E,{key:2,modelValue:e.item.value,"onUpdate:modelValue":r[6]||(r[6]=b=>e.item.value=b),class:q(J)},{default:s(()=>[l(X,{class:"el-radio",label:!0},{default:s(()=>[S("是")]),_:1}),l(X,{class:"el-radio",label:!1},{default:s(()=>[S("否")]),_:1})]),_:1},8,["modelValue"]))]),j("div",{class:q(h)},[e.item.type=="Array"||e.item.type=="Object"?(y(),C(D,{key:0,class:"item-control-cell",content:"添加子元素",placement:"top"},{default:s(()=>[l(T,{underline:!1,onClick:f},{default:s(()=>[l(p,null,{default:s(()=>[l(ee(Be))]),_:1})]),_:1})]),_:1})):z("",!0),e.item.isRoot?z("",!0):(y(),C(B,{key:1,title:"确定删除当前节点吗？",onConfirm:m},{default:s(()=>[l(T,{slot:"reference",underline:!1,class:"item-control-cell"},{default:s(()=>[l(p,null,{default:s(()=>[l(ee(Pe))]),_:1})]),_:1})]),_:1}))])])):z("",!0)]),_:1},8,["style"]),j("div",{style:te(a.value?"display: none":"display: block")},[e.item.childs&&e.item.type=="Object"?(y(!0),U(ne,{key:0},ae(e.item.childs,(b,x)=>(y(),U("span",{key:x},[l(ie,{size:e.size,item:b,parent:e.item,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","names","deep","open-flag"])]))),128)):z("",!0),e.item.childs&&e.item.type=="Array"?(y(!0),U(ne,{key:1},ae(e.item.childs,(b,x)=>(y(),U("span",{key:x},[l(ie,{size:e.size,item:b,parent:e.item,index:x,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","index","names","deep","open-flag"])]))),128)):z("",!0)],4)])}}},ie=oe(et,[["__scopeId","data-v-b61ac616"]]);const tt={name:"VueJsonHelper",components:{Item:ie},props:{names:{type:Array},size:{type:String,default:"small"},jsonStr:{type:String},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0},borderFlag:{type:Boolean,default:!0},shadowFlag:{type:Boolean,default:!1},backTopFlag:{type:Boolean,default:!1}},data(){return{deep:0,isJson:!1,jsonData:void 0,errorResult:void 0,item:{key:"Root",value:null,type:null,isRoot:!0,childs:[]}}},watch:{item:{handler(e,t){if(e==t){var a=this.handleJsonData(e);a!=null&&this.$emit("jsonListener",a)}},immediate:!0,deep:!0}},created(){this.isJson=this.judgeJson(),this.item.childs=this.handleJson(this.jsonData),this.item.type=this.handleType()},methods:{judgeJson(){var e=!1;try{this.jsonData=JSON.parse(this.jsonStr),e=!0}catch(t){this.errorResult=t,e=!1}return e},handleJsonData(e){var t={},a=[],o=e.type,n=e.childs;for(var i in n)n[i].type!="Object"&&n[i].type!="Array"?o=="Object"?t[n[i].key]=n[i].value:o=="Array"&&a.push(n[i].value):o=="Object"?t[n[i].key]=this.handleJsonData(n[i]):o=="Array"&&a.push(this.handleJsonData(n[i]));if(o=="Object")return t;if(o=="Array")return a},handleJson(e){var t=[];for(var a in e){var o=this.judgeType(e[a]);if(o=="Object"||o=="Array"){var n={key:a,value:null,type:o,childs:this.handleJson(e[a])};t.push(n)}else{var n={key:a,value:e[a],type:o};t.push(n)}}return t},judgeType(e){var t=Object.prototype.toString.call(e);return t==="[object String]"?t="String":t==="[object Number]"?t="Number":t==="[object Boolean]"?t="Boolean":t==="[object Array]"?t="Array":t==="[object Object]"?t="Object":t=null,t},handleType(){return this.judgeType(this.jsonData)}}};function lt(e,t,a,o,n,i){const O=c("Item"),L=c("el-col"),A=c("el-backtop"),h=c("el-row");return y(),C(h,{class:q(a.borderFlag?"el-row-border":"")},{default:s(()=>[n.isJson?(y(),C(L,{key:0,class:"item-body"},{default:s(()=>[l(O,{item:n.item,deep:n.deep,parent:n.item,names:a.names,size:a.size,index:0,"root-flag":a.rootFlag,"open-flag":a.openFlag},null,8,["item","deep","parent","names","size","root-flag","open-flag"])]),_:1})):(y(),C(L,{key:1},{default:s(()=>[j("i",null,k(n.errorResult),1)]),_:1})),a.backTopFlag?(y(),C(A,{key:2})):z("",!0)]),_:1},8,["class"])}const nt=oe(tt,[["render",lt],["__scopeId","data-v-3832d5a3"]]);const at={class:"app-container"},st={class:"search-container"},ot={__name:"mapping",props:{indexName:{type:String,default:""},open:{type:Boolean,default:!1},title:{type:String,default:"新增映射结构"}},emits:["close","finished"],setup(e,{emit:t}){const a=e,o=N(a.open),n=N(a.title),i=N(a.indexName),O=N("1"),L=_e(()=>JSON.stringify(JSON.parse(m.value),null,"	")),A=t,h=N(!1),J=N("false"),R=N("small"),v=[{key:"Root",name:"properties"},{key:"type",name:"数据类型"},{key:"format",name:"时间格式化"},{key:"analyzer",name:"分词器"},{key:"normalizer",name:"分析器"},{key:"boost",name:"权重"},{key:"coerce",name:"强制类型转换"},{key:"copy_to",name:"合并参数"},{key:"doc_values",name:"文档值"},{key:"dynamic",name:"动态设置"},{key:"enabled",name:"是否开启字段"},{key:"fielddata",name:"字段数据"},{key:"ignore_above",name:"字段保存最大长度"},{key:"ignore_malformed",name:"忽略格式不对的数据"},{key:"include_in_all",name:"_all 查询包含字段"},{key:"index_options",name:"索引设置"},{key:"index",name:"是否可以被搜索"},{key:"fields",name:"字段"},{key:"norms",name:"标准信息"},{key:"null_value",name:"空值"},{key:"position_increment_gap",name:"短语位置间隙"},{key:"properties",name:"属性"},{key:"search_analyzer",name:"搜索分析器"},{key:"similarity",name:"匹配算法"},{key:"store",name:"字段是否被存储"},{key:"term_vector",name:"词根信息"}],w=N(!0),_=N(!0),f=N(!1),m=N("{}"),u=N(!1),r=N(""),p=N(6),T=N(!1),F=N(!1),M=async()=>{let E={};try{E=JSON.parse(m.value)}catch{g({type:"error",message:"JSON格式不正确"});return}const D={es_connect:I.sdk.GetSelectEsConnID(),index_name:a.indexName},B={properties:E,dynamic:J.value};switch(p.value){case 6:D.properties=B,D.type_name=r.value;break;case 7:case 8:D.properties=B;break}h.value=!0;const{data:P,code:b,msg:x}=await ye(D);h.value=!1,b===0?(g({type:"success",message:x}),A("finished")):g({type:"error",message:x})},V=async()=>{var b,x,d,H;const E={es_connect:I.sdk.GetSelectEsConnID(),index_name:a.indexName},{data:D,code:B,msg:P}=await le(E);if(B!==0){g({type:"error",message:P});return}switch(p.value=D.ver,p.value){case 6:const Z=Object.keys(D.list[a.indexName].mappings);T.value=!0,Z.length===0?F.value=!1:(r.value=Z[0],F.value=!0,J.value=((b=D.list[a.indexName].mappings[r.value])==null?void 0:b.dynamic)??"false",m.value=JSON.stringify(((x=D.list[a.indexName].mappings[r.value])==null?void 0:x.properties)??"{}"));break;case 7:case 8:J.value=((d=D.list[a.indexName].mappings)==null?void 0:d.dynamic)??"false",m.value=JSON.stringify(((H=D.list[a.indexName].mappings)==null?void 0:H.properties)??"{}");break}X()},Q=E=>{m.value=JSON.stringify(E)},Y=()=>{A("close")},X=()=>{u.value=!1,Re(()=>{u.value=!0})};return re(()=>{console.log("mapping mounted"),V()}),de(()=>{console.log("mapping activated")}),(E,D)=>{const B=c("el-input"),P=c("el-form-item"),b=c("el-option"),x=c("el-select"),d=c("el-button"),H=c("el-form"),Z=c("el-tabs"),ce=c("el-tab-pane"),we=c("el-drawer"),pe=ue("loading");return y(),U("div",null,[l(we,{modelValue:o.value,"onUpdate:modelValue":D[4]||(D[4]=K=>o.value=K),title:n.value.concat(`【${i.value}】`),size:"80%",onClose:Y},{default:s(()=>[j("div",at,[j("div",st,[l(H,{inline:!0},{default:s(()=>[T.value?(y(),C(P,{key:0,label:"type"},{default:s(()=>[l(B,{modelValue:r.value,"onUpdate:modelValue":D[0]||(D[0]=K=>r.value=K),readonly:F.value,style:{width:"200px"}},null,8,["modelValue","readonly"])]),_:1})):z("",!0),l(P,{label:"dynamic"},{default:s(()=>[l(x,{style:{width:"100px"},modelValue:J.value,"onUpdate:modelValue":D[1]||(D[1]=K=>J.value=K)},{default:s(()=>[l(b,{label:E.$t("动态映射"),value:"true"},null,8,["label"]),l(b,{label:E.$t("静态映射"),value:"false"},null,8,["label"]),l(b,{label:E.$t("严格映射"),value:"strict"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(P,null,{default:s(()=>[G((y(),C(d,{disabled:h.value,type:"success",onClick:M},{default:s(()=>[S(k(E.$t("保存/修改映射")),1)]),_:1},8,["disabled"])),[[pe,h.value]])]),_:1})]),_:1})]),l(Z),l(Z,{modelValue:O.value,"onUpdate:modelValue":D[3]||(D[3]=K=>O.value=K),stretch:""},{default:s(()=>[l(ce,{name:"1",lazy:!0,label:E.$t("表单")},{default:s(()=>[G((y(),U("div",null,[u.value?(y(),C(nt,{key:0,size:R.value,names:v,"json-str":m.value,"root-flag":w.value,"open-flag":_.value,"back-top-flag":f.value,"shadow-flag":!1,"border-flag":!1,onJsonListener:Q},null,8,["size","json-str","root-flag","open-flag","back-top-flag"])):z("",!0)])),[[pe,!u.value]])]),_:1},8,["label"]),l(ce,{name:"2",lazy:!0,label:E.$t("JSON")},{default:s(()=>[j("div",null,[l(ve,{value:L.value,"onUpdate:value":D[2]||(D[2]=K=>L.value=K),height:"720",styles:"width: 100%",title:r.value},null,8,["value","title"])])]),_:1},8,["label"])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","title"])])}}},it=oe(ot,[["__scopeId","data-v-8fc1805a"]]),rt={__name:"alias",props:{indexName:{type:String,default:""}},setup(e){const t=e,a=N([]),o=N([]),n=()=>{a.value.push({name:"",types:"new"})},i=async()=>{a.value=[];const w={es_connect:I.sdk.GetSelectEsConnID(),index_name:t.indexName},{data:_,code:f,msg:m}=await Ce(w);if(console.log(_,f,m),f===0)for(const u in _)a.value.push({name:_[u].AliasName,types:"old"});else g({message:m,type:"error"})},O=async w=>{const _=a.value[w].name,f={types:1,index_name:t.indexName,alias_name:_.trim(),es_connect:I.sdk.GetSelectEsConnID()},{data:m,code:u,msg:r}=await Se(f);u===0?g({type:"success",message:r}):g({type:"error",message:r})},L=async()=>{const w=a.value.filter(r=>r.types==="new").map(r=>r.name),_={types:4,index_name:t.indexName,new_alias_name_list:w,es_connect:I.sdk.GetSelectEsConnID()},{data:f,code:m,msg:u}=await De(_);m===0?g({type:"success",message:u}):g({type:"error",message:u})},A=async w=>{const _=a.value[w];if(_.types==="new")a.value.splice(w,1);else if(_.types==="old"){const f={types:2,index_name:t.indexName,alias_name:_.name.trim(),es_connect:I.sdk.GetSelectEsConnID()},{data:m,code:u,msg:r}=await Ge(f);u===0?(g({type:"success",message:r}),a.value.splice(w,1)):g({type:"error",message:r})}},h=w=>{o.value=w},J=async w=>{const _=a.value[w].name,f={types:3,new_index_list:o.value,alias_name:_.trim(),es_connect:I.sdk.GetSelectEsConnID()},{data:m,code:u,msg:r}=await Ne(f);u===0?g({type:"success",message:r}):g({type:"error",message:r})},R=w=>{g({message:"复制成功！",type:"success"})},v=w=>{g({message:"复制失败！",type:"error"})};return re(()=>{console.log("alias mounted"),i()}),de(()=>{console.log("alias activated")}),(w,_)=>{const f=c("el-button"),m=c("el-form-item"),u=c("el-input"),r=c("el-form"),p=ue("clipboard");return y(),U("div",null,[l(r,null,{default:s(()=>[l(m,null,{default:s(()=>[l(f,{type:"success",onClick:n},{default:s(()=>[S(k(w.$t("新增别名")),1)]),_:1}),l(f,{type:"primary",onClick:L},{default:s(()=>[S(k(w.$t("批量提交")),1)]),_:1}),l(f,{type:"info",onClick:i},{default:s(()=>[S(k(w.$t("重置")),1)]),_:1}),l(be,{style:{width:"210px","margin-left":"5px"},multiple:!0,clearable:!0,placeholder:w.$t("迁移别名到多个索引上"),onChange:h},null,8,["placeholder"])]),_:1}),(y(!0),U(ne,null,ae(a.value,(T,F)=>(y(),C(m,{key:F,label:w.$t("别名")+Number(F+1)},{default:s(()=>[l(u,{modelValue:T.name,"onUpdate:modelValue":M=>T.name=M,readonly:T.types!="new",style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue","readonly"]),G(l(f,{type:"success",onClick:M=>J(F)},{default:s(()=>[S(" 迁移 ")]),_:2},1032,["onClick"]),[[se,o.value.length>0]]),G((y(),C(f,{type:"success"},{default:s(()=>[S(k(w.$t("复制")),1)]),_:2},1024)),[[p,T.name,"copy"],[p,R,"success"],[p,v,"error"]]),G(l(f,{type:"primary",onClick:M=>O(F)},{default:s(()=>[S(k(w.$t("提交")),1)]),_:2},1032,["onClick"]),[[se,T.types=="new"]]),l(f,{type:"danger",onClick:M=>A(F)},{default:s(()=>[S(k(w.$t("删除")),1)]),_:2},1032,["onClick"])]),_:2},1032,["label"]))),128))]),_:1})])}}};const dt={name:"indices",setup(){return He},components:{Settings:Qe,Mappings:it,JsonEditor:ve,Alias:rt,IndexSelect:be},data(){return{is_ban_sys_index:!1,activeNames:"1",indexTishiList:[],modName:"索引管理",aliasList:[],pointOut:Me,settings:{},readOnlyAllowDeleteLoading:!1,loadingGroup:{empty:!1,close:!1,open:!1,_forcemerge:!1,_refresh:!1,_flush:!1,"_cache/clear":!1,deleteIndex:!1,"_all/_flush":!1,saveMappinng:!1},forceMergeLoading:!1,tabLoading:!1,settingData:"{}",mappingData:"{}",statsData:"{}",editSettingsData:"{}",activeName:"Settings",showEditSettings:!0,showSettings:!0,showMapping:!0,showStats:!0,drawerShow:!1,settingsType:"add",mappingTitle:"",indexName:"",openSettings:!1,total:0,connectLoading:!1,page:1,limit:10,pageshow:!0,list:[],input:"",status:"",mappings:{},selectIndexList:[],openMappings:!1,allList:[],max:8}},destroyed(){sessionStorage.setItem("CatIndices",this.input)},computed:{isMobile(){return I.sdk.IsMobile()}},deactivated(){console.log("indices deactivated")},activated(){console.log("indices activated")},mounted(){const e=sessionStorage.getItem("CatIndices");e!=null&&(this.input=e),this.startGuid(),this.GetMapAction(),this.searchData()},methods:{openMappingDialog(e){this.indexName=e,this.openMappings=!0},async finishGuid(){},async startGuid(){},selectChange(e){this.selectIndexList=[];for(const t of e)this.selectIndexList.push(t.index)},async changeMapToAnotherIndex(e){e==""&&(e=this.indexName);const t={};t.es_connect=I.sdk.GetSelectEsConnID(),t.index_name=e;const a=await le(t);a.code==0&&(this.mappingData=JSON.stringify(a.data.list[e].mappings,null,"	"))},getMapping(e){this.mappingData=e},async saveMappinng(){let e=me(this.mappingData);try{e=JSON.parse(e)}catch{g({type:"error",message:"JSON格式不正确"});return}const t=Object.keys(e);if(t.length==0){g({type:"error",message:"请按格式写type名字"});return}const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=this.indexName,e[t[0]].toString()!="false"?(a.properties=e[t[0]],a.type_name=t[0]):a.properties=e,this.loadingGroup.saveMappinng=!0;const{data:o,code:n,msg:i}=await ye(a);this.loadingGroup.saveMappinng=!1,n==0?g({type:"success",message:i}):g({type:"error",message:i})},openMappingEditDialog(e,t){t?this.mappingTitle="新增字段":this.mappingTitle="新增映射结构",this.indexName=e,this.openMappings=!0},async GetMapAction(){const e={};e.es_connect=I.sdk.GetSelectEsConnID();const{code:t,data:a,msg:o}=await le(e);if(t==0)this.mappings=a.list;else{g({type:"error",message:o});return}},submitSettings(){const e={};e.es_connect=I.sdk.GetSelectEsConnID();try{e.settings=JSON.parse(this.editSettingsData)}catch(a){console.log(a),g({type:"error",message:"JSON 解析异常"});return}e.index_name=this.indexName,e.types="update";const t=this.$loading({lock:!0,text:"Loading",spinner:"el-button-loading",background:"rgba(0, 0, 0, 0.7)"});ge(e).then(a=>{a.code==0||a.code==200?(g({type:"success",message:a.msg}),this.search()):g({type:"error",message:a.msg}),t.close()}).catch(a=>{t.close()})},getSettings(e){this.editSettingsData=e},resetSettings(){this.changeTab()},Forcemerge(e,t){const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ie(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Empty(e,t){const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Oe(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Flush(e,t){const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ve(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},CacheClear(e,t){const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ae(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Open(e,t){const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,ze(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Close(e,t){const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,je(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Refresh(e,t){const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Te(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},async changeTab(e){let t=0;e!=null&&(t=Number(e.index));const a={};let o={};switch(a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=this.indexName,t){case 0:o=await Le(a),o.code==0&&(this.settingData=JSON.stringify(o.data,null,"	")),this.showSettings=!1,this.$nextTick(()=>{this.showSettings=!0});return;case 1:o=await le(a),o.code==0&&(this.mappingData=JSON.stringify(o.data.list[this.indexName].mappings,null,"	"),Object.keys(o.data.list[this.indexName].mappings).length==0&&g({type:"error",message:"您还没有设置映射结构"})),this.showMapping=!1,this.$nextTick(()=>{this.showMapping=!0});return;case 2:o=await he(a),o.code==0&&(this.statsData=JSON.stringify(o.data,null,"	")),this.showStats=!1,this.$nextTick(()=>{this.showStats=!0});return;case 3:const{data:n}=await fe(a),i=["creation_date","version","provided_name","uuid","format","number_of_shards"];for(const O of i)n.index.hasOwnProperty(O)&&delete n.index[O];this.editSettingsData=JSON.stringify(n,null,"	"),this.showEditSettings=!1,this.$nextTick(()=>{this.showEditSettings=!0});return;case 4:return;default:return}},openDrawer(e){this.indexName=e,this.changeTab(),this.drawerShow=!0},drawerHandleClose(e){this.indexName="",this.activeName="Settings",e()},bigNumberTransform(e){return qe(e)},openSettingDialog(e,t){this.indexName=e,this.settingsType=t,this.openSettings=!0},readOnlyAllowDelete(){const e={};e.es_connect=I.sdk.GetSelectEsConnID(),this.readOnlyAllowDeleteLoading=!0,xe(e).then(t=>{t.code==0||t.code==200?g({type:"success",message:t.msg}):g({type:"error",message:t.msg}),this.readOnlyAllowDeleteLoading=!1}).catch(t=>{this.readOnlyAllowDeleteLoading=!1})},querySearch(e,t){let a=JSON.parse(JSON.stringify(this.indexTishiList));if(e==null&&(e=""),e.trim()==""){a.length>this.max?t(a.slice(0,this.max)):t(a);return}a=$(a,e.trim()),a.length>this.max?t(a.slice(0,this.max)):t(a)},deleteIndex(e,t){this.$confirm('<div style="white-space: normal;">确定删除<br>['+e.replaceAll(",",",<br/>")+"]索引吗?</div>","警告",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{const a={};a.es_connect=I.sdk.GetSelectEsConnID(),a.index_name=e,this.loadingGroup[t]=!0,Ee(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:e+"已删除"}),this.searchData(),this.loadingGroup[t]=!1):(g({type:"error",message:o.msg}),this.loadingGroup[t]=!1)}).catch(o=>{})}).catch(a=>{console.error(a)})},closeSettings(){this.indexName="",this.settingsType="add",this.openSettings=!1},closeMappings(){this.indexName="",this.mappingTitle="add",this.openMappings=!1},search(){this.page=1,this.pageshow=!1,this.searchData(),this.$nextTick(()=>{this.pageshow=!0})},filterData(e,t){return $(e,t)},handleSizeChange(e){console.log(`每页 ${e} 条`),this.limit=e,this.pageLimit()},handleCurrentChange(e){console.log(`当前页: ${e}`),this.page=e,this.pageLimit()},pageLimit(){this.list=this.allList.filter((e,t)=>t<this.page*this.limit&&t>=this.limit*(this.page-1))},searchData(){this.connectLoading=!0;const e={cat:"CatIndices",es_connect:I.sdk.GetSelectEsConnID(),is_ban_sys_index:this.is_ban_sys_index};this.indexTishiList=[],ke(e).then(t=>{if(t.code==0){const a=t.data;for(const n in a){const i=a[n];for(const O in i){let L=parseInt(i[O]);isNaN(L)&&(L=i[O]),a[n][O.split(".").join("->")]=L}this.indexTishiList.push({value:i.index,data:i.index})}let o=[];if(this.status.trim()!="")for(const n of a)n.health==this.status.trim()&&o.push(n);else o=a;o=$(o,this.input.trim()),this.allList=o,this.total=o.length,this.pageLimit()}else g({type:"error",message:t.msg});this.connectLoading=!1}).catch(t=>{console.log(t),this.connectLoading=!1})}}},ut=e=>(Ke("data-v-e51ffa68"),e=e(),We(),e),ct={class:"app-container"},pt={class:"search-container"},mt=ut(()=>j("span",null," 操作 ",-1)),gt={class:"search-container operate"},ft={class:"search-container operate"};function ht(e,t,a,o,n,i){const O=c("el-option"),L=c("el-select"),A=c("el-form-item"),h=c("el-col"),J=c("el-switch"),R=c("el-autocomplete"),v=c("el-button"),w=c("el-container"),_=c("el-tooltip"),f=c("el-row"),m=c("el-form"),u=c("el-collapse-item"),r=c("el-collapse"),p=c("el-table-column"),T=c("el-table"),F=c("el-pagination"),M=c("json-editor"),V=c("el-tab-pane"),Q=c("el-tag"),Y=c("index-select"),X=c("el-link"),E=c("alias"),D=c("el-tabs"),B=c("el-drawer"),P=c("settings"),b=c("mappings"),x=ue("loading");return y(),U("div",ct,[j("div",pt,[l(r,{modelValue:n.activeNames,"onUpdate:modelValue":t[13]||(t[13]=d=>n.activeNames=d)},{default:s(()=>[l(u,{name:"1"},{title:s(()=>[mt]),default:s(()=>[l(m,null,{default:s(()=>[l(f,{gutter:20},{default:s(()=>[l(h,{lg:3,md:12,sm:4,xl:3,xs:24},{default:s(()=>[l(A,{label:"状态"},{default:s(()=>[l(L,{id:"index-health-status",modelValue:n.status,"onUpdate:modelValue":t[0]||(t[0]=d=>n.status=d),class:"filter-item width150",filterable:"",onChange:i.search},{default:s(()=>[l(O,{label:e.$t("所有"),value:""},null,8,["label"]),l(O,{label:"green",value:"green"}),l(O,{label:"yellow",value:"yellow"}),l(O,{label:"red",value:"red"})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),l(h,{lg:5,md:12,sm:4,xl:3,xs:24},{default:s(()=>[l(A,{label:"屏蔽系统索引"},{default:s(()=>[l(J,{onChange:i.search,modelValue:n.is_ban_sys_index,"onUpdate:modelValue":t[1]||(t[1]=d=>n.is_ban_sys_index=d),"active-text":"是","inactive-text":"否"},null,8,["onChange","modelValue"])]),_:1})]),_:1}),l(h,{lg:4,md:6,sm:6,xl:3,xs:12},{default:s(()=>[l(A,{label:"筛选"},{default:s(()=>[l(w,null,{default:s(()=>[l(R,{class:"filter-item width300",id:"index-keyword",clearable:"","fetch-suggestions":i.querySearch,style:{width:"300px"},modelValue:n.input,"onUpdate:modelValue":t[2]||(t[2]=d=>n.input=d),placeholder:e.$t("请输入索引名")},{default:s(({item:d})=>[j("span",null,k(d.value),1)]),_:1},8,["fetch-suggestions","modelValue","placeholder"]),l(v,{style:{"margin-left":"3px"},id:"index-search",type:"success",icon:e.Search,onClick:i.search},null,8,["icon","onClick"])]),_:1})]),_:1})]),_:1}),l(h,{lg:10,md:6,sm:2,xl:6,xs:12},{default:s(()=>[l(A,{label:"索引操作"},{default:s(()=>[l(w,null,{default:s(()=>[l(_,{content:"关闭",placement:"top"},{default:s(()=>[G(l(v,{disabled:n.loadingGroup.close,id:"patchCloseIndex",type:"danger",icon:e.Hide,onClick:t[3]||(t[3]=d=>i.Close("close",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[x,n.loadingGroup.close]])]),_:1}),l(_,{content:"打开",placement:"top"},{default:s(()=>[G(l(v,{id:"patchOpenIndex",disabled:n.loadingGroup.open,type:"success",icon:e.View,onClick:t[4]||(t[4]=d=>i.Open("open",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[x,n.loadingGroup.open]])]),_:1}),l(_,{content:"新建",placement:"top"},{default:s(()=>[l(v,{icon:e.Plus,id:"new-index",onClick:t[5]||(t[5]=d=>i.openSettingDialog("","add"))},null,8,["icon"])]),_:1}),l(_,{content:"删除",placement:"top"},{default:s(()=>[G(l(v,{icon:e.Delete,id:"patchDeleteIndex",disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[6]||(t[6]=d=>i.deleteIndex(n.selectIndexList.join(","),"deleteIndex"))},null,8,["icon","disabled"]),[[x,n.loadingGroup.deleteIndex]])]),_:1}),l(_,{content:"将节点切换为可读写状态",placement:"top"},{default:s(()=>[G(l(v,{icon:e.Sort,disabled:n.readOnlyAllowDeleteLoading,id:"readOnlyAllowDelete",type:"warning",onClick:t[7]||(t[7]=d=>i.readOnlyAllowDelete())},null,8,["icon","disabled"]),[[x,n.readOnlyAllowDeleteLoading]])]),_:1}),l(_,{content:"将所选索引刷新到磁盘",placement:"top"},{default:s(()=>[G(l(v,{id:"patchFlushIndex",disabled:n.loadingGroup._flush,type:"warning",icon:e.BrushFilled,onClick:t[8]||(t[8]=d=>i.Flush("_flush",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[x,n.loadingGroup._flush]])]),_:1}),l(_,{content:"强制合并索引",placement:"top"},{default:s(()=>[G(l(v,{icon:e.Connection,id:"patchForcemergeIndex",disabled:n.loadingGroup._forcemerge,onClick:t[9]||(t[9]=d=>i.Forcemerge("_forcemerge",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[x,n.loadingGroup._forcemerge]])]),_:1}),l(_,{content:"刷新索引",placement:"top"},{default:s(()=>[G(l(v,{id:"patchRefreshIndex",disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[10]||(t[10]=d=>i.Refresh("_refresh",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[x,n.loadingGroup._refresh]])]),_:1}),l(_,{content:"清空索引",placement:"top"},{default:s(()=>[G(l(v,{id:"patchEmptyIndex",disabled:n.loadingGroup.empty,icon:e.DocumentDelete,type:"danger",onClick:t[11]||(t[11]=d=>i.Empty("empty",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[x,n.loadingGroup.empty]])]),_:1}),l(_,{content:"清理缓存",placement:"top"},{default:s(()=>[G(l(v,{icon:e.ToiletPaper,id:"patchCacheClear",disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[12]||(t[12]=d=>i.CacheClear("_cache/clear",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[x,n.loadingGroup["_cache/clear"]]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),G((y(),C(T,{width:"100%",data:n.list,onSelectionChange:i.selectChange},{default:s(()=>[l(p,{type:"selection",width:"55",fixed:""}),l(p,{align:"center",label:e.$t("健康"),width:"100"},{default:s(d=>[d.row.health=="green"?(y(),C(v,{key:0,type:"success",circle:""})):z("",!0),d.row.health=="yellow"?(y(),C(v,{key:1,type:"warning",circle:""})):z("",!0),d.row.health=="red"?(y(),C(v,{key:2,type:"danger",circle:""})):z("",!0)]),_:1},8,["label"]),l(p,{align:"center",label:e.$t("状态"),width:"100"},{default:s(d=>[G(l(v,{type:"success",onClick:H=>i.Close("close",d.row.index)},{default:s(()=>[S(k(e.$t("开启")),1)]),_:2},1032,["onClick"]),[[se,d.row.status=="open"]]),G(l(v,{type:"danger",onClick:H=>i.Open("open",d.row.index)},{default:s(()=>[S(k(e.$t("关闭")),1)]),_:2},1032,["onClick"]),[[se,d.row.status=="close"]])]),_:1},8,["label"]),l(p,{align:"center",width:"200",label:e.$t("索引名")},{default:s(d=>[S(k(d.row.index),1)]),_:1},8,["label"]),l(p,{align:"center",label:e.$t("主分片数"),width:"80",prop:"pri",sortable:""},{default:s(d=>[S(k(d.row.pri),1)]),_:1},8,["label"]),l(p,{align:"center",label:e.$t("副本分片数量"),width:"80",prop:"rep",sortable:""},{default:s(d=>[S(k(d.row.rep),1)]),_:1},8,["label"]),l(p,{align:"center",label:e.$t("文档总数"),width:"150",prop:"docs->count",sortable:""},{default:s(d=>[S(k(i.bigNumberTransform(d.row["docs.count"])),1)]),_:1},8,["label"]),l(p,{align:"center",label:e.$t("删除状态的文档"),width:"80",prop:"docs->deleted",sortable:""},{default:s(d=>[S(k(d.row["docs.deleted"]),1)]),_:1},8,["label"]),l(p,{align:"center",label:e.$t("主+副本分片大小"),width:"120",prop:"store->size",sortable:""},{default:s(d=>[S(k(d.row["store.size"]),1)]),_:1},8,["label"]),l(p,{align:"center",label:e.$t("主分片大小"),width:"150",prop:"pri->store->size",sortable:""},{default:s(d=>[S(k(d.row["pri.store.size"]),1)]),_:1},8,["label"]),l(p,{align:"center",width:"190",label:e.$t("操作"),fixed:"right"},{default:s(d=>[l(_,{content:"修改配置",placement:"top"},{default:s(()=>[l(v,{icon:e.Setting,type:"info",onClick:H=>i.openSettingDialog(d.row.index,"update")},null,8,["icon","onClick"])]),_:2},1024),l(_,{content:"修改映射",placement:"top"},{default:s(()=>[l(v,{icon:e.EditPen,onClick:H=>i.openMappingEditDialog(d.row.index,!1)},null,8,["icon","onClick"])]),_:2},1024),l(_,{content:"更多",placement:"top"},{default:s(()=>[l(v,{icon:e.More,type:"primary",onClick:H=>i.openDrawer(d.row.index)},null,8,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[x,n.connectLoading]]),n.pageshow?(y(),C(F,{key:0,class:"pagination-container","current-page":n.page,"page-sizes":[10,20,30,50,100,150,200,500,1e3],"page-size":n.limit,layout:"total, sizes, prev, pager, next",total:n.total,onSizeChange:i.handleSizeChange,onCurrentChange:i.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])):z("",!0),l(B,{ref:"drawer",title:n.indexName,"before-close":i.drawerHandleClose,modelValue:n.drawerShow,"onUpdate:modelValue":t[28]||(t[28]=d=>n.drawerShow=d),direction:"rtl","custom-class":"demo-drawer","close-on-press-escape":"","destroy-on-close":"",size:i.isMobile?"100%":"50%"},{default:s(()=>[l(D,{modelValue:n.activeName,"onUpdate:modelValue":t[27]||(t[27]=d=>n.activeName=d),onTabClick:i.changeTab},{default:s(()=>[l(V,{label:e.$t("设置"),name:"Settings"},{default:s(()=>[n.showSettings?(y(),C(M,{key:0,value:n.settingData,"onUpdate:value":t[14]||(t[14]=d=>n.settingData=d),styles:"width: 100%",read:!0,title:e.$t("设置")},null,8,["value","title"])):z("",!0)]),_:1},8,["label"]),l(V,{label:e.$t("映射"),name:"Mapping"},{default:s(()=>[j("div",gt,[l(Q,{type:"warning"},{default:s(()=>[S(k(e.$t("切换为其它索引的映射")),1)]),_:1}),l(Y,{clearable:!0,style:{width:"150px"},placeholder:e.$t("请选择索引名"),onChange:i.changeMapToAnotherIndex},null,8,["placeholder","onChange"]),l(Q,{type:"primary"},{default:s(()=>[S(k(e.$t("操作")),1)]),_:1}),G((y(),C(v,{disabled:n.loadingGroup.saveMappinng,type:"primary",onClick:i.saveMappinng},{default:s(()=>[S(k(e.$t("修改")),1)]),_:1},8,["disabled","onClick"])),[[x,n.loadingGroup.saveMappinng]]),l(X,{type:"danger"},{default:s(()=>[S(k(e.$t("【注意：只能新增映射字段不可修改映射字段类型】")),1)]),_:1})]),n.showMapping?(y(),C(M,{key:0,value:n.mappingData,"onUpdate:value":t[15]||(t[15]=d=>n.mappingData=d),styles:"width: 100%",read:!1,title:e.$t("映射"),onGetValue:i.getMapping},null,8,["value","title","onGetValue"])):z("",!0)]),_:1},8,["label"]),l(V,{label:"Stats",name:"Stats"},{default:s(()=>[n.showStats?(y(),C(M,{key:0,value:n.statsData,"onUpdate:value":t[16]||(t[16]=d=>n.statsData=d),styles:"width: 100%;",read:!0,title:"Stats"},null,8,["value"])):z("",!0)]),_:1}),l(V,{label:e.$t("编辑索引配置"),name:"editSettings"},{default:s(()=>[l(m,null,{default:s(()=>[l(A,{label:e.$t("编辑索引配置")},{default:s(()=>[l(v,{type:"primary",onClick:t[17]||(t[17]=d=>i.submitSettings())},{default:s(()=>[S(k(e.$t("提交")),1)]),_:1}),l(v,{onClick:i.resetSettings},{default:s(()=>[S(k(e.$t("重置")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),l(A,null,{default:s(()=>[n.showEditSettings?(y(),C(M,{key:0,value:n.editSettingsData,"onUpdate:value":t[18]||(t[18]=d=>n.editSettingsData=d),"point-out":n.pointOut,styles:"width: 100%;",read:!1,title:e.$t("编辑配置"),onGetValue:i.getSettings},null,8,["value","point-out","title","onGetValue"])):z("",!0)]),_:1})]),_:1})]),_:1},8,["label"]),l(V,{label:e.$t("修改别名"),name:"alias"},{default:s(()=>[n.activeName=="alias"?(y(),C(E,{key:0,"index-name":n.indexName},null,8,["index-name"])):z("",!0)]),_:1},8,["label"]),j("div",ft,[l(m,null,{default:s(()=>[l(A,{label:"操作"},{default:s(()=>[l(_,{content:"关闭",placement:"top"},{default:s(()=>[G(l(v,{icon:e.Hide,disabled:n.loadingGroup.close,type:"danger",onClick:t[19]||(t[19]=d=>i.Close("close",n.indexName))},null,8,["icon","disabled"]),[[x,n.loadingGroup.close]])]),_:1}),l(_,{content:"打开",placement:"top"},{default:s(()=>[G(l(v,{icon:e.View,disabled:n.loadingGroup.open,type:"success",onClick:t[20]||(t[20]=d=>i.Open("open",n.indexName))},null,8,["icon","disabled"]),[[x,n.loadingGroup.open]])]),_:1}),l(_,{content:"强制合并索引【forcemerge操作,手动释放磁盘空间】",placement:"top"},{default:s(()=>[G(l(v,{disabled:n.loadingGroup._forcemerge,icon:e.Connection,onClick:t[21]||(t[21]=d=>i.Forcemerge("_forcemerge",n.indexName))},null,8,["disabled","icon"]),[[x,n.loadingGroup._forcemerge]])]),_:1}),l(_,{content:"刷新索引【为了让最新的数据可以立即被搜索到】",placement:"top"},{default:s(()=>[G(l(v,{disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[22]||(t[22]=d=>i.Refresh("_refresh",n.indexName))},null,8,["disabled","icon"]),[[x,n.loadingGroup._refresh]])]),_:1}),l(_,{content:"将索引刷新到磁盘【让数据持久化到磁盘中】",placement:"top"},{default:s(()=>[G(l(v,{icon:e.BrushFilled,disabled:n.loadingGroup._flush,type:"info",onClick:t[23]||(t[23]=d=>i.Flush("_flush",n.indexName))},null,8,["icon","disabled"]),[[x,n.loadingGroup._flush]])]),_:1}),l(_,{content:"清理缓存",placement:"top"},{default:s(()=>[G(l(v,{icon:e.ToiletPaper,disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[24]||(t[24]=d=>i.CacheClear("_cache/clear",n.indexName))},null,8,["icon","disabled"]),[[x,n.loadingGroup["_cache/clear"]]])]),_:1}),l(_,{content:"删除索引",placement:"top"},{default:s(()=>[G(l(v,{icon:e.Delete,disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[25]||(t[25]=d=>i.deleteIndex(n.indexName,"deleteIndex"))},null,8,["icon","disabled"]),[[x,n.loadingGroup.deleteIndex]])]),_:1}),l(_,{content:"清空索引",placement:"top"},{default:s(()=>[G(l(v,{disabled:n.loadingGroup.empty,type:"danger",icon:e.DocumentDelete,onClick:t[26]||(t[26]=d=>i.Empty("empty",n.indexName))},null,8,["disabled","icon"]),[[x,n.loadingGroup.empty]])]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue","onTabClick"])]),_:1},8,["title","before-close","modelValue","size"]),n.openSettings?(y(),C(P,{key:1,"index-name":n.indexName,"settings-type":n.settingsType,onFinished:i.search,open:n.openSettings,onClose:i.closeSettings},null,8,["index-name","settings-type","onFinished","open","onClose"])):z("",!0),n.openMappings?(y(),C(b,{key:2,"index-name":n.indexName,title:n.mappingTitle,open:n.openMappings,onClose:i.closeMappings},null,8,["index-name","title","open","onClose"])):z("",!0)])}const St=oe(dt,[["render",ht],["__scopeId","data-v-e51ffa68"]]);export{St as default};
