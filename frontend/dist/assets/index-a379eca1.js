import{c as pe}from"./index-0aae8c1b.js";import{f as Z,R as xe,C as ke}from"./es-54331f3f.js";import{C as me,G as ge,S as fe,a as Ce,B as Se,A as De,R as Ge,M as Ne,F as Ie,E as Oe,b as Ve,c as Ae,O as ze,d as je,e as Te,f as Le,D as Ee}from"./es-index-3002c717.js";import{U as he,L as le,e as Je}from"./es-map-49b8d644.js";import{g as re,b as w,e as ye,f as de,r as p,o as y,c as F,a as l,w as s,h as A,i as C,t as x,E as g,s as D,j as Me,n as W,k,u as ee,l as Fe,m as Ue,p as te,F as ne,q as ae,v as Pe,x as O,y as Be,z as ue,A as N,B as Re,C as se,I as He,D as Ke,G as We}from"./index-1032a0df.js";import{J as _e}from"./index-9315dde0.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import{I as ve}from"./select-9b363c82.js";function qe(e){const t=["","",""];let a=1e3,o=3;for(;e/a>=1;)a*=10,o+=1;if(o<=4)t[1]="千",t[0]=parseInt(e/1e3)+"";else if(o<=8){const n=parseInt(o-4)/3>1?"千万":"万",r=n==="万"?1e4:1e7;t[1]=n,t[0]=e/r+""}else if(o<=16){let n=(o-8)/3>1?"千亿":"亿";n=(o-8)/4>1?"万亿":n,n=(o-8)/7>1?"千万亿":n;let r=1;n==="亿"?r=1e8:n==="千亿"?r=1e11:n==="万亿"?r=1e12:n==="千万亿"&&(r=1e15),t[1]=n,t[0]=parseInt(e/r)+""}return e<1e3&&(t[1]="",t[0]=e+""),t.join("")}const Qe={style:{"text-align":"right"}},Xe={__name:"settings",props:{indexName:{type:String,default:""},settingsType:{type:String,default:"add"},open:{type:Boolean,default:!1}},emits:["finished","close"],setup(e,{emit:t}){re().appContext.config.globalProperties;const a=e,o=w(a.indexName),n=w(a.settingsType),r=w(a.open),G=t,L=w(["number_of_shards","index.translog.sync_interval","index.shard.check_on_startup","index.routing_partition_size","index.codec"]),z=w(!1),h=w({"index.shard.check_on_startup":"","index.routing_partition_size":"","index.codec":"","index.auto_expand_replicas":"","index.max_result_window":"","index.max_rescore_window":"","index.blocks.read_only":"","index.blocks.read":"","index.blocks.write":"","index.blocks.metadata":"","index.blocks.read_only_allow_delete":"","index.max_refresh_listeners":"",number_of_shards:"",number_of_replicas:"",refresh_interval:"","index.translog.sync_interval":"","index.translog.durability":"","index.translog.flush_threshold_size":"","index.merge.scheduler.max_thread_count":"","index.merge.policy.max_merged_segment":"","index.merge.policy.segments_per_tier":""}),M=ye(()=>n.value==="add"?"新增索引配置":"修改索引配置"),v=()=>{if(h.value["index.routing_partition_size"]>=h.value["index.number_of_shards"]){g({type:"error",message:"自定义路由值可以转发的目的分片数 必须小于 主分片数"});return}if(o.value===""){g({type:"error",message:"索引名不能为空"});return}const f={};if(f.es_connect=D.GetSelectEsConnID(),f.settings=pe(h.value),f.index_name=o.value,f.types=n.value,n.value==="update")for(const c of L.value)delete f.settings[c];for(const c in f.settings)f.settings[c]===""&&delete f.settings[c];const u=Me.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});me(f).then(c=>{c.code===0||c.code===200?(g({type:"success",message:c.msg}),a.settingsType="update",G("finished")):g({type:"error",message:c.msg}),u.close()}).catch(c=>{u.close()})},U=()=>{const f={};f.es_connect=D.GetSelectEsConnID(),f.index_name=o.value,ge(f).then(u=>{if(u.code===0||u.code===200){const c=u.data.index;if(h.value.number_of_replicas=c.number_of_replicas,h.value.number_of_shards=c.number_of_shards,c.hasOwnProperty("auto_expand_replicas")&&(h.value["index.auto_expand_replicas"]=c.auto_expand_replicas),c.hasOwnProperty("blocks")){const i=c.blocks;i.hasOwnProperty("metadata")&&(h.value["index.blocks.metadata"]=i.metadata),i.hasOwnProperty("read")&&(h.value["index.blocks.read"]=i.read),i.hasOwnProperty("read_only")&&(h.value["index.blocks.read_only"]=i.read_only),i.hasOwnProperty("read_only_allow_delete")&&(h.value["index.blocks.read_only_allow_delete"]=i.read_only_allow_delete),i.hasOwnProperty("write")&&(h.value["index.blocks.write"]=i.write)}if(c.hasOwnProperty("merge")){const i=c.merge;if(i.hasOwnProperty("policy")){const _=i.policy;_.hasOwnProperty("max_merged_segment")&&(h.value["index.merge.policy.max_merged_segment"]=_.max_merged_segment),_.hasOwnProperty("max_merged_segment")&&(h.value["index.merge.policy.segments_per_tier"]=_.segments_per_tier)}if(i.hasOwnProperty("scheduler")){const _=i.scheduler;_.hasOwnProperty("max_thread_count")&&(h.value["index.merge.scheduler.max_thread_count"]=_.max_thread_count)}}if(c.hasOwnProperty("max_refresh_listeners")&&(h.value["index.max_refresh_listeners"]=c.max_refresh_listeners),c.hasOwnProperty("max_rescore_window")&&(h.value["index.max_rescore_window"]=c.max_rescore_window),c.hasOwnProperty("max_result_window")&&(h.value["index.max_result_window"]=c.max_result_window),c.hasOwnProperty("refresh_interval")&&(h.value.refresh_interval=c.refresh_interval),c.hasOwnProperty("translog")){const i=c.translog;i.hasOwnProperty("durability")&&(h.value["index.translog.durability"]=i.durability),i.hasOwnProperty("flush_threshold_size")&&(h.value["index.translog.flush_threshold_size"]=i.flush_threshold_size)}console.log(h.value,"form")}else g({type:"error",message:u.msg})}).catch(u=>{console.log(u)})},b=()=>{const f={};f.es_connect=D.GetSelectEsConnID(),f.index_name=o.value,fe(f).then(u=>{u.code==0||u.code==200?z.value=u.data[0].status=="open":g({type:"error",message:u.msg})}).catch(u=>{console.error(u)})},I=()=>{G("close")};return de(()=>{o.value!=""&&(b(),U())}),(f,u)=>{const c=p("el-input"),i=p("el-form-item"),_=p("el-form"),V=p("el-button"),j=p("el-card"),E=p("el-dialog");return y(),F("div",null,[l(E,{width:"90%","close-on-click-modal":!1,modelValue:r.value,"onUpdate:modelValue":u[5]||(u[5]=T=>r.value=T),title:M.value,onClose:I},{default:s(()=>[l(j,{class:"box-card"},{default:s(()=>[l(_,{"label-width":"500px","label-position":"left"},{default:s(()=>[l(i,{label:f.$t("索引名称：")},{default:s(()=>[l(c,{modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=T=>o.value=T),placeholder:f.$t("索引名称"),disabled:n.value!=="add"},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),l(i,{label:"number_of_shards (分片数)："},{default:s(()=>[l(c,{modelValue:h.value.number_of_shards,"onUpdate:modelValue":u[1]||(u[1]=T=>h.value.number_of_shards=T),type:"number",style:{width:"300px"},disabled:z.value},null,8,["modelValue","disabled"])]),_:1}),l(i,{label:"number_of_replicas (副本数)："},{default:s(()=>[l(c,{modelValue:h.value.number_of_replicas,"onUpdate:modelValue":u[2]||(u[2]=T=>h.value.number_of_replicas=T),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(i,{label:"refresh_interval (索引的刷新时间间隔)："},{default:s(()=>[l(c,{modelValue:h.value.refresh_interval,"onUpdate:modelValue":u[3]||(u[3]=T=>h.value.refresh_interval=T),placeholder:f.$t("索引的刷新时间间隔")},null,8,["modelValue","placeholder"])]),_:1}),l(i,{label:"max_result_window  (from+size 的最大值)："},{default:s(()=>[l(c,{modelValue:h.value["index.max_result_window"],"onUpdate:modelValue":u[4]||(u[4]=T=>h.value["index.max_result_window"]=T),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1}),A("div",Qe,[l(V,{type:"danger",onClick:I},{default:s(()=>[C(x(f.$t("取消")),1)]),_:1}),l(V,{type:"primary",onClick:v},{default:s(()=>[C(x(f.$t("确认")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue","title"])])}}};const Ye={key:0,class:"item"},Ze={key:1,style:{"margin-left":"14px"}},$e={class:"item-type item-cell"},et={class:"item-value item-cell"},K=8,tt={__name:"Item",props:{item:{type:Object,default:{key:"",value:"",type:""}},names:{type:Array},parent:{type:Object},index:{type:Number,default:0},deep:{type:Number,default:0},size:{type:String,default:"small"},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0}},setup(e){const t=e,a=w(!t.openFlag),o=w(t.deep+1),n=w([{value:"String",label:"String"},{value:"Object",label:"Object"},{value:"Array",label:"Array"},{value:"Number",label:"Number"},{value:"Boolean",label:"Boolean"}]),r=w([{value:"Object",label:"Object"},{value:"Array",label:"Array"}]),G=w([{value:"type",data:" 数据类型"},{value:"format",data:" 时间格式化"},{value:"analyzer",data:" 分词器"},{value:"normalizer",data:" 分析器"},{value:"boost",data:" 权重"},{value:"coerce",data:" 强制类型转换"},{value:"copy_to",data:" 合并参数"},{value:"doc_values",data:" 文档值"},{value:"dynamic",data:" 动态设置"},{value:"enabled",data:" 是否开启字段"},{value:"fielddata",data:" 字段数据"},{value:"ignore_above",data:" 字段保存最大长度"},{value:"ignore_malformed",data:" 忽略格式不对的数据"},{value:"include_in_all",data:" _all 查询包含字段"},{value:"index_options",data:" 索引设置"},{value:"index",data:" 是否可以被搜索"},{value:"fields",data:" 字段"},{value:"norms",data:" 标准信息"},{value:"null_value",data:" 空值"},{value:"position_increment_gap",data:" 短语位置间隙"},{value:"properties",data:" 属性"},{value:"search_analyzer",data:" 搜索分析器"},{value:"similarity",data:" 匹配算法"},{value:"store",data:" 字段是否被存储"},{value:"term_vector",data:" 词根信息"}]),L=w([{value:"text",data:"字符串类型(可分词) "},{value:"keyword",data:"字符串类型(不可分词) "},{value:"long",data:"数字类型 "},{value:"integer",data:"数字类型 "},{value:"short",data:"数字类型 "},{value:"byte",data:"数字类型 "},{value:"double",data:"数字类型 "},{value:"float",data:"数字类型 "},{value:"half_float",data:"数字类型 "},{value:"scaled_float",data:"数字类型 "},{value:"date",data:"时间类型 "},{value:"boolean",data:"布尔类型 "},{value:"binary",data:"二进制类型 "},{value:"Array",data:"数组类型 "},{value:"object",data:"对象类型  "},{value:"nested",data:"嵌套类型 "},{value:"geo_point",data:"地理类型 "},{value:"geo_shape",data:"多边形类型 "},{value:"ip",data:"ip类型 "},{value:"completion",data:"补全类型 "},{value:"token_count",data:"令牌计数类型 "},{value:"yyyy-MM-dd HH:mm:ss",data:"时间格式化 "}]);w(["el-icon-arrow-right","el-icon-arrow-down"]);const z=w(["el-tag-blue","el-tag-orange"]),h=w(["item-cell item-control-cell","item-cell"]),M=w(["el-input el-input--small"]);function v(c,i){let _=JSON.parse(JSON.stringify(G.value));if(c==null&&(c=""),c.trim()==""){_.length>K?i(_.slice(0,K)):i(_);return}_=Z(_,c.trim()),_.length>K?i(_.slice(0,K)):i(_)}function U(c,i){let _=JSON.parse(JSON.stringify(L.value));if(c==null&&(c=""),c.trim()==""){_.length>K?i(_.slice(0,K)):i(_);return}_=Z(_,c.trim()),_.length>K?i(_.slice(0,K)):i(_)}function b(c){const i=G.value.find(_=>_.value===c);return i?i.data:""}function I(){["Object","Array"].includes(t.item.type)&&(a.value=!1)}function f(){t.item.childs||(t.item.childs=[]),t.item.childs.push({key:"",value:"",type:""})}function u(){const c=t.parent.childs.indexOf(t.item);c>-1&&t.parent.childs.splice(c,1)}return(c,i)=>{const _=p("el-icon"),V=p("el-link"),j=p("el-tag"),E=p("el-autocomplete"),T=p("el-option"),Q=p("el-select"),X=p("el-input-number"),q=p("el-radio"),J=p("el-radio-group"),S=p("el-tooltip"),P=p("el-popconfirm"),B=p("el-row");return y(),F("div",null,[l(B,{style:te("padding-left: "+(o.value-1)*15+"px; margin-top: 5px")},{default:s(()=>[e.rootFlag?(y(),F("div",Ye,[A("div",{class:W(h.value),onClick:i[0]||(i[0]=m=>a.value=!a.value)},[e.item.childs!=null?(y(),k(V,{key:0,underline:!1},{default:s(()=>[a.value?(y(),k(_,{key:0},{default:s(()=>[l(ee(Fe))]),_:1})):(y(),k(_,{key:1},{default:s(()=>[l(ee(Ue))]),_:1}))]),_:1})):(y(),F("i",Ze))],2),A("div",{class:"item-cell",onClick:i[1]||(i[1]=m=>a.value=!a.value)},[l(V,{underline:!1},{default:s(()=>[l(j,{effect:"plain",class:W(z.value)},{default:s(()=>[A("span",null,x(b(e.item.key)?b(e.item.key):e.item.key),1)]),_:1},8,["class"])]),_:1})]),A("div",{class:"item-key item-cell",style:te("width: "+(300-(o.value-1)*15)+"px")},[l(E,{modelValue:e.item.key,"onUpdate:modelValue":i[2]||(i[2]=m=>e.item.key=m),clearable:"","fetch-suggestions":v,placeholder:e.parent.type=="Array"?"":"请输入键",size:e.size,disabled:e.item.isRoot||e.parent.type=="Array",style:te("width: "+(290-(o.value-1)*15)+"px")},{default:s(({item:m})=>[A("span",null,x(m.value)+"-"+x(m.data),1)]),_:1},8,["modelValue","placeholder","size","disabled","style"])],4),A("div",$e,[l(Q,{modelValue:e.item.type,"onUpdate:modelValue":i[3]||(i[3]=m=>e.item.type=m),size:e.size,placeholder:"请选择",class:"select-body",onChange:I},{default:s(()=>[(y(!0),F(ne,null,ae(e.item.isRoot?r.value:n.value,m=>(y(),k(T,{key:m.value,label:m.label,value:m.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","size"])]),A("div",et,[e.item.type!="Number"&&e.item.type!="Boolean"?(y(),k(E,{key:0,modelValue:e.item.value,"onUpdate:modelValue":i[4]||(i[4]=m=>e.item.value=m),"fetch-suggestions":U,clearable:"",size:e.size,placeholder:e.item.type=="Array"||e.item.type=="Object"?"":"请输入值",disabled:e.item.type=="Array"||e.item.type=="Object",class:W(M.value)},{default:s(({item:m})=>[A("span",null,x(m.value)+"-"+x(m.data),1)]),_:1},8,["modelValue","size","placeholder","disabled","class"])):e.item.type=="Number"?(y(),k(X,{key:1,modelValue:e.item.value,"onUpdate:modelValue":i[5]||(i[5]=m=>e.item.value=m),size:e.size,class:W(M.value)},null,8,["modelValue","size","class"])):(y(),k(J,{key:2,modelValue:e.item.value,"onUpdate:modelValue":i[6]||(i[6]=m=>e.item.value=m),class:W(M.value)},{default:s(()=>[l(q,{class:"el-radio",label:!0},{default:s(()=>[C("是")]),_:1}),l(q,{class:"el-radio",label:!1},{default:s(()=>[C("否")]),_:1})]),_:1},8,["modelValue","class"]))]),A("div",{class:W(h.value)},[e.item.type=="Array"||e.item.type=="Object"?(y(),k(S,{key:0,class:"item-control-cell",content:"添加子元素",placement:"top"},{default:s(()=>[l(V,{underline:!1,onClick:f},{default:s(()=>[l(_,null,{default:s(()=>[l(ee(Pe))]),_:1})]),_:1})]),_:1})):O("",!0),e.item.isRoot?O("",!0):(y(),k(P,{key:1,title:"确定删除当前节点吗？",onConfirm:u},{default:s(()=>[l(V,{slot:"reference",underline:!1,class:"item-control-cell"},{default:s(()=>[l(_,null,{default:s(()=>[l(ee(Be))]),_:1})]),_:1})]),_:1}))],2)])):O("",!0)]),_:1},8,["style"]),A("div",{style:te(a.value?"display: none":"display: block")},[e.item.childs&&e.item.type=="Object"?(y(!0),F(ne,{key:0},ae(e.item.childs,(m,d)=>(y(),F("span",{key:d},[l(ie,{size:e.size,item:m,parent:e.item,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","names","deep","open-flag"])]))),128)):O("",!0),e.item.childs&&e.item.type=="Array"?(y(!0),F(ne,{key:1},ae(e.item.childs,(m,d)=>(y(),F("span",{key:d},[l(ie,{size:e.size,item:m,parent:e.item,index:d,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","index","names","deep","open-flag"])]))),128)):O("",!0)],4)])}}},ie=oe(tt,[["__scopeId","data-v-13f66a1c"]]);const lt={name:"VueJsonHelper",components:{Item:ie},props:{names:{type:Array},size:{type:String,default:"small"},jsonStr:{type:String},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0},borderFlag:{type:Boolean,default:!0},shadowFlag:{type:Boolean,default:!1},backTopFlag:{type:Boolean,default:!1}},data(){return{deep:0,isJson:!1,jsonData:void 0,errorResult:void 0,item:{key:"Root",value:null,type:null,isRoot:!0,childs:[]}}},watch:{item:{handler(e,t){if(e==t){var a=this.handleJsonData(e);a!=null&&this.$emit("jsonListener",a)}},immediate:!0,deep:!0}},created(){this.isJson=this.judgeJson(),this.item.childs=this.handleJson(this.jsonData),this.item.type=this.handleType()},methods:{judgeJson(){var e=!1;try{this.jsonData=JSON.parse(this.jsonStr),e=!0}catch(t){this.errorResult=t,e=!1}return e},handleJsonData(e){var t={},a=[],o=e.type,n=e.childs;for(var r in n)n[r].type!="Object"&&n[r].type!="Array"?o=="Object"?t[n[r].key]=n[r].value:o=="Array"&&a.push(n[r].value):o=="Object"?t[n[r].key]=this.handleJsonData(n[r]):o=="Array"&&a.push(this.handleJsonData(n[r]));if(o=="Object")return t;if(o=="Array")return a},handleJson(e){var t=[];for(var a in e){var o=this.judgeType(e[a]);if(o=="Object"||o=="Array"){var n={key:a,value:null,type:o,childs:this.handleJson(e[a])};t.push(n)}else{var n={key:a,value:e[a],type:o};t.push(n)}}return t},judgeType(e){var t=Object.prototype.toString.call(e);return t==="[object String]"?t="String":t==="[object Number]"?t="Number":t==="[object Boolean]"?t="Boolean":t==="[object Array]"?t="Array":t==="[object Object]"?t="Object":t=null,t},handleType(){return this.judgeType(this.jsonData)}}};function nt(e,t,a,o,n,r){const G=p("Item"),L=p("el-col"),z=p("el-backtop"),h=p("el-row");return y(),k(h,{class:W(a.borderFlag?"el-row-border":"")},{default:s(()=>[n.isJson?(y(),k(L,{key:0,class:"item-body"},{default:s(()=>[l(G,{item:n.item,deep:n.deep,parent:n.item,names:a.names,size:a.size,index:0,"root-flag":a.rootFlag,"open-flag":a.openFlag},null,8,["item","deep","parent","names","size","root-flag","open-flag"])]),_:1})):(y(),k(L,{key:1},{default:s(()=>[A("i",null,x(n.errorResult),1)]),_:1})),a.backTopFlag?(y(),k(z,{key:2})):O("",!0)]),_:1},8,["class"])}const at=oe(lt,[["render",nt],["__scopeId","data-v-29aa0e56"]]);const st={class:"app-container"},ot={class:"search-container"},it={__name:"mapping",props:{indexName:{type:String,default:""},open:{type:Boolean,default:!1},title:{type:String,default:"新增映射结构"}},emits:["close","finished"],setup(e,{emit:t}){const a=e,o=w(a.open),n=w(a.title),r=w(a.indexName),G=w("1");re().appContext.config.globalProperties;const L=ye(()=>JSON.stringify(JSON.parse(u.value),null,"	")),z=t,h=w(!1),M=w("false"),v=w("small"),U=w([{key:"Root",name:"properties"},{key:"type",name:"数据类型"},{key:"format",name:"时间格式化"},{key:"analyzer",name:"分词器"},{key:"normalizer",name:"分析器"},{key:"boost",name:"权重"},{key:"coerce",name:"强制类型转换"},{key:"copy_to",name:"合并参数"},{key:"doc_values",name:"文档值"},{key:"dynamic",name:"动态设置"},{key:"enabled",name:"是否开启字段"},{key:"fielddata",name:"字段数据"},{key:"ignore_above",name:"字段保存最大长度"},{key:"ignore_malformed",name:"忽略格式不对的数据"},{key:"include_in_all",name:"_all 查询包含字段"},{key:"index_options",name:"索引设置"},{key:"index",name:"是否可以被搜索"},{key:"fields",name:"字段"},{key:"norms",name:"标准信息"},{key:"null_value",name:"空值"},{key:"position_increment_gap",name:"短语位置间隙"},{key:"properties",name:"属性"},{key:"search_analyzer",name:"搜索分析器"},{key:"similarity",name:"匹配算法"},{key:"store",name:"字段是否被存储"},{key:"term_vector",name:"词根信息"}]),b=w(!0),I=w(!0),f=w(!1),u=w("{}"),c=w(!1),i=w(""),_=w(6),V=w(!1),j=w(!1),E=async()=>{let J={};try{J=JSON.parse(u.value)}catch{g({type:"error",message:"JSON格式不正确"});return}const S={es_connect:D.GetSelectEsConnID(),index_name:a.indexName},P={properties:J,dynamic:M.value};switch(_.value){case 6:S.properties=P,S.type_name=i.value;break;case 7:case 8:S.properties=P;break}h.value=!0;const{data:B,code:m,msg:d}=await he(S);h.value=!1,m===0?(g({type:"success",message:d}),z("finished")):g({type:"error",message:d})},T=()=>{c.value=!1,Re(()=>{c.value=!0})},Q=async()=>{var m,d,R,$;const J={es_connect:D.GetSelectEsConnID(),index_name:a.indexName},{data:S,code:P,msg:B}=await le(J);if(P!==0){g({type:"error",message:B});return}switch(_.value=S.ver,_.value){case 6:const Y=Object.keys(S.list[a.indexName].mappings);V.value=!0,Y.length===0?j.value=!1:(i.value=Y[0],j.value=!0,M.value=((m=S.list[a.indexName].mappings[i.value])==null?void 0:m.dynamic)??"false",u.value=JSON.stringify(((d=S.list[a.indexName].mappings[i.value])==null?void 0:d.properties)??"{}"));break;case 7:case 8:M.value=((R=S.list[a.indexName].mappings)==null?void 0:R.dynamic)??"false",u.value=JSON.stringify((($=S.list[a.indexName].mappings)==null?void 0:$.properties)??"{}");break}T()},X=J=>{u.value=JSON.stringify(J)},q=()=>{z("close")};return de(()=>{Q()}),(J,S)=>{const P=p("el-input"),B=p("el-form-item"),m=p("el-option"),d=p("el-select"),R=p("el-button"),$=p("el-form"),Y=p("el-tabs"),ce=p("el-tab-pane"),be=p("el-dialog"),we=ue("loading");return y(),F("div",null,[l(be,{"close-on-click-modal":!1,modelValue:o.value,"onUpdate:modelValue":S[4]||(S[4]=H=>o.value=H),title:n.value.concat(`【${r.value}】`),width:"60%",onClose:q},{default:s(()=>[A("div",st,[A("div",ot,[l($,{inline:!0},{default:s(()=>[V.value?(y(),k(B,{key:0,label:"type"},{default:s(()=>[V.value?(y(),k(P,{key:0,modelValue:i.value,"onUpdate:modelValue":S[0]||(S[0]=H=>i.value=H),readonly:j.value,style:{width:"200px"}},null,8,["modelValue","readonly"])):O("",!0)]),_:1})):O("",!0),l(B,{label:"dynamic"},{default:s(()=>[l(d,{style:{width:"100px"},modelValue:M.value,"onUpdate:modelValue":S[1]||(S[1]=H=>M.value=H)},{default:s(()=>[l(m,{label:J.$t("动态映射"),value:"true"},null,8,["label"]),l(m,{label:J.$t("静态映射"),value:"false"},null,8,["label"]),l(m,{label:J.$t("严格映射"),value:"strict"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(B,null,{default:s(()=>[N((y(),k(R,{disabled:h.value,type:"success",onClick:E},{default:s(()=>[C(x(J.$t("保存/修改映射")),1)]),_:1},8,["disabled"])),[[we,h.value]])]),_:1})]),_:1})]),l(Y),l(Y,{modelValue:G.value,"onUpdate:modelValue":S[3]||(S[3]=H=>G.value=H),stretch:""},{default:s(()=>[l(ce,{name:"1",lazy:!0,label:J.$t("表单")},{default:s(()=>[c.value?(y(),k(at,{key:0,size:v.value,names:U.value,"json-str":u.value,"root-flag":b.value,"open-flag":I.value,"back-top-flag":f.value,"shadow-flag":!1,"border-flag":!1,onJsonListener:X},null,8,["size","names","json-str","root-flag","open-flag","back-top-flag"])):O("",!0)]),_:1},8,["label"]),l(ce,{name:"2",lazy:!0,label:J.$t("JSON")},{default:s(()=>[l(_e,{value:L.value,"onUpdate:value":S[2]||(S[2]=H=>L.value=H),height:"720",styles:"width: 100%",title:i.value},null,8,["value","title"])]),_:1},8,["label"])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","title"])])}}},rt=oe(it,[["__scopeId","data-v-cbb87fd6"]]),dt={__name:"alias",props:{indexName:{type:String,default:""}},setup(e){re().appContext.config.globalProperties;const t=e,a=w([]),o=w([]),n=()=>{a.value.push({name:"",types:"new"})},r=async()=>{a.value=[];const b={es_connect:D.GetSelectEsConnID(),index_name:t.indexName},{data:I,code:f,msg:u}=await Ce(b);if(console.log(I,f,u),f===0)for(const c in I)a.value.push({name:I[c].AliasName,types:"old"});else g({message:u,type:"error"})},G=async b=>{const I=a.value[b].name,f={types:1,index_name:t.indexName,alias_name:I.trim(),es_connect:D.GetSelectEsConnID()},{data:u,code:c,msg:i}=await De(f);c===0?g({type:"success",message:i}):g({type:"error",message:i})},L=async()=>{const b=a.value.filter(i=>i.types==="new").map(i=>i.name),I={types:4,index_name:t.indexName,new_alias_name_list:b,es_connect:D.GetSelectEsConnID()},{data:f,code:u,msg:c}=await Se(I);u===0?g({type:"success",message:c}):g({type:"error",message:c})},z=async b=>{const I=a.value[b];if(I.types==="new")a.value.splice(b,1);else if(I.types==="old"){const f={types:2,index_name:t.indexName,alias_name:I.name.trim(),es_connect:D.GetSelectEsConnID()},{data:u,code:c,msg:i}=await Ge(f);c===0?(g({type:"success",message:i}),a.value.splice(b,1)):g({type:"error",message:i})}},h=b=>{o.value=b},M=async b=>{const I=a.value[b].name,f={types:3,new_index_list:o.value,alias_name:I.trim(),es_connect:D.GetSelectEsConnID()},{data:u,code:c,msg:i}=await Ne(f);c===0?g({type:"success",message:i}):g({type:"error",message:i})},v=b=>{g({message:"复制成功！",type:"success"})},U=b=>{g({message:"复制失败！",type:"error"})};return de(()=>{r()}),(b,I)=>{const f=p("el-button"),u=p("el-form-item"),c=p("el-input"),i=p("el-form"),_=ue("clipboard");return y(),F("div",null,[l(i,null,{default:s(()=>[l(u,null,{default:s(()=>[l(f,{type:"success",onClick:n},{default:s(()=>[C(x(b.$t("新增别名")),1)]),_:1}),l(f,{type:"primary",onClick:L},{default:s(()=>[C(x(b.$t("批量提交")),1)]),_:1}),l(f,{type:"info",onClick:r},{default:s(()=>[C(x(b.$t("重置")),1)]),_:1}),l(ve,{style:{width:"210px","margin-left":"5px"},multiple:!0,clearable:!0,placeholder:b.$t("迁移别名到多个索引上"),onChange:h},null,8,["placeholder"])]),_:1}),(y(!0),F(ne,null,ae(a.value,(V,j)=>(y(),k(u,{key:j,label:b.$t("别名")+Number(j+1)},{default:s(()=>[l(c,{modelValue:V.name,"onUpdate:modelValue":E=>V.name=E,readonly:V.types!="new",style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue","readonly"]),N(l(f,{type:"success",onClick:E=>M(j)},{default:s(()=>[C(" 迁移 ")]),_:2},1032,["onClick"]),[[se,o.value.length>0]]),N((y(),k(f,{type:"success"},{default:s(()=>[C(x(b.$t("复制")),1)]),_:2},1024)),[[_,V.name,"copy"],[_,v,"success"],[_,U,"error"]]),N(l(f,{type:"primary",onClick:E=>G(j)},{default:s(()=>[C(x(b.$t("提交")),1)]),_:2},1032,["onClick"]),[[se,V.types=="new"]]),l(f,{type:"danger",onClick:E=>z(j)},{default:s(()=>[C(x(b.$t("删除")),1)]),_:2},1032,["onClick"])]),_:2},1032,["label"]))),128))]),_:1})])}}};const ut={name:"indices",setup(){return He},components:{Settings:Xe,Mappings:rt,JsonEditor:_e,Alias:dt,IndexSelect:ve},data(){return{activeNames:"1",indexTishiList:[],modName:"索引管理",aliasList:[],pointOut:Je,settings:{},readOnlyAllowDeleteLoading:!1,loadingGroup:{empty:!1,close:!1,open:!1,_forcemerge:!1,_refresh:!1,_flush:!1,"_cache/clear":!1,deleteIndex:!1,"_all/_flush":!1,saveMappinng:!1},forceMergeLoading:!1,tabLoading:!1,settingData:"{}",mappingData:"{}",statsData:"{}",editSettingsData:"{}",activeName:"Settings",showEditSettings:!0,showSettings:!0,showMapping:!0,showStats:!0,drawerShow:!1,settingsType:"add",mappingTitle:"",indexName:"",openSettings:!1,total:0,connectLoading:!1,page:1,limit:10,pageshow:!0,list:[],input:"",status:"",mappings:{},selectIndexList:[],openMappings:!1,allList:[],max:8}},destroyed(){sessionStorage.setItem("CatIndices",this.input)},computed:{isMobile(){return D.IsMobile()}},mounted(){const e=sessionStorage.getItem("CatIndices");e!=null&&(this.input=e),this.startGuid(),this.GetMapAction(),this.searchData()},methods:{openMappingDialog(e){this.indexName=e,this.openMappings=!0},async finishGuid(){},async startGuid(){},selectChange(e){this.selectIndexList=[];for(const t of e)this.selectIndexList.push(t.index)},async changeMapToAnotherIndex(e){e==""&&(e=this.indexName);const t={};t.es_connect=D.GetSelectEsConnID(),t.index_name=e;const a=await le(t);a.code==0&&(this.mappingData=JSON.stringify(a.data.list[e].mappings,null,"	"))},getMapping(e){this.mappingData=e},async saveMappinng(){let e=pe(this.mappingData);try{e=JSON.parse(e)}catch{g({type:"error",message:"JSON格式不正确"});return}const t=Object.keys(e);if(t.length==0){g({type:"error",message:"请按格式写type名字"});return}const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=this.indexName,e[t[0]].to$t()!="false"?(a.properties=e[t[0]],a.type_name=t[0]):a.properties=e,this.loadingGroup.saveMappinng=!0;const{data:o,code:n,msg:r}=await he(a);this.loadingGroup.saveMappinng=!1,n==0?g({type:"success",message:r}):g({type:"error",message:r})},openMappingEditDialog(e,t){t?this.mappingTitle=$t("新增字段"):this.mappingTitle=$t("新增映射结构"),this.indexName=e,this.openMappings=!0},async GetMapAction(){const e={};e.es_connect=D.GetSelectEsConnID();const{code:t,data:a,msg:o}=await le(e);if(t==0)this.mappings=a.list;else{g({type:"error",message:o});return}},submitSettings(){const e={};e.es_connect=D.GetSelectEsConnID();try{e.settings=JSON.parse(this.editSettingsData)}catch(a){console.log(a),g({type:"error",message:"JSON 解析异常"});return}e.index_name=this.indexName,e.types="update";const t=this.$loading({lock:!0,text:"Loading",spinner:"el-button-loading",background:"rgba(0, 0, 0, 0.7)"});me(e).then(a=>{a.code==0||a.code==200?(g({type:"success",message:a.msg}),this.search()):g({type:"error",message:a.msg}),t.close()}).catch(a=>{t.close()})},getSettings(e){this.editSettingsData=e},resetSettings(){this.changeTab()},Forcemerge(e,t){const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ie(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Empty(e,t){const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Oe(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Flush(e,t){const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ve(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},CacheClear(e,t){const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ae(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Open(e,t){const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,ze(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Close(e,t){const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,je(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Refresh(e,t){const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Te(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:o.msg}),this.search()):g({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},async changeTab(e){let t=0;e!=null&&(t=Number(e.index));const a={};let o={};switch(a.es_connect=D.GetSelectEsConnID(),a.index_name=this.indexName,t){case 0:o=await Le(a),o.code==0&&(this.settingData=JSON.stringify(o.data,null,"	")),this.showSettings=!1,this.$nextTick(()=>{this.showSettings=!0});return;case 1:o=await le(a),o.code==0&&(this.mappingData=JSON.stringify(o.data.list[this.indexName].mappings,null,"	"),Object.keys(o.data.list[this.indexName].mappings).length==0&&g({type:"error",message:"您还没有设置映射结构"})),this.showMapping=!1,this.$nextTick(()=>{this.showMapping=!0});return;case 2:o=await fe(a),o.code==0&&(this.statsData=JSON.stringify(o.data,null,"	")),this.showStats=!1,this.$nextTick(()=>{this.showStats=!0});return;case 3:const{data:n}=await ge(a),r=["creation_date","version","provided_name","uuid","format","number_of_shards"];for(const G of r)n.index.hasOwnProperty(G)&&delete n.index[G];this.editSettingsData=JSON.stringify(n,null,"	"),this.showEditSettings=!1,this.$nextTick(()=>{this.showEditSettings=!0});return;case 4:return;default:return}},openDrawer(e){this.indexName=e,this.changeTab(),this.drawerShow=!0},drawerHandleClose(e){this.indexName="",this.activeName="Settings",e()},bigNumberTransform(e){return qe(e)},openSettingDialog(e,t){this.indexName=e,this.settingsType=t,this.openSettings=!0},readOnlyAllowDelete(){const e={};e.es_connect=D.GetSelectEsConnID(),this.readOnlyAllowDeleteLoading=!0,xe(e).then(t=>{t.code==0||t.code==200?g({type:"success",message:t.msg}):g({type:"error",message:t.msg}),this.readOnlyAllowDeleteLoading=!1}).catch(t=>{this.readOnlyAllowDeleteLoading=!1})},querySearch(e,t){let a=JSON.parse(JSON.stringify(this.indexTishiList));if(e==null&&(e=""),e.trim()==""){a.length>this.max?t(a.slice(0,this.max)):t(a);return}a=Z(a,e.trim()),a.length>this.max?t(a.slice(0,this.max)):t(a)},deleteIndex(e,t){this.$confirm("确定删除该索引吗?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{const a={};a.es_connect=D.GetSelectEsConnID(),a.index_name=e,this.loadingGroup[t]=!0,Ee(a).then(o=>{o.code==0||o.code==200?(g({type:"success",message:e+"已删除"}),this.searchData(),this.loadingGroup[t]=!1):(g({type:"error",message:o.msg}),this.loadingGroup[t]=!1)}).catch(o=>{})}).catch(a=>{console.error(a)})},closeSettings(){this.indexName="",this.settingsType="add",this.openSettings=!1},closeMappings(){this.indexName="",this.mappingTitle="add",this.openMappings=!1},search(){this.page=1,this.pageshow=!1,this.searchData(),this.$nextTick(()=>{this.pageshow=!0})},filterData(e,t){return Z(e,t)},handleSizeChange(e){console.log(`每页 ${e} 条`),this.limit=e,this.pageLimit()},handleCurrentChange(e){console.log(`当前页: ${e}`),this.page=e,this.pageLimit()},pageLimit(){this.list=this.allList.filter((e,t)=>t<this.page*this.limit&&t>=this.limit*(this.page-1))},searchData(){this.connectLoading=!0;const e={cat:"CatIndices",es_connect:D.GetSelectEsConnID()};this.indexTishiList=[],ke(e).then(t=>{if(t.code==0){const a=t.data;for(const n in a){const r=a[n];for(const G in r){let L=parseInt(r[G]);isNaN(L)&&(L=r[G]),a[n][G.split(".").join("->")]=L}this.indexTishiList.push({value:r.index,data:r.index})}let o=[];if(this.status.trim()!="")for(const n of a)n.health==this.status.trim()&&o.push(n);else o=a;o=Z(o,this.input.trim()),this.allList=o,this.total=o.length,this.pageLimit()}else g({type:"error",message:t.msg});this.connectLoading=!1}).catch(t=>{console.log(t),this.connectLoading=!1})}}},ct=e=>(Ke("data-v-4612b7fb"),e=e(),We(),e),pt={class:"app-container"},mt={class:"search-container"},gt=ct(()=>A("span",{id:"lixianglong"},"筛选 ",-1)),ft={class:"search-container operate"},ht={class:"search-container operate"};function yt(e,t,a,o,n,r){const G=p("el-option"),L=p("el-select"),z=p("el-form-item"),h=p("el-col"),M=p("el-autocomplete"),v=p("el-button"),U=p("el-row"),b=p("el-form"),I=p("el-collapse-item"),f=p("el-collapse"),u=p("el-tooltip"),c=p("el-container"),i=p("el-table-column"),_=p("el-table"),V=p("el-pagination"),j=p("json-editor"),E=p("el-tab-pane"),T=p("el-tag"),Q=p("index-select"),X=p("el-link"),q=p("alias"),J=p("el-tabs"),S=p("el-drawer"),P=p("settings"),B=p("mappings"),m=ue("loading");return y(),F("div",pt,[A("div",mt,[l(f,{modelValue:n.activeNames,"onUpdate:modelValue":t[2]||(t[2]=d=>n.activeNames=d)},{default:s(()=>[l(I,{name:"1"},{title:s(()=>[gt]),default:s(()=>[l(b,null,{default:s(()=>[l(U,{gutter:20},{default:s(()=>[l(h,{lg:3,md:12,sm:4,xl:6,xs:24},{default:s(()=>[l(z,{label:"状态"},{default:s(()=>[l(L,{id:"index-health-status",modelValue:n.status,"onUpdate:modelValue":t[0]||(t[0]=d=>n.status=d),class:"filter-item width150",filterable:"",onChange:r.search},{default:s(()=>[l(G,{label:e.$t("所有"),value:""},null,8,["label"]),l(G,{label:"green",value:"green"}),l(G,{label:"yellow",value:"yellow"}),l(G,{label:"red",value:"red"})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),l(h,{lg:8,md:12,sm:12,xl:6,xs:24},{default:s(()=>[l(z,{label:"索引名"},{default:s(()=>[l(M,{class:"filter-item width300",id:"index-keyword",clearable:"","fetch-suggestions":r.querySearch,style:{width:"300px"},modelValue:n.input,"onUpdate:modelValue":t[1]||(t[1]=d=>n.input=d),placeholder:e.$t("请输入索引名")},{default:s(({item:d})=>[A("span",null,x(d.value),1)]),_:1},8,["fetch-suggestions","modelValue","placeholder"]),l(v,{id:"index-search",type:"primary",icon:e.Search,onClick:r.search},null,8,["icon","onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(b,{style:{"margin-top":"15px"}},{default:s(()=>[l(U,{gutter:20},{default:s(()=>[l(h,{lg:20,md:12,sm:4,xl:6,xs:24},{default:s(()=>[l(z,{label:"索引操作"},{default:s(()=>[l(c,null,{default:s(()=>[l(u,{content:"关闭",placement:"top"},{default:s(()=>[N(l(v,{disabled:n.loadingGroup.close,id:"patchCloseIndex",type:"danger",icon:e.Hide,onClick:t[3]||(t[3]=d=>r.Close("close",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[m,n.loadingGroup.close]])]),_:1}),l(u,{content:"打开",placement:"top"},{default:s(()=>[N(l(v,{id:"patchOpenIndex",disabled:n.loadingGroup.open,type:"success",icon:e.View,onClick:t[4]||(t[4]=d=>r.Open("open",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[m,n.loadingGroup.open]])]),_:1}),l(u,{content:"新建",placement:"top"},{default:s(()=>[l(v,{icon:e.Plus,id:"new-index",onClick:t[5]||(t[5]=d=>r.openSettingDialog("","add"))},null,8,["icon"])]),_:1}),l(u,{content:"删除",placement:"top"},{default:s(()=>[N(l(v,{icon:e.Delete,id:"patchDeleteIndex",disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[6]||(t[6]=d=>r.deleteIndex(n.selectIndexList.join(","),"deleteIndex"))},null,8,["icon","disabled"]),[[m,n.loadingGroup.deleteIndex]])]),_:1}),l(u,{content:"将节点切换为可读写状态",placement:"top"},{default:s(()=>[N(l(v,{icon:e.Sort,disabled:n.readOnlyAllowDeleteLoading,id:"readOnlyAllowDelete",type:"warning",onClick:t[7]||(t[7]=d=>r.readOnlyAllowDelete())},null,8,["icon","disabled"]),[[m,n.readOnlyAllowDeleteLoading]])]),_:1}),l(u,{content:"将所选索引刷新到磁盘",placement:"top"},{default:s(()=>[N(l(v,{id:"patchFlushIndex",disabled:n.loadingGroup._flush,type:"warning",icon:e.BrushFilled,onClick:t[8]||(t[8]=d=>r.Flush("_flush",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[m,n.loadingGroup._flush]])]),_:1}),l(u,{content:"强制合并索引",placement:"top"},{default:s(()=>[N(l(v,{icon:e.Connection,id:"patchForcemergeIndex",disabled:n.loadingGroup._forcemerge,onClick:t[9]||(t[9]=d=>r.Forcemerge("_forcemerge",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[m,n.loadingGroup._forcemerge]])]),_:1}),l(u,{content:"刷新索引",placement:"top"},{default:s(()=>[N(l(v,{id:"patchRefreshIndex",disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[10]||(t[10]=d=>r.Refresh("_refresh",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[m,n.loadingGroup._refresh]])]),_:1}),l(u,{content:"清空索引",placement:"top"},{default:s(()=>[N(l(v,{id:"patchEmptyIndex",disabled:n.loadingGroup.empty,icon:e.DocumentDelete,type:"danger",onClick:t[11]||(t[11]=d=>r.Empty("empty",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[m,n.loadingGroup.empty]])]),_:1}),l(u,{content:"清理缓存",placement:"top"},{default:s(()=>[N(l(v,{icon:e.ToiletPaper,id:"patchCacheClear",disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[12]||(t[12]=d=>r.CacheClear("_cache/clear",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[m,n.loadingGroup["_cache/clear"]]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),N((y(),k(_,{data:n.list,onSelectionChange:r.selectChange},{default:s(()=>[l(i,{type:"selection",width:"55"}),l(i,{align:"center",label:e.$t("健康"),width:"100"},{default:s(d=>[d.row.health=="green"?(y(),k(v,{key:0,type:"success",circle:""})):O("",!0),d.row.health=="yellow"?(y(),k(v,{key:1,type:"warning",circle:""})):O("",!0),d.row.health=="red"?(y(),k(v,{key:2,type:"danger",circle:""})):O("",!0)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("状态"),width:"100"},{default:s(d=>[N(l(v,{type:"success",onClick:R=>r.Close("close",d.row.index)},{default:s(()=>[C(x(e.$t("开启")),1)]),_:2},1032,["onClick"]),[[se,d.row.status=="open"]]),N(l(v,{type:"danger",onClick:R=>r.Open("open",d.row.index)},{default:s(()=>[C(x(e.$t("关闭")),1)]),_:2},1032,["onClick"]),[[se,d.row.status=="close"]])]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("索引名"),width:"180"},{default:s(d=>[C(x(d.row.index),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("uuid"),width:"180"},{default:s(d=>[C(x(d.row.uuid),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主分片数"),width:"80",prop:"pri",sortable:""},{default:s(d=>[C(x(d.row.pri),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("副本分片数量"),width:"80",prop:"rep",sortable:""},{default:s(d=>[C(x(d.row.rep),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("文档总数"),width:"80",prop:"docs->count",sortable:""},{default:s(d=>[C(x(r.bigNumberTransform(d.row["docs.count"])),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("删除状态的文档"),width:"80",prop:"docs->deleted",sortable:""},{default:s(d=>[C(x(d.row["docs.deleted"]),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主+副本分片大小"),width:"120",prop:"store->size",sortable:""},{default:s(d=>[C(x(d.row["store.size"]),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主分片大小"),width:"150",prop:"pri->store->size",sortable:""},{default:s(d=>[C(x(d.row["pri.store.size"]),1)]),_:1},8,["label"]),l(i,{align:"center",width:"190",label:e.$t("操作"),fixed:"right"},{default:s(d=>[l(u,{content:"修改配置",placement:"top"},{default:s(()=>[l(v,{icon:e.Setting,type:"info",onClick:R=>r.openSettingDialog(d.row.index,"update")},null,8,["icon","onClick"])]),_:2},1024),l(u,{content:"修改映射",placement:"top"},{default:s(()=>[l(v,{icon:e.EditPen,type:"waring",onClick:R=>r.openMappingEditDialog(d.row.index,!1)},null,8,["icon","onClick"])]),_:2},1024),l(u,{content:"更多",placement:"top"},{default:s(()=>[l(v,{icon:e.More,type:"primary",onClick:R=>r.openDrawer(d.row.index)},null,8,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[m,n.connectLoading]]),n.pageshow?(y(),k(V,{key:0,class:"pagination-container","current-page":n.page,"page-sizes":[10,20,30,50,100,150,200,500,1e3],"page-size":n.limit,layout:"total, sizes, prev, pager, next",total:n.total,onSizeChange:r.handleSizeChange,onCurrentChange:r.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])):O("",!0),l(S,{ref:"drawer",title:n.indexName,"before-close":r.drawerHandleClose,modelValue:n.drawerShow,"onUpdate:modelValue":t[27]||(t[27]=d=>n.drawerShow=d),direction:"rtl","custom-class":"demo-drawer","close-on-press-escape":"","destroy-on-close":"",size:r.isMobile?"100%":"50%"},{default:s(()=>[l(J,{modelValue:n.activeName,"onUpdate:modelValue":t[26]||(t[26]=d=>n.activeName=d),onTabClick:r.changeTab},{default:s(()=>[l(E,{label:e.$t("设置"),name:"Settings"},{default:s(()=>[n.showSettings?(y(),k(j,{key:0,value:n.settingData,"onUpdate:value":t[13]||(t[13]=d=>n.settingData=d),styles:"width: 100%",read:!0,title:e.$t("设置")},null,8,["value","title"])):O("",!0)]),_:1},8,["label"]),l(E,{label:e.$t("映射"),name:"Mapping"},{default:s(()=>[A("div",ft,[l(T,{type:"warning"},{default:s(()=>[C(x(e.$t("切换为其它索引的映射")),1)]),_:1}),l(Q,{clearable:!0,style:{width:"150px"},placeholder:e.$t("请选择索引名"),onChange:r.changeMapToAnotherIndex},null,8,["placeholder","onChange"]),l(T,{type:"primary"},{default:s(()=>[C(x(e.$t("操作")),1)]),_:1}),N((y(),k(v,{disabled:n.loadingGroup.saveMappinng,type:"primary",onClick:r.saveMappinng},{default:s(()=>[C(x(e.$t("修改")),1)]),_:1},8,["disabled","onClick"])),[[m,n.loadingGroup.saveMappinng]]),l(X,{type:"danger"},{default:s(()=>[C(x(e.$t("【注意：只能新增映射字段不可修改映射字段类型】")),1)]),_:1})]),n.showMapping?(y(),k(j,{key:0,value:n.mappingData,"onUpdate:value":t[14]||(t[14]=d=>n.mappingData=d),styles:"width: 100%",read:!1,title:e.$t("映射"),onGetValue:r.getMapping},null,8,["value","title","onGetValue"])):O("",!0)]),_:1},8,["label"]),l(E,{label:"Stats",name:"Stats"},{default:s(()=>[n.showStats?(y(),k(j,{key:0,value:n.statsData,"onUpdate:value":t[15]||(t[15]=d=>n.statsData=d),styles:"width: 100%;",read:!0,title:"Stats"},null,8,["value"])):O("",!0)]),_:1}),l(E,{label:e.$t("编辑索引配置"),name:"editSettings"},{default:s(()=>[l(b,null,{default:s(()=>[l(z,{label:e.$t("编辑索引配置")},{default:s(()=>[l(v,{type:"primary",onClick:t[16]||(t[16]=d=>r.submitSettings())},{default:s(()=>[C(x(e.$t("提交")),1)]),_:1}),l(v,{onClick:r.resetSettings},{default:s(()=>[C(x(e.$t("重置")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),l(z,null,{default:s(()=>[n.showEditSettings?(y(),k(j,{key:0,value:n.editSettingsData,"onUpdate:value":t[17]||(t[17]=d=>n.editSettingsData=d),"point-out":n.pointOut,styles:"width: 100%;",read:!1,title:e.$t("编辑配置"),onGetValue:r.getSettings},null,8,["value","point-out","title","onGetValue"])):O("",!0)]),_:1})]),_:1})]),_:1},8,["label"]),l(E,{label:e.$t("修改别名"),name:"alias"},{default:s(()=>[n.activeName=="alias"?(y(),k(q,{key:0,"index-name":n.indexName},null,8,["index-name"])):O("",!0)]),_:1},8,["label"]),A("div",ht,[l(b,null,{default:s(()=>[l(z,{label:"操作"},{default:s(()=>[l(u,{content:"关闭",placement:"top"},{default:s(()=>[N(l(v,{icon:e.Hide,disabled:n.loadingGroup.close,type:"danger",onClick:t[18]||(t[18]=d=>r.Close("close",n.indexName))},null,8,["icon","disabled"]),[[m,n.loadingGroup.close]])]),_:1}),l(u,{content:"打开",placement:"top"},{default:s(()=>[N(l(v,{icon:e.View,disabled:n.loadingGroup.open,type:"success",onClick:t[19]||(t[19]=d=>r.Open("open",n.indexName))},null,8,["icon","disabled"]),[[m,n.loadingGroup.open]])]),_:1}),l(u,{content:"强制合并索引【forcemerge操作,手动释放磁盘空间】",placement:"top"},{default:s(()=>[N(l(v,{disabled:n.loadingGroup._forcemerge,icon:e.Connection,onClick:t[20]||(t[20]=d=>r.Forcemerge("_forcemerge",n.indexName))},null,8,["disabled","icon"]),[[m,n.loadingGroup._forcemerge]])]),_:1}),l(u,{content:"刷新索引【为了让最新的数据可以立即被搜索到】",placement:"top"},{default:s(()=>[N(l(v,{disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[21]||(t[21]=d=>r.Refresh("_refresh",n.indexName))},null,8,["disabled","icon"]),[[m,n.loadingGroup._refresh]])]),_:1}),l(u,{content:"将索引刷新到磁盘【让数据持久化到磁盘中】",placement:"top"},{default:s(()=>[N(l(v,{icon:e.BrushFilled,disabled:n.loadingGroup._flush,type:"info",onClick:t[22]||(t[22]=d=>r.Flush("_flush",n.indexName))},null,8,["icon","disabled"]),[[m,n.loadingGroup._flush]])]),_:1}),l(u,{content:"清理缓存",placement:"top"},{default:s(()=>[N(l(v,{icon:e.ToiletPaper,disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[23]||(t[23]=d=>r.CacheClear("_cache/clear",n.indexName))},null,8,["icon","disabled"]),[[m,n.loadingGroup["_cache/clear"]]])]),_:1}),l(u,{content:"删除索引",placement:"top"},{default:s(()=>[N(l(v,{icon:e.Delete,disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[24]||(t[24]=d=>r.deleteIndex(n.indexName,"deleteIndex"))},null,8,["icon","disabled"]),[[m,n.loadingGroup.deleteIndex]])]),_:1}),l(u,{content:"清空索引",placement:"top"},{default:s(()=>[N(l(v,{disabled:n.loadingGroup.empty,type:"danger",icon:e.DocumentDelete,onClick:t[25]||(t[25]=d=>r.Empty("empty",n.indexName))},null,8,["disabled","icon"]),[[m,n.loadingGroup.empty]])]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue","onTabClick"])]),_:1},8,["title","before-close","modelValue","size"]),n.openSettings?(y(),k(P,{key:1,"index-name":n.indexName,"settings-type":n.settingsType,onFinished:r.search,open:n.openSettings,onClose:r.closeSettings},null,8,["index-name","settings-type","onFinished","open","onClose"])):O("",!0),n.openMappings?(y(),k(B,{key:2,"index-name":n.indexName,title:n.mappingTitle,open:n.openMappings,onClose:r.closeMappings},null,8,["index-name","title","open","onClose"])):O("",!0)])}const Dt=oe(ut,[["render",yt],["__scopeId","data-v-4612b7fb"]]);export{Dt as default};
