import{c as me}from"./index-0aae8c1b.js";import{f as Z,R as xe,C as ke}from"./es-382a2972.js";import{C as ge,G as fe,S as he,a as Ce,B as Se,A as De,R as Ge,M as Ne,F as Ie,E as Oe,b as Ve,c as ze,O as Ae,d as je,e as Te,f as Le,D as Ee}from"./es-index-3eb427b6.js";import{U as ye,L as le,e as Je}from"./es-map-fa49449a.js";import{g as re,b as D,e as _e,f as de,r as c,o as _,c as F,a as l,w as s,h as k,t as w,E as h,s as G,i as Me,j as V,n as W,k as x,u as ee,l as Fe,m as Ue,p as te,F as ne,q as ae,v as Pe,x as O,y as Be,z as ue,A as S,B as Re,C as se,I as He,D as Ke,G as We}from"./index-15b0a2bf.js";import{J as ve}from"./index-5fbead7a.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import{I as be}from"./select-ddf6de5d.js";function qe(e){const t=["","",""];let a=1e3,o=3;for(;e/a>=1;)a*=10,o+=1;if(o<=4)t[1]="千",t[0]=parseInt(e/1e3)+"";else if(o<=8){const n=parseInt(o-4)/3>1?"千万":"万",r=n==="万"?1e4:1e7;t[1]=n,t[0]=e/r+""}else if(o<=16){let n=(o-8)/3>1?"千亿":"亿";n=(o-8)/4>1?"万亿":n,n=(o-8)/7>1?"千万亿":n;let r=1;n==="亿"?r=1e8:n==="千亿"?r=1e11:n==="万亿"?r=1e12:n==="千万亿"&&(r=1e15),t[1]=n,t[0]=parseInt(e/r)+""}return e<1e3&&(t[1]="",t[0]=e+""),t.join("")}const Qe={__name:"settings",props:{indexName:{type:String,default:""},settingsType:{type:String,default:"add"},open:{type:Boolean,default:!1}},emits:["finished","close"],setup(e,{emit:t}){re().appContext.config.globalProperties;const a=e,o=D(a.indexName),n=D(a.settingsType),r=D(a.open),N=t,L=D(["number_of_shards","index.translog.sync_interval","index.shard.check_on_startup","index.routing_partition_size","index.codec"]),z=D(!1),y=D({"index.shard.check_on_startup":"","index.routing_partition_size":"","index.codec":"","index.auto_expand_replicas":"","index.max_result_window":"","index.max_rescore_window":"","index.blocks.read_only":"","index.blocks.read":"","index.blocks.write":"","index.blocks.metadata":"","index.blocks.read_only_allow_delete":"","index.max_refresh_listeners":"",number_of_shards:"",number_of_replicas:"",refresh_interval:"","index.translog.sync_interval":"","index.translog.durability":"","index.translog.flush_threshold_size":"","index.merge.scheduler.max_thread_count":"","index.merge.policy.max_merged_segment":"","index.merge.policy.segments_per_tier":""}),M=_e(()=>n.value==="add"?"新增索引配置":"修改索引配置"),b=()=>{if(y.value["index.routing_partition_size"]>=y.value["index.number_of_shards"]){h({type:"error",message:"自定义路由值可以转发的目的分片数 必须小于 主分片数"});return}if(o.value===""){h({type:"error",message:"索引名不能为空"});return}const f={};if(f.es_connect=G.GetSelectEsConnID(),f.settings=me(y.value),f.index_name=o.value,f.types=n.value,n.value==="update")for(const u of L.value)delete f.settings[u];for(const u in f.settings)f.settings[u]===""&&delete f.settings[u];const g=Me.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});ge(f).then(u=>{u.code===0||u.code===200?(h({type:"success",message:u.msg}),a.settingsType="update",N("finished")):h({type:"error",message:u.msg}),g.close()}).catch(u=>{g.close()})},U=()=>{const f={};f.es_connect=G.GetSelectEsConnID(),f.index_name=o.value,fe(f).then(g=>{if(g.code===0||g.code===200){const u=g.data.index;if(y.value.number_of_replicas=u.number_of_replicas,y.value.number_of_shards=u.number_of_shards,u.hasOwnProperty("auto_expand_replicas")&&(y.value["index.auto_expand_replicas"]=u.auto_expand_replicas),u.hasOwnProperty("blocks")){const i=u.blocks;i.hasOwnProperty("metadata")&&(y.value["index.blocks.metadata"]=i.metadata),i.hasOwnProperty("read")&&(y.value["index.blocks.read"]=i.read),i.hasOwnProperty("read_only")&&(y.value["index.blocks.read_only"]=i.read_only),i.hasOwnProperty("read_only_allow_delete")&&(y.value["index.blocks.read_only_allow_delete"]=i.read_only_allow_delete),i.hasOwnProperty("write")&&(y.value["index.blocks.write"]=i.write)}if(u.hasOwnProperty("merge")){const i=u.merge;if(i.hasOwnProperty("policy")){const v=i.policy;v.hasOwnProperty("max_merged_segment")&&(y.value["index.merge.policy.max_merged_segment"]=v.max_merged_segment),v.hasOwnProperty("max_merged_segment")&&(y.value["index.merge.policy.segments_per_tier"]=v.segments_per_tier)}if(i.hasOwnProperty("scheduler")){const v=i.scheduler;v.hasOwnProperty("max_thread_count")&&(y.value["index.merge.scheduler.max_thread_count"]=v.max_thread_count)}}if(u.hasOwnProperty("max_refresh_listeners")&&(y.value["index.max_refresh_listeners"]=u.max_refresh_listeners),u.hasOwnProperty("max_rescore_window")&&(y.value["index.max_rescore_window"]=u.max_rescore_window),u.hasOwnProperty("max_result_window")&&(y.value["index.max_result_window"]=u.max_result_window),u.hasOwnProperty("refresh_interval")&&(y.value.refresh_interval=u.refresh_interval),u.hasOwnProperty("translog")){const i=u.translog;i.hasOwnProperty("durability")&&(y.value["index.translog.durability"]=i.durability),i.hasOwnProperty("flush_threshold_size")&&(y.value["index.translog.flush_threshold_size"]=i.flush_threshold_size)}console.log(y.value,"form")}else h({type:"error",message:g.msg})}).catch(g=>{console.log(g)})},m=()=>{const f={};f.es_connect=G.GetSelectEsConnID(),f.index_name=o.value,he(f).then(g=>{g.code==0||g.code==200?z.value=g.data[0].status=="open":h({type:"error",message:g.msg})}).catch(g=>{console.error(g)})},I=()=>{N("close")};return de(()=>{o.value!=""&&(m(),U())}),(f,g)=>{const u=c("el-input"),i=c("el-form-item"),v=c("el-form"),A=c("el-button"),j=c("el-card"),E=c("el-drawer");return _(),F("div",null,[l(E,{size:"90%",modelValue:r.value,"onUpdate:modelValue":g[5]||(g[5]=T=>r.value=T),title:M.value,onClose:I},{default:s(()=>[l(j,{class:"box-card"},{footer:s(()=>[l(A,{type:"danger",onClick:I},{default:s(()=>[k(w(f.$t("取消")),1)]),_:1}),l(A,{type:"primary",onClick:b},{default:s(()=>[k(w(f.$t("确认")),1)]),_:1})]),default:s(()=>[l(v,{"label-width":"500px","label-position":"left"},{default:s(()=>[l(i,{label:f.$t("索引名称：")},{default:s(()=>[l(u,{modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=T=>o.value=T),placeholder:f.$t("多个索引名用,隔开"),disabled:n.value!=="add"},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),l(i,{label:"number_of_shards (分片数)："},{default:s(()=>[l(u,{modelValue:y.value.number_of_shards,"onUpdate:modelValue":g[1]||(g[1]=T=>y.value.number_of_shards=T),type:"number",style:{width:"300px"},disabled:z.value},null,8,["modelValue","disabled"])]),_:1}),l(i,{label:"number_of_replicas (副本数)："},{default:s(()=>[l(u,{modelValue:y.value.number_of_replicas,"onUpdate:modelValue":g[2]||(g[2]=T=>y.value.number_of_replicas=T),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(i,{label:"refresh_interval (索引的刷新时间间隔)："},{default:s(()=>[l(u,{modelValue:y.value.refresh_interval,"onUpdate:modelValue":g[3]||(g[3]=T=>y.value.refresh_interval=T),placeholder:f.$t("索引的刷新时间间隔")},null,8,["modelValue","placeholder"])]),_:1}),l(i,{label:"max_result_window  (from+size 的最大值)："},{default:s(()=>[l(u,{modelValue:y.value["index.max_result_window"],"onUpdate:modelValue":g[4]||(g[4]=T=>y.value["index.max_result_window"]=T),type:"number",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}};const Xe={key:0,class:"item"},Ye={key:1,style:{"margin-left":"14px"}},Ze={class:"item-type item-cell"},$e={class:"item-value item-cell"},K=8,et={__name:"Item",props:{item:{type:Object,default:{key:"",value:"",type:""}},names:{type:Array},parent:{type:Object},index:{type:Number,default:0},deep:{type:Number,default:0},size:{type:String,default:"small"},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0}},setup(e){const t=e,a=D(!t.openFlag),o=D(t.deep+1),n=[{value:"String",label:"String"},{value:"Object",label:"Object"},{value:"Array",label:"Array"},{value:"Number",label:"Number"},{value:"Boolean",label:"Boolean"}],r=[{value:"Object",label:"Object"},{value:"Array",label:"Array"}],N=[{value:"type",data:" 数据类型"},{value:"format",data:" 时间格式化"},{value:"analyzer",data:" 分词器"},{value:"normalizer",data:" 分析器"},{value:"boost",data:" 权重"},{value:"coerce",data:" 强制类型转换"},{value:"copy_to",data:" 合并参数"},{value:"doc_values",data:" 文档值"},{value:"dynamic",data:" 动态设置"},{value:"enabled",data:" 是否开启字段"},{value:"fielddata",data:" 字段数据"},{value:"ignore_above",data:" 字段保存最大长度"},{value:"ignore_malformed",data:" 忽略格式不对的数据"},{value:"include_in_all",data:" _all 查询包含字段"},{value:"index_options",data:" 索引设置"},{value:"index",data:" 是否可以被搜索"},{value:"fields",data:" 字段"},{value:"norms",data:" 标准信息"},{value:"null_value",data:" 空值"},{value:"position_increment_gap",data:" 短语位置间隙"},{value:"properties",data:" 属性"},{value:"search_analyzer",data:" 搜索分析器"},{value:"similarity",data:" 匹配算法"},{value:"store",data:" 字段是否被存储"},{value:"term_vector",data:" 词根信息"}],L=[{value:"text",data:"字符串类型(可分词) "},{value:"keyword",data:"字符串类型(不可分词) "},{value:"long",data:"数字类型 "},{value:"integer",data:"数字类型 "},{value:"short",data:"数字类型 "},{value:"byte",data:"数字类型 "},{value:"double",data:"数字类型 "},{value:"float",data:"数字类型 "},{value:"half_float",data:"数字类型 "},{value:"scaled_float",data:"数字类型 "},{value:"date",data:"时间类型 "},{value:"boolean",data:"布尔类型 "},{value:"binary",data:"二进制类型 "},{value:"Array",data:"数组类型 "},{value:"object",data:"对象类型  "},{value:"nested",data:"嵌套类型 "},{value:"geo_point",data:"地理类型 "},{value:"geo_shape",data:"多边形类型 "},{value:"ip",data:"ip类型 "},{value:"completion",data:"补全类型 "},{value:"token_count",data:"令牌计数类型 "},{value:"yyyy-MM-dd HH:mm:ss",data:"时间格式化 "}],z=["el-tag-blue","el-tag-orange"],y=["item-cell item-control-cell","item-cell"],M=["el-input el-input--small"],b=(u,i)=>{let v=JSON.parse(JSON.stringify(N));if(u==null&&(u=""),u.trim()==""){v.length>K?i(v.slice(0,K)):i(v);return}v=Z(v,u.trim()),v.length>K?i(v.slice(0,K)):i(v)},U=(u,i)=>{let v=JSON.parse(JSON.stringify(L));if(u==null&&(u=""),u.trim()==""){v.length>K?i(v.slice(0,K)):i(v);return}v=Z(v,u.trim()),v.length>K?i(v.slice(0,K)):i(v)},m=u=>{const i=N.find(v=>v.value===u);return i?i.data:""},I=()=>{["Object","Array"].includes(t.item.type)&&(a.value=!1)},f=()=>{t.item.childs||(t.item.childs=[]),t.item.childs.push({key:"",value:"",type:""})},g=()=>{const u=t.parent.childs.indexOf(t.item);u>-1&&t.parent.childs.splice(u,1)};return(u,i)=>{const v=c("el-icon"),A=c("el-link"),j=c("el-tag"),E=c("el-autocomplete"),T=c("el-option"),Q=c("el-select"),X=c("el-input-number"),q=c("el-radio"),J=c("el-radio-group"),C=c("el-tooltip"),P=c("el-popconfirm"),B=c("el-row");return _(),F("div",null,[l(B,{style:te("padding-left: "+(o.value-1)*15+"px; margin-top: 5px")},{default:s(()=>[e.rootFlag?(_(),F("div",Xe,[V("div",{class:W(y),onClick:i[0]||(i[0]=p=>a.value=!a.value)},[e.item.childs!=null?(_(),x(A,{key:0,underline:!1},{default:s(()=>[a.value?(_(),x(v,{key:0},{default:s(()=>[l(ee(Fe))]),_:1})):(_(),x(v,{key:1},{default:s(()=>[l(ee(Ue))]),_:1}))]),_:1})):(_(),F("i",Ye))]),V("div",{class:"item-cell",onClick:i[1]||(i[1]=p=>a.value=!a.value)},[l(A,{underline:!1},{default:s(()=>[l(j,{effect:"plain",class:W(z)},{default:s(()=>[V("span",null,w(m(e.item.key)?m(e.item.key):e.item.key),1)]),_:1})]),_:1})]),V("div",{class:"item-key item-cell",style:te("width: "+(300-(o.value-1)*15)+"px")},[l(E,{modelValue:e.item.key,"onUpdate:modelValue":i[2]||(i[2]=p=>e.item.key=p),clearable:"","fetch-suggestions":b,placeholder:e.parent.type=="Array"?"":"请输入键",size:e.size,disabled:e.item.isRoot||e.parent.type=="Array",style:te("width: "+(290-(o.value-1)*15)+"px")},{default:s(({item:p})=>[V("span",null,w(p.value)+"-"+w(p.data),1)]),_:1},8,["modelValue","placeholder","size","disabled","style"])],4),V("div",Ze,[l(Q,{modelValue:e.item.type,"onUpdate:modelValue":i[3]||(i[3]=p=>e.item.type=p),size:e.size,placeholder:"请选择",class:"select-body",onChange:I},{default:s(()=>[(_(!0),F(ne,null,ae(e.item.isRoot?r:n,p=>(_(),x(T,{key:p.value,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","size"])]),V("div",$e,[e.item.type!="Number"&&e.item.type!="Boolean"?(_(),x(E,{key:0,modelValue:e.item.value,"onUpdate:modelValue":i[4]||(i[4]=p=>e.item.value=p),"fetch-suggestions":U,clearable:"",size:e.size,placeholder:e.item.type=="Array"||e.item.type=="Object"?"":"请输入值",disabled:e.item.type=="Array"||e.item.type=="Object",class:W(M)},{default:s(({item:p})=>[V("span",null,w(p.value)+"-"+w(p.data),1)]),_:1},8,["modelValue","size","placeholder","disabled"])):e.item.type=="Number"?(_(),x(X,{key:1,modelValue:e.item.value,"onUpdate:modelValue":i[5]||(i[5]=p=>e.item.value=p),size:e.size,class:W(M)},null,8,["modelValue","size"])):(_(),x(J,{key:2,modelValue:e.item.value,"onUpdate:modelValue":i[6]||(i[6]=p=>e.item.value=p),class:W(M)},{default:s(()=>[l(q,{class:"el-radio",label:!0},{default:s(()=>[k("是")]),_:1}),l(q,{class:"el-radio",label:!1},{default:s(()=>[k("否")]),_:1})]),_:1},8,["modelValue"]))]),V("div",{class:W(y)},[e.item.type=="Array"||e.item.type=="Object"?(_(),x(C,{key:0,class:"item-control-cell",content:"添加子元素",placement:"top"},{default:s(()=>[l(A,{underline:!1,onClick:f},{default:s(()=>[l(v,null,{default:s(()=>[l(ee(Pe))]),_:1})]),_:1})]),_:1})):O("",!0),e.item.isRoot?O("",!0):(_(),x(P,{key:1,title:"确定删除当前节点吗？",onConfirm:g},{default:s(()=>[l(A,{slot:"reference",underline:!1,class:"item-control-cell"},{default:s(()=>[l(v,null,{default:s(()=>[l(ee(Be))]),_:1})]),_:1})]),_:1}))])])):O("",!0)]),_:1},8,["style"]),V("div",{style:te(a.value?"display: none":"display: block")},[e.item.childs&&e.item.type=="Object"?(_(!0),F(ne,{key:0},ae(e.item.childs,(p,d)=>(_(),F("span",{key:d},[l(ie,{size:e.size,item:p,parent:e.item,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","names","deep","open-flag"])]))),128)):O("",!0),e.item.childs&&e.item.type=="Array"?(_(!0),F(ne,{key:1},ae(e.item.childs,(p,d)=>(_(),F("span",{key:d},[l(ie,{size:e.size,item:p,parent:e.item,index:d,names:e.names,deep:o.value,"open-flag":e.openFlag},null,8,["size","item","parent","index","names","deep","open-flag"])]))),128)):O("",!0)],4)])}}},ie=oe(et,[["__scopeId","data-v-b61ac616"]]);const tt={name:"VueJsonHelper",components:{Item:ie},props:{names:{type:Array},size:{type:String,default:"small"},jsonStr:{type:String},rootFlag:{type:Boolean,default:!0},openFlag:{type:Boolean,default:!0},borderFlag:{type:Boolean,default:!0},shadowFlag:{type:Boolean,default:!1},backTopFlag:{type:Boolean,default:!1}},data(){return{deep:0,isJson:!1,jsonData:void 0,errorResult:void 0,item:{key:"Root",value:null,type:null,isRoot:!0,childs:[]}}},watch:{item:{handler(e,t){if(e==t){var a=this.handleJsonData(e);a!=null&&this.$emit("jsonListener",a)}},immediate:!0,deep:!0}},created(){this.isJson=this.judgeJson(),this.item.childs=this.handleJson(this.jsonData),this.item.type=this.handleType()},methods:{judgeJson(){var e=!1;try{this.jsonData=JSON.parse(this.jsonStr),e=!0}catch(t){this.errorResult=t,e=!1}return e},handleJsonData(e){var t={},a=[],o=e.type,n=e.childs;for(var r in n)n[r].type!="Object"&&n[r].type!="Array"?o=="Object"?t[n[r].key]=n[r].value:o=="Array"&&a.push(n[r].value):o=="Object"?t[n[r].key]=this.handleJsonData(n[r]):o=="Array"&&a.push(this.handleJsonData(n[r]));if(o=="Object")return t;if(o=="Array")return a},handleJson(e){var t=[];for(var a in e){var o=this.judgeType(e[a]);if(o=="Object"||o=="Array"){var n={key:a,value:null,type:o,childs:this.handleJson(e[a])};t.push(n)}else{var n={key:a,value:e[a],type:o};t.push(n)}}return t},judgeType(e){var t=Object.prototype.toString.call(e);return t==="[object String]"?t="String":t==="[object Number]"?t="Number":t==="[object Boolean]"?t="Boolean":t==="[object Array]"?t="Array":t==="[object Object]"?t="Object":t=null,t},handleType(){return this.judgeType(this.jsonData)}}};function lt(e,t,a,o,n,r){const N=c("Item"),L=c("el-col"),z=c("el-backtop"),y=c("el-row");return _(),x(y,{class:W(a.borderFlag?"el-row-border":"")},{default:s(()=>[n.isJson?(_(),x(L,{key:0,class:"item-body"},{default:s(()=>[l(N,{item:n.item,deep:n.deep,parent:n.item,names:a.names,size:a.size,index:0,"root-flag":a.rootFlag,"open-flag":a.openFlag},null,8,["item","deep","parent","names","size","root-flag","open-flag"])]),_:1})):(_(),x(L,{key:1},{default:s(()=>[V("i",null,w(n.errorResult),1)]),_:1})),a.backTopFlag?(_(),x(z,{key:2})):O("",!0)]),_:1},8,["class"])}const nt=oe(tt,[["render",lt],["__scopeId","data-v-e81243a7"]]);const at={class:"app-container"},st={class:"search-container"},ot={__name:"mapping",props:{indexName:{type:String,default:""},open:{type:Boolean,default:!1},title:{type:String,default:"新增映射结构"}},emits:["close","finished"],setup(e,{emit:t}){const a=e,o=D(a.open),n=D(a.title),r=D(a.indexName),N=D("1");re().appContext.config.globalProperties;const L=_e(()=>JSON.stringify(JSON.parse(g.value),null,"	")),z=t,y=D(!1),M=D("false"),b=D("small"),U=[{key:"Root",name:"properties"},{key:"type",name:"数据类型"},{key:"format",name:"时间格式化"},{key:"analyzer",name:"分词器"},{key:"normalizer",name:"分析器"},{key:"boost",name:"权重"},{key:"coerce",name:"强制类型转换"},{key:"copy_to",name:"合并参数"},{key:"doc_values",name:"文档值"},{key:"dynamic",name:"动态设置"},{key:"enabled",name:"是否开启字段"},{key:"fielddata",name:"字段数据"},{key:"ignore_above",name:"字段保存最大长度"},{key:"ignore_malformed",name:"忽略格式不对的数据"},{key:"include_in_all",name:"_all 查询包含字段"},{key:"index_options",name:"索引设置"},{key:"index",name:"是否可以被搜索"},{key:"fields",name:"字段"},{key:"norms",name:"标准信息"},{key:"null_value",name:"空值"},{key:"position_increment_gap",name:"短语位置间隙"},{key:"properties",name:"属性"},{key:"search_analyzer",name:"搜索分析器"},{key:"similarity",name:"匹配算法"},{key:"store",name:"字段是否被存储"},{key:"term_vector",name:"词根信息"}],m=D(!0),I=D(!0),f=D(!1),g=D("{}"),u=D(!1),i=D(""),v=D(6),A=D(!1),j=D(!1),E=async()=>{let J={};try{J=JSON.parse(g.value)}catch{h({type:"error",message:"JSON格式不正确"});return}const C={es_connect:G.GetSelectEsConnID(),index_name:a.indexName},P={properties:J,dynamic:M.value};switch(v.value){case 6:C.properties=P,C.type_name=i.value;break;case 7:case 8:C.properties=P;break}y.value=!0;const{data:B,code:p,msg:d}=await ye(C);y.value=!1,p===0?(h({type:"success",message:d}),z("finished")):h({type:"error",message:d})},T=async()=>{var p,d,R,$;const J={es_connect:G.GetSelectEsConnID(),index_name:a.indexName},{data:C,code:P,msg:B}=await le(J);if(P!==0){h({type:"error",message:B});return}switch(v.value=C.ver,v.value){case 6:const Y=Object.keys(C.list[a.indexName].mappings);A.value=!0,Y.length===0?j.value=!1:(i.value=Y[0],j.value=!0,M.value=((p=C.list[a.indexName].mappings[i.value])==null?void 0:p.dynamic)??"false",g.value=JSON.stringify(((d=C.list[a.indexName].mappings[i.value])==null?void 0:d.properties)??"{}"));break;case 7:case 8:M.value=((R=C.list[a.indexName].mappings)==null?void 0:R.dynamic)??"false",g.value=JSON.stringify((($=C.list[a.indexName].mappings)==null?void 0:$.properties)??"{}");break}q()},Q=J=>{g.value=JSON.stringify(J)},X=()=>{z("close")},q=()=>{u.value=!1,Re(()=>{u.value=!0})};return de(()=>{T()}),(J,C)=>{const P=c("el-input"),B=c("el-form-item"),p=c("el-option"),d=c("el-select"),R=c("el-button"),$=c("el-form"),Y=c("el-tabs"),ce=c("el-tab-pane"),we=c("el-drawer"),pe=ue("loading");return _(),F("div",null,[l(we,{modelValue:o.value,"onUpdate:modelValue":C[4]||(C[4]=H=>o.value=H),title:n.value.concat(`【${r.value}】`),size:"80%",onClose:X},{default:s(()=>[V("div",at,[V("div",st,[l($,{inline:!0},{default:s(()=>[A.value?(_(),x(B,{key:0,label:"type"},{default:s(()=>[l(P,{modelValue:i.value,"onUpdate:modelValue":C[0]||(C[0]=H=>i.value=H),readonly:j.value,style:{width:"200px"}},null,8,["modelValue","readonly"])]),_:1})):O("",!0),l(B,{label:"dynamic"},{default:s(()=>[l(d,{style:{width:"100px"},modelValue:M.value,"onUpdate:modelValue":C[1]||(C[1]=H=>M.value=H)},{default:s(()=>[l(p,{label:J.$t("动态映射"),value:"true"},null,8,["label"]),l(p,{label:J.$t("静态映射"),value:"false"},null,8,["label"]),l(p,{label:J.$t("严格映射"),value:"strict"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(B,null,{default:s(()=>[S((_(),x(R,{disabled:y.value,type:"success",onClick:E},{default:s(()=>[k(w(J.$t("保存/修改映射")),1)]),_:1},8,["disabled"])),[[pe,y.value]])]),_:1})]),_:1})]),l(Y),l(Y,{modelValue:N.value,"onUpdate:modelValue":C[3]||(C[3]=H=>N.value=H),stretch:""},{default:s(()=>[l(ce,{name:"1",lazy:!0,label:J.$t("表单")},{default:s(()=>[S((_(),F("div",null,[u.value?(_(),x(nt,{key:0,size:b.value,names:U,"json-str":g.value,"root-flag":m.value,"open-flag":I.value,"back-top-flag":f.value,"shadow-flag":!1,"border-flag":!1,onJsonListener:Q},null,8,["size","json-str","root-flag","open-flag","back-top-flag"])):O("",!0)])),[[pe,!u.value]])]),_:1},8,["label"]),l(ce,{name:"2",lazy:!0,label:J.$t("JSON")},{default:s(()=>[V("div",null,[l(ve,{value:L.value,"onUpdate:value":C[2]||(C[2]=H=>L.value=H),height:"720",styles:"width: 100%",title:i.value},null,8,["value","title"])])]),_:1},8,["label"])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","title"])])}}},it=oe(ot,[["__scopeId","data-v-b39a3469"]]),rt={__name:"alias",props:{indexName:{type:String,default:""}},setup(e){re().appContext.config.globalProperties;const t=e,a=D([]),o=D([]),n=()=>{a.value.push({name:"",types:"new"})},r=async()=>{a.value=[];const m={es_connect:G.GetSelectEsConnID(),index_name:t.indexName},{data:I,code:f,msg:g}=await Ce(m);if(console.log(I,f,g),f===0)for(const u in I)a.value.push({name:I[u].AliasName,types:"old"});else h({message:g,type:"error"})},N=async m=>{const I=a.value[m].name,f={types:1,index_name:t.indexName,alias_name:I.trim(),es_connect:G.GetSelectEsConnID()},{data:g,code:u,msg:i}=await De(f);u===0?h({type:"success",message:i}):h({type:"error",message:i})},L=async()=>{const m=a.value.filter(i=>i.types==="new").map(i=>i.name),I={types:4,index_name:t.indexName,new_alias_name_list:m,es_connect:G.GetSelectEsConnID()},{data:f,code:g,msg:u}=await Se(I);g===0?h({type:"success",message:u}):h({type:"error",message:u})},z=async m=>{const I=a.value[m];if(I.types==="new")a.value.splice(m,1);else if(I.types==="old"){const f={types:2,index_name:t.indexName,alias_name:I.name.trim(),es_connect:G.GetSelectEsConnID()},{data:g,code:u,msg:i}=await Ge(f);u===0?(h({type:"success",message:i}),a.value.splice(m,1)):h({type:"error",message:i})}},y=m=>{o.value=m},M=async m=>{const I=a.value[m].name,f={types:3,new_index_list:o.value,alias_name:I.trim(),es_connect:G.GetSelectEsConnID()},{data:g,code:u,msg:i}=await Ne(f);u===0?h({type:"success",message:i}):h({type:"error",message:i})},b=m=>{h({message:"复制成功！",type:"success"})},U=m=>{h({message:"复制失败！",type:"error"})};return de(()=>{r()}),(m,I)=>{const f=c("el-button"),g=c("el-form-item"),u=c("el-input"),i=c("el-form"),v=ue("clipboard");return _(),F("div",null,[l(i,null,{default:s(()=>[l(g,null,{default:s(()=>[l(f,{type:"success",onClick:n},{default:s(()=>[k(w(m.$t("新增别名")),1)]),_:1}),l(f,{type:"primary",onClick:L},{default:s(()=>[k(w(m.$t("批量提交")),1)]),_:1}),l(f,{type:"info",onClick:r},{default:s(()=>[k(w(m.$t("重置")),1)]),_:1}),l(be,{style:{width:"210px","margin-left":"5px"},multiple:!0,clearable:!0,placeholder:m.$t("迁移别名到多个索引上"),onChange:y},null,8,["placeholder"])]),_:1}),(_(!0),F(ne,null,ae(a.value,(A,j)=>(_(),x(g,{key:j,label:m.$t("别名")+Number(j+1)},{default:s(()=>[l(u,{modelValue:A.name,"onUpdate:modelValue":E=>A.name=E,readonly:A.types!="new",style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue","readonly"]),S(l(f,{type:"success",onClick:E=>M(j)},{default:s(()=>[k(" 迁移 ")]),_:2},1032,["onClick"]),[[se,o.value.length>0]]),S((_(),x(f,{type:"success"},{default:s(()=>[k(w(m.$t("复制")),1)]),_:2},1024)),[[v,A.name,"copy"],[v,b,"success"],[v,U,"error"]]),S(l(f,{type:"primary",onClick:E=>N(j)},{default:s(()=>[k(w(m.$t("提交")),1)]),_:2},1032,["onClick"]),[[se,A.types=="new"]]),l(f,{type:"danger",onClick:E=>z(j)},{default:s(()=>[k(w(m.$t("删除")),1)]),_:2},1032,["onClick"])]),_:2},1032,["label"]))),128))]),_:1})])}}};const dt={name:"indices",setup(){return He},components:{Settings:Qe,Mappings:it,JsonEditor:ve,Alias:rt,IndexSelect:be},data(){return{activeNames:"1",indexTishiList:[],modName:"索引管理",aliasList:[],pointOut:Je,settings:{},readOnlyAllowDeleteLoading:!1,loadingGroup:{empty:!1,close:!1,open:!1,_forcemerge:!1,_refresh:!1,_flush:!1,"_cache/clear":!1,deleteIndex:!1,"_all/_flush":!1,saveMappinng:!1},forceMergeLoading:!1,tabLoading:!1,settingData:"{}",mappingData:"{}",statsData:"{}",editSettingsData:"{}",activeName:"Settings",showEditSettings:!0,showSettings:!0,showMapping:!0,showStats:!0,drawerShow:!1,settingsType:"add",mappingTitle:"",indexName:"",openSettings:!1,total:0,connectLoading:!1,page:1,limit:10,pageshow:!0,list:[],input:"",status:"",mappings:{},selectIndexList:[],openMappings:!1,allList:[],max:8}},destroyed(){sessionStorage.setItem("CatIndices",this.input)},computed:{isMobile(){return G.IsMobile()}},mounted(){const e=sessionStorage.getItem("CatIndices");e!=null&&(this.input=e),this.startGuid(),this.GetMapAction(),this.searchData()},methods:{openMappingDialog(e){this.indexName=e,this.openMappings=!0},async finishGuid(){},async startGuid(){},selectChange(e){this.selectIndexList=[];for(const t of e)this.selectIndexList.push(t.index)},async changeMapToAnotherIndex(e){e==""&&(e=this.indexName);const t={};t.es_connect=G.GetSelectEsConnID(),t.index_name=e;const a=await le(t);a.code==0&&(this.mappingData=JSON.stringify(a.data.list[e].mappings,null,"	"))},getMapping(e){this.mappingData=e},async saveMappinng(){let e=me(this.mappingData);try{e=JSON.parse(e)}catch{h({type:"error",message:"JSON格式不正确"});return}const t=Object.keys(e);if(t.length==0){h({type:"error",message:"请按格式写type名字"});return}const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=this.indexName,e[t[0]].toString()!="false"?(a.properties=e[t[0]],a.type_name=t[0]):a.properties=e,this.loadingGroup.saveMappinng=!0;const{data:o,code:n,msg:r}=await ye(a);this.loadingGroup.saveMappinng=!1,n==0?h({type:"success",message:r}):h({type:"error",message:r})},openMappingEditDialog(e,t){t?this.mappingTitle="新增字段":this.mappingTitle="新增映射结构",this.indexName=e,this.openMappings=!0},async GetMapAction(){const e={};e.es_connect=G.GetSelectEsConnID();const{code:t,data:a,msg:o}=await le(e);if(t==0)this.mappings=a.list;else{h({type:"error",message:o});return}},submitSettings(){const e={};e.es_connect=G.GetSelectEsConnID();try{e.settings=JSON.parse(this.editSettingsData)}catch(a){console.log(a),h({type:"error",message:"JSON 解析异常"});return}e.index_name=this.indexName,e.types="update";const t=this.$loading({lock:!0,text:"Loading",spinner:"el-button-loading",background:"rgba(0, 0, 0, 0.7)"});ge(e).then(a=>{a.code==0||a.code==200?(h({type:"success",message:a.msg}),this.search()):h({type:"error",message:a.msg}),t.close()}).catch(a=>{t.close()})},getSettings(e){this.editSettingsData=e},resetSettings(){this.changeTab()},Forcemerge(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ie(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:o.msg}),this.search()):h({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Empty(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Oe(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:o.msg}),this.search()):h({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Flush(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ve(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:o.msg}),this.search()):h({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},CacheClear(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,ze(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:o.msg}),this.search()):h({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Open(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Ae(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:o.msg}),this.search()):h({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Close(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,je(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:o.msg}),this.search()):h({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},Refresh(e,t){const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=t,a.command=e,this.loadingGroup[e]=!0,Te(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:o.msg}),this.search()):h({type:"error",message:o.msg}),this.loadingGroup[e]=!1}).catch(o=>{this.loadingGroup[e]=!1})},async changeTab(e){let t=0;e!=null&&(t=Number(e.index));const a={};let o={};switch(a.es_connect=G.GetSelectEsConnID(),a.index_name=this.indexName,t){case 0:o=await Le(a),o.code==0&&(this.settingData=JSON.stringify(o.data,null,"	")),this.showSettings=!1,this.$nextTick(()=>{this.showSettings=!0});return;case 1:o=await le(a),o.code==0&&(this.mappingData=JSON.stringify(o.data.list[this.indexName].mappings,null,"	"),Object.keys(o.data.list[this.indexName].mappings).length==0&&h({type:"error",message:"您还没有设置映射结构"})),this.showMapping=!1,this.$nextTick(()=>{this.showMapping=!0});return;case 2:o=await he(a),o.code==0&&(this.statsData=JSON.stringify(o.data,null,"	")),this.showStats=!1,this.$nextTick(()=>{this.showStats=!0});return;case 3:const{data:n}=await fe(a),r=["creation_date","version","provided_name","uuid","format","number_of_shards"];for(const N of r)n.index.hasOwnProperty(N)&&delete n.index[N];this.editSettingsData=JSON.stringify(n,null,"	"),this.showEditSettings=!1,this.$nextTick(()=>{this.showEditSettings=!0});return;case 4:return;default:return}},openDrawer(e){this.indexName=e,this.changeTab(),this.drawerShow=!0},drawerHandleClose(e){this.indexName="",this.activeName="Settings",e()},bigNumberTransform(e){return qe(e)},openSettingDialog(e,t){this.indexName=e,this.settingsType=t,this.openSettings=!0},readOnlyAllowDelete(){const e={};e.es_connect=G.GetSelectEsConnID(),this.readOnlyAllowDeleteLoading=!0,xe(e).then(t=>{t.code==0||t.code==200?h({type:"success",message:t.msg}):h({type:"error",message:t.msg}),this.readOnlyAllowDeleteLoading=!1}).catch(t=>{this.readOnlyAllowDeleteLoading=!1})},querySearch(e,t){let a=JSON.parse(JSON.stringify(this.indexTishiList));if(e==null&&(e=""),e.trim()==""){a.length>this.max?t(a.slice(0,this.max)):t(a);return}a=Z(a,e.trim()),a.length>this.max?t(a.slice(0,this.max)):t(a)},deleteIndex(e,t){this.$confirm("确定删除该索引吗?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{const a={};a.es_connect=G.GetSelectEsConnID(),a.index_name=e,this.loadingGroup[t]=!0,Ee(a).then(o=>{o.code==0||o.code==200?(h({type:"success",message:e+"已删除"}),this.searchData(),this.loadingGroup[t]=!1):(h({type:"error",message:o.msg}),this.loadingGroup[t]=!1)}).catch(o=>{})}).catch(a=>{console.error(a)})},closeSettings(){this.indexName="",this.settingsType="add",this.openSettings=!1},closeMappings(){this.indexName="",this.mappingTitle="add",this.openMappings=!1},search(){this.page=1,this.pageshow=!1,this.searchData(),this.$nextTick(()=>{this.pageshow=!0})},filterData(e,t){return Z(e,t)},handleSizeChange(e){console.log(`每页 ${e} 条`),this.limit=e,this.pageLimit()},handleCurrentChange(e){console.log(`当前页: ${e}`),this.page=e,this.pageLimit()},pageLimit(){this.list=this.allList.filter((e,t)=>t<this.page*this.limit&&t>=this.limit*(this.page-1))},searchData(){this.connectLoading=!0;const e={cat:"CatIndices",es_connect:G.GetSelectEsConnID()};this.indexTishiList=[],ke(e).then(t=>{if(t.code==0){const a=t.data;for(const n in a){const r=a[n];for(const N in r){let L=parseInt(r[N]);isNaN(L)&&(L=r[N]),a[n][N.split(".").join("->")]=L}this.indexTishiList.push({value:r.index,data:r.index})}let o=[];if(this.status.trim()!="")for(const n of a)n.health==this.status.trim()&&o.push(n);else o=a;o=Z(o,this.input.trim()),this.allList=o,this.total=o.length,this.pageLimit()}else h({type:"error",message:t.msg});this.connectLoading=!1}).catch(t=>{console.log(t),this.connectLoading=!1})}}},ut=e=>(Ke("data-v-31402987"),e=e(),We(),e),ct={class:"app-container"},pt={class:"search-container"},mt=ut(()=>V("span",null," 操作 ",-1)),gt={class:"search-container operate"},ft={class:"search-container operate"};function ht(e,t,a,o,n,r){const N=c("el-option"),L=c("el-select"),z=c("el-form-item"),y=c("el-col"),M=c("el-autocomplete"),b=c("el-button"),U=c("el-container"),m=c("el-tooltip"),I=c("el-row"),f=c("el-form"),g=c("el-collapse-item"),u=c("el-collapse"),i=c("el-table-column"),v=c("el-table"),A=c("el-pagination"),j=c("json-editor"),E=c("el-tab-pane"),T=c("el-tag"),Q=c("index-select"),X=c("el-link"),q=c("alias"),J=c("el-tabs"),C=c("el-drawer"),P=c("settings"),B=c("mappings"),p=ue("loading");return _(),F("div",ct,[V("div",pt,[l(u,{modelValue:n.activeNames,"onUpdate:modelValue":t[12]||(t[12]=d=>n.activeNames=d)},{default:s(()=>[l(g,{name:"1"},{title:s(()=>[mt]),default:s(()=>[l(f,null,{default:s(()=>[l(I,{gutter:20},{default:s(()=>[l(y,{lg:3,md:12,sm:4,xl:3,xs:24},{default:s(()=>[l(z,{label:"状态"},{default:s(()=>[l(L,{id:"index-health-status",modelValue:n.status,"onUpdate:modelValue":t[0]||(t[0]=d=>n.status=d),class:"filter-item width150",filterable:"",onChange:r.search},{default:s(()=>[l(N,{label:e.$t("所有"),value:""},null,8,["label"]),l(N,{label:"green",value:"green"}),l(N,{label:"yellow",value:"yellow"}),l(N,{label:"red",value:"red"})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),l(y,{lg:4,md:6,sm:6,xl:3,xs:12},{default:s(()=>[l(z,{label:"索引名"},{default:s(()=>[l(U,null,{default:s(()=>[l(M,{class:"filter-item width300",id:"index-keyword",clearable:"","fetch-suggestions":r.querySearch,style:{width:"300px"},modelValue:n.input,"onUpdate:modelValue":t[1]||(t[1]=d=>n.input=d),placeholder:e.$t("请输入索引名")},{default:s(({item:d})=>[V("span",null,w(d.value),1)]),_:1},8,["fetch-suggestions","modelValue","placeholder"]),l(b,{style:{"margin-left":"3px"},id:"index-search",type:"success",icon:e.Search,onClick:r.search},null,8,["icon","onClick"])]),_:1})]),_:1})]),_:1}),l(y,{lg:10,md:6,sm:2,xl:6,xs:12},{default:s(()=>[l(z,{label:"索引操作"},{default:s(()=>[l(U,null,{default:s(()=>[l(m,{content:"关闭",placement:"top"},{default:s(()=>[S(l(b,{disabled:n.loadingGroup.close,id:"patchCloseIndex",type:"danger",icon:e.Hide,onClick:t[2]||(t[2]=d=>r.Close("close",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup.close]])]),_:1}),l(m,{content:"打开",placement:"top"},{default:s(()=>[S(l(b,{id:"patchOpenIndex",disabled:n.loadingGroup.open,type:"success",icon:e.View,onClick:t[3]||(t[3]=d=>r.Open("open",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup.open]])]),_:1}),l(m,{content:"新建",placement:"top"},{default:s(()=>[l(b,{icon:e.Plus,id:"new-index",onClick:t[4]||(t[4]=d=>r.openSettingDialog("","add"))},null,8,["icon"])]),_:1}),l(m,{content:"删除",placement:"top"},{default:s(()=>[S(l(b,{icon:e.Delete,id:"patchDeleteIndex",disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[5]||(t[5]=d=>r.deleteIndex(n.selectIndexList.join(","),"deleteIndex"))},null,8,["icon","disabled"]),[[p,n.loadingGroup.deleteIndex]])]),_:1}),l(m,{content:"将节点切换为可读写状态",placement:"top"},{default:s(()=>[S(l(b,{icon:e.Sort,disabled:n.readOnlyAllowDeleteLoading,id:"readOnlyAllowDelete",type:"warning",onClick:t[6]||(t[6]=d=>r.readOnlyAllowDelete())},null,8,["icon","disabled"]),[[p,n.readOnlyAllowDeleteLoading]])]),_:1}),l(m,{content:"将所选索引刷新到磁盘",placement:"top"},{default:s(()=>[S(l(b,{id:"patchFlushIndex",disabled:n.loadingGroup._flush,type:"warning",icon:e.BrushFilled,onClick:t[7]||(t[7]=d=>r.Flush("_flush",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup._flush]])]),_:1}),l(m,{content:"强制合并索引",placement:"top"},{default:s(()=>[S(l(b,{icon:e.Connection,id:"patchForcemergeIndex",disabled:n.loadingGroup._forcemerge,onClick:t[8]||(t[8]=d=>r.Forcemerge("_forcemerge",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[p,n.loadingGroup._forcemerge]])]),_:1}),l(m,{content:"刷新索引",placement:"top"},{default:s(()=>[S(l(b,{id:"patchRefreshIndex",disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[9]||(t[9]=d=>r.Refresh("_refresh",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup._refresh]])]),_:1}),l(m,{content:"清空索引",placement:"top"},{default:s(()=>[S(l(b,{id:"patchEmptyIndex",disabled:n.loadingGroup.empty,icon:e.DocumentDelete,type:"danger",onClick:t[10]||(t[10]=d=>r.Empty("empty",n.selectIndexList.join(",")))},null,8,["disabled","icon"]),[[p,n.loadingGroup.empty]])]),_:1}),l(m,{content:"清理缓存",placement:"top"},{default:s(()=>[S(l(b,{icon:e.ToiletPaper,id:"patchCacheClear",disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[11]||(t[11]=d=>r.CacheClear("_cache/clear",n.selectIndexList.join(",")))},null,8,["icon","disabled"]),[[p,n.loadingGroup["_cache/clear"]]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),S((_(),x(v,{width:"100%",data:n.list,onSelectionChange:r.selectChange},{default:s(()=>[l(i,{type:"selection",width:"55",fixed:""}),l(i,{align:"center",label:e.$t("健康"),width:"100"},{default:s(d=>[d.row.health=="green"?(_(),x(b,{key:0,type:"success",circle:""})):O("",!0),d.row.health=="yellow"?(_(),x(b,{key:1,type:"warning",circle:""})):O("",!0),d.row.health=="red"?(_(),x(b,{key:2,type:"danger",circle:""})):O("",!0)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("状态"),width:"100"},{default:s(d=>[S(l(b,{type:"success",onClick:R=>r.Close("close",d.row.index)},{default:s(()=>[k(w(e.$t("开启")),1)]),_:2},1032,["onClick"]),[[se,d.row.status=="open"]]),S(l(b,{type:"danger",onClick:R=>r.Open("open",d.row.index)},{default:s(()=>[k(w(e.$t("关闭")),1)]),_:2},1032,["onClick"]),[[se,d.row.status=="close"]])]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("索引名")},{default:s(d=>[k(w(d.row.index),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主分片数"),width:"80",prop:"pri",sortable:""},{default:s(d=>[k(w(d.row.pri),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("副本分片数量"),width:"80",prop:"rep",sortable:""},{default:s(d=>[k(w(d.row.rep),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("文档总数"),width:"150",prop:"docs->count",sortable:""},{default:s(d=>[k(w(r.bigNumberTransform(d.row["docs.count"])),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("删除状态的文档"),width:"80",prop:"docs->deleted",sortable:""},{default:s(d=>[k(w(d.row["docs.deleted"]),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主+副本分片大小"),width:"120",prop:"store->size",sortable:""},{default:s(d=>[k(w(d.row["store.size"]),1)]),_:1},8,["label"]),l(i,{align:"center",label:e.$t("主分片大小"),width:"150",prop:"pri->store->size",sortable:""},{default:s(d=>[k(w(d.row["pri.store.size"]),1)]),_:1},8,["label"]),l(i,{align:"center",width:"190",label:e.$t("操作"),fixed:"right"},{default:s(d=>[l(m,{content:"修改配置",placement:"top"},{default:s(()=>[l(b,{icon:e.Setting,type:"info",onClick:R=>r.openSettingDialog(d.row.index,"update")},null,8,["icon","onClick"])]),_:2},1024),l(m,{content:"修改映射",placement:"top"},{default:s(()=>[l(b,{icon:e.EditPen,onClick:R=>r.openMappingEditDialog(d.row.index,!1)},null,8,["icon","onClick"])]),_:2},1024),l(m,{content:"更多",placement:"top"},{default:s(()=>[l(b,{icon:e.More,type:"primary",onClick:R=>r.openDrawer(d.row.index)},null,8,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[p,n.connectLoading]]),n.pageshow?(_(),x(A,{key:0,class:"pagination-container","current-page":n.page,"page-sizes":[10,20,30,50,100,150,200,500,1e3],"page-size":n.limit,layout:"total, sizes, prev, pager, next",total:n.total,onSizeChange:r.handleSizeChange,onCurrentChange:r.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])):O("",!0),l(C,{ref:"drawer",title:n.indexName,"before-close":r.drawerHandleClose,modelValue:n.drawerShow,"onUpdate:modelValue":t[27]||(t[27]=d=>n.drawerShow=d),direction:"rtl","custom-class":"demo-drawer","close-on-press-escape":"","destroy-on-close":"",size:r.isMobile?"100%":"50%"},{default:s(()=>[l(J,{modelValue:n.activeName,"onUpdate:modelValue":t[26]||(t[26]=d=>n.activeName=d),onTabClick:r.changeTab},{default:s(()=>[l(E,{label:e.$t("设置"),name:"Settings"},{default:s(()=>[n.showSettings?(_(),x(j,{key:0,value:n.settingData,"onUpdate:value":t[13]||(t[13]=d=>n.settingData=d),styles:"width: 100%",read:!0,title:e.$t("设置")},null,8,["value","title"])):O("",!0)]),_:1},8,["label"]),l(E,{label:e.$t("映射"),name:"Mapping"},{default:s(()=>[V("div",gt,[l(T,{type:"warning"},{default:s(()=>[k(w(e.$t("切换为其它索引的映射")),1)]),_:1}),l(Q,{clearable:!0,style:{width:"150px"},placeholder:e.$t("请选择索引名"),onChange:r.changeMapToAnotherIndex},null,8,["placeholder","onChange"]),l(T,{type:"primary"},{default:s(()=>[k(w(e.$t("操作")),1)]),_:1}),S((_(),x(b,{disabled:n.loadingGroup.saveMappinng,type:"primary",onClick:r.saveMappinng},{default:s(()=>[k(w(e.$t("修改")),1)]),_:1},8,["disabled","onClick"])),[[p,n.loadingGroup.saveMappinng]]),l(X,{type:"danger"},{default:s(()=>[k(w(e.$t("【注意：只能新增映射字段不可修改映射字段类型】")),1)]),_:1})]),n.showMapping?(_(),x(j,{key:0,value:n.mappingData,"onUpdate:value":t[14]||(t[14]=d=>n.mappingData=d),styles:"width: 100%",read:!1,title:e.$t("映射"),onGetValue:r.getMapping},null,8,["value","title","onGetValue"])):O("",!0)]),_:1},8,["label"]),l(E,{label:"Stats",name:"Stats"},{default:s(()=>[n.showStats?(_(),x(j,{key:0,value:n.statsData,"onUpdate:value":t[15]||(t[15]=d=>n.statsData=d),styles:"width: 100%;",read:!0,title:"Stats"},null,8,["value"])):O("",!0)]),_:1}),l(E,{label:e.$t("编辑索引配置"),name:"editSettings"},{default:s(()=>[l(f,null,{default:s(()=>[l(z,{label:e.$t("编辑索引配置")},{default:s(()=>[l(b,{type:"primary",onClick:t[16]||(t[16]=d=>r.submitSettings())},{default:s(()=>[k(w(e.$t("提交")),1)]),_:1}),l(b,{onClick:r.resetSettings},{default:s(()=>[k(w(e.$t("重置")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),l(z,null,{default:s(()=>[n.showEditSettings?(_(),x(j,{key:0,value:n.editSettingsData,"onUpdate:value":t[17]||(t[17]=d=>n.editSettingsData=d),"point-out":n.pointOut,styles:"width: 100%;",read:!1,title:e.$t("编辑配置"),onGetValue:r.getSettings},null,8,["value","point-out","title","onGetValue"])):O("",!0)]),_:1})]),_:1})]),_:1},8,["label"]),l(E,{label:e.$t("修改别名"),name:"alias"},{default:s(()=>[n.activeName=="alias"?(_(),x(q,{key:0,"index-name":n.indexName},null,8,["index-name"])):O("",!0)]),_:1},8,["label"]),V("div",ft,[l(f,null,{default:s(()=>[l(z,{label:"操作"},{default:s(()=>[l(m,{content:"关闭",placement:"top"},{default:s(()=>[S(l(b,{icon:e.Hide,disabled:n.loadingGroup.close,type:"danger",onClick:t[18]||(t[18]=d=>r.Close("close",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup.close]])]),_:1}),l(m,{content:"打开",placement:"top"},{default:s(()=>[S(l(b,{icon:e.View,disabled:n.loadingGroup.open,type:"success",onClick:t[19]||(t[19]=d=>r.Open("open",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup.open]])]),_:1}),l(m,{content:"强制合并索引【forcemerge操作,手动释放磁盘空间】",placement:"top"},{default:s(()=>[S(l(b,{disabled:n.loadingGroup._forcemerge,icon:e.Connection,onClick:t[20]||(t[20]=d=>r.Forcemerge("_forcemerge",n.indexName))},null,8,["disabled","icon"]),[[p,n.loadingGroup._forcemerge]])]),_:1}),l(m,{content:"刷新索引【为了让最新的数据可以立即被搜索到】",placement:"top"},{default:s(()=>[S(l(b,{disabled:n.loadingGroup._refresh,icon:e.RefreshRight,type:"primary",onClick:t[21]||(t[21]=d=>r.Refresh("_refresh",n.indexName))},null,8,["disabled","icon"]),[[p,n.loadingGroup._refresh]])]),_:1}),l(m,{content:"将索引刷新到磁盘【让数据持久化到磁盘中】",placement:"top"},{default:s(()=>[S(l(b,{icon:e.BrushFilled,disabled:n.loadingGroup._flush,type:"info",onClick:t[22]||(t[22]=d=>r.Flush("_flush",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup._flush]])]),_:1}),l(m,{content:"清理缓存",placement:"top"},{default:s(()=>[S(l(b,{icon:e.ToiletPaper,disabled:n.loadingGroup["_cache/clear"],type:"warning",onClick:t[23]||(t[23]=d=>r.CacheClear("_cache/clear",n.indexName))},null,8,["icon","disabled"]),[[p,n.loadingGroup["_cache/clear"]]])]),_:1}),l(m,{content:"删除索引",placement:"top"},{default:s(()=>[S(l(b,{icon:e.Delete,disabled:n.loadingGroup.deleteIndex,type:"danger",onClick:t[24]||(t[24]=d=>r.deleteIndex(n.indexName,"deleteIndex"))},null,8,["icon","disabled"]),[[p,n.loadingGroup.deleteIndex]])]),_:1}),l(m,{content:"清空索引",placement:"top"},{default:s(()=>[S(l(b,{disabled:n.loadingGroup.empty,type:"danger",icon:e.DocumentDelete,onClick:t[25]||(t[25]=d=>r.Empty("empty",n.indexName))},null,8,["disabled","icon"]),[[p,n.loadingGroup.empty]])]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue","onTabClick"])]),_:1},8,["title","before-close","modelValue","size"]),n.openSettings?(_(),x(P,{key:1,"index-name":n.indexName,"settings-type":n.settingsType,onFinished:r.search,open:n.openSettings,onClose:r.closeSettings},null,8,["index-name","settings-type","onFinished","open","onClose"])):O("",!0),n.openMappings?(_(),x(B,{key:2,"index-name":n.indexName,title:n.mappingTitle,open:n.openMappings,onClose:r.closeMappings},null,8,["index-name","title","open","onClose"])):O("",!0)])}const St=oe(dt,[["render",ht],["__scopeId","data-v-31402987"]]);export{St as default};
